---
title: 'Numerical experiment investigating the influence of drag on trajectory patterns of floating macroalgae'
author: 
- R Coppin^[University of the Western Cape], C Rautenbach^[National Institute of Water and Atmospheric Research], AJ Smit^[University of the Western Cape]
output:
  word_document:
    reference_docx: markdown/frontiers_template.docx
  pdf_document:
    fig_caption: yes
    latex_engine: xelatex
  html_document:
bibliography: references.bib
csl: markdown/frontiers.csl.txt
abstract: "**Abstract**: Ocean currents act as an important dispersal mechanism of material on the ocean surface, both natural and anthropogenic. Macroalgae are one of the most important natural dispersal vectors, and are regarded as the tumble-weed of the ocean. Despite many studies that exist on the topic, the relative role of wind and surface currents in macroalgae trajectory is still unknown. Past studies focus on kelp-rafts, which can vary greatly in size, making it difficult to form a concensus as to the relative role of wind versus surface currents. In addition, past studies have not considered surface-area in relation to drag characterisics of floating macroalgae which have been shown to play a role in the trajectory and accumulation of other flotsam. Advances in Lagrangian trajectory modeling have been exponential in recent years, and allow the use of numerical experiments to investigate trajectories of flotsam in the ocean. This study aimed to shed light on the relative role of wind versus surface currents, and the role of drag in macrolagal trajectory and accumulation. We did not investigate kelp-raft behaviour but instead focused on solitary kelp individuals. This was achieved by comparing simulations of virtual kelp 'particles' which incorporate drag with that of purely Lagrangian particles. The results showed that the virtual kelp particles do follow the ocean currents in general, but that the inclusion of drag into the scenarios causes accumulation in eddies within the study domain. The results also point to the importance of sub-mesoscale features, such as eddies, as important surface accumulation zones for solitary floating macroalage."
---

```{r software, message=FALSE, warning=FALSE, include=FALSE}
## Load software need for entire script

library(ggplot2)
library(rgdal)
library(gridExtra)
library(ggpubr)
library(mapproj)
library(vegan)
library(dplyr)
library(ggpubr)
library(maps)
library(flextable)
library(officer)
library(tidync)
library(tidyverse)
library(hexbin)
library(lubridate)

```

# Introduction

There is a range of objects --- both natural and anthropogenic --- floating in the ocean of which macroalgae are regarded as one of the most important passive dispersal mechanisms of marine taxa. Floating kelp acts as a passive dispersal mechanism for a range of marine taxa and is sometimes referred to as the 'tumble-weed' of the ocean [@edgar1987; @bushing1994; @norton1992; @helmuth1994; @holmquist1994; @smith2002; @McCormick2008]. Kelp also function as input of allochthonous materials to near and distant ecosystems and in this manner support the ecological function in a range of adjacent habitats [@cartraud2021; @colombini2003; @Filbee-Dexter2018-wp; @zuercher2019; @Krumhansl2012; @vanderklift2008; @bustamante1995]. 

Some macroalgal species are negatively buoyant and sink to the seafloor when detached from the substrate, while other species have air-filled pneumatocysts or stipes which allow the plants to reach the surface where light is more abundant. In turn, the positively buoyant pneumatocysts cause plants to float to the surface when dislodged from the substratum. The structure and number of pneumatocysts varies between species. For example species belonging to the genera *Macrocystis*, *Sargassum*, *Ascophyllum*, and *Fucus* have thalli with many small pneumatocysts, while other kelp species such as *Nereocystis luetkeana*, *Pelagophycus porra*, *Ecklonia radiata*, *Ecklonia maxima* have a single, large pneumatocysts [@dayton1985; @smith2002; @thiel2005; @graiff2016; @batista2018]. In some cases the stipe itself may be air-filled, such as with *E. maxima* and *E. radiata*. Although there have been reports of floating Chlorophyta species and some Rhodophyta species, Phaeophyceae species are the most reported forms of floating algae. This is most likely because the green and red species reported floating are not actually positively buoyant, but instead are kept at the surface by gas trapped in-between or in the thalli [@dromgoole1982; @back2000]. The giant kelp *Macrocystis pyrifera* [@helmuth1994; @kingsford1995; @hobday2000; @macaya2005; @graiff2016; @batista2018], the bull kelp *Durvillaea antarctica* [@collins2010; @tala2013 ; @tala2017; @saunders2014; @smith2002; @wichmann2012; @batista2018], and pelagic *Sargassum* species [@putman2020; @brooks2019; @putman2018; @brooks2018; @wang2019] have been the focus of much of the research regarding spatial and temporal dispersal patterns, the ecological role of rafting, marine connectivity and raft-time.

Past research points to macroalgae trajectory being largely determined by prevailing wind conditions and surface currents [@thiel2005; @hobday2000; @fraser2011; @rothausler2011; @rothausler2011]. Although ocean currents are regarded as the primary influence, the relative importance of wind versus surface current is still unknown although the role of wind has been recognised as important in several studies. For example, a study by @harrold1989 investigated the seasonal trajectories of radio-transmitter tagged *M. pyrifera* in nearshore Monterrey Bay. The results showed that kelp rafts, with little surface area, exposed to the wind were largely driven by a combination of wind and surface currents; however the relative importance of wind and was not clear. In addition, the trajectories of tagged kelp were more consistent with the formation of eddies during winter. Previous studies have also identified wind as an important mechanism of dispersal in wind dominated ocean systems. For example, in the sub-Antarctic latitudes the West Wind Drift causes continuous unidirectional surface flow and is regarded as an important potential mechanism for dispersal of floating bull kelp *Durvillaea antarctica*. Other studies have used genetic approaches to determine macroalgae raft trajectory characteristics by inferring source location from genetically similar populations [@nikula2013]. For example, a study by @fraser2011 on the rafting capabilities of *D. antarctica* used a combination of population genetics and relative age estimate of goosebarnacles attached to the raft. The presence of goosebarnacles suggests a long rafting, time as these species have a slow growth rate. Genetic analyses showed these species are able to raft up to $\sim$ 390 km from their local origin. The authors suggested that wind and water-movement were the primary influences of trajectory; however, this was only inferred from the genetic results and local climatology data [@fraser2011]. Past research has shown that buoyancy and drag also play a role in determining the trajectory and rate of transport for surface floating material [@onink2019; @shen2019; @dasaro2018; @gates2018; @beron2016; @trinanes2016; @furnans2008]. The 'sail' area of an object floating at sea is the surface area exposed to the wind which results in air form drag, while the area of the object below the surface of the water is exposed to surface currents which result in hydrodynamic-form drag [@breivik2011; @griffin2017]. In addition, past research conducted within the maritime industry has shown that the size and shape of a vessel determine the relative importance of waves or wind as drivers of trajectory, as well as orientation of the object. If the length of the object is longer than the significant wave height then waves will be the primary driver of trajectory while the opposite is true for smaller objects where the effect of waves is regarded as negligible [@breivik2011; @griffin2017]. Drag is ultimately determined by the size and shape of the object which are properties that vary considerably with macroalgae species. 

To accurately determine the trajectory of marine macroalgae, water and wind drag need to be taken into account. Past research by @allen1999 and @breivik2011 have provided estimates of drag for various objects based on experimental work, which consisted of both direct and indirect methods of the Leeway model. However, this work does not consider biological material such as macroalgae. Although drag estimates do exist, these have been applied for macroalgae not detached from the substratum and are regarded as fixed-point estimates. Although various approaches have been used in the past to investigate floating macroalgal trajectories, very few studies have employed the use of Langrangian trajectory modeling. Furthermore, none of the existing studies using this modeling approach have considered macroalgal morphology cross-sectional area (*i.e.* shape) as an aspect of drag and ultimately trajectory. Studies by @brooks2019, @putman2018, and @putman2020 used Lagrangian approaches to investigate the effects of inertia, raft-size, and windage on macroalgae trajectory. @brooks2019 used a custom growth model to estimate changes in biomass and ultimately radial size, while a customised Hybrid Coordinate Ocean Model (HYCOM) for the trajectory simulations was used. The results showed that the trajectory of pelagic *Sargussum* was significantly influenced by inertia and the radial size of the rafts. Other work by @putman2020 investigated the effect of including windage in macroalgae trajectory simulations. The authors showed that including *ad hoc* windage factors greatly improved accuracy regarding entrainment or expulsion from eddies when compared to tracked *Sargassum* mats in the ocean. Langrangian trajectory modeling is clearly; useful tool, however, the various models available often assume the object to be a spherical particle, which is obviously not the case for both biological and anthropogenic forms of marine debris in nature. The radial size included by @brooks2019 is an improvement, however this approach does not consider the complex morphology on an individual level into account.

Past studies have focused on kelp-rafts, not solitary floating kelp, and therefore are not able to investigate the role of eddies and vortices in the accumulation of individual kelp plants at the surface. Gyres, eddies, and converging surface currents have been identified as important in the accumulation and dispersal of plastics and other marine debris [@onink2019; @dasaro2018; @brach2018]. Past studies investigating the dispersal of marine debris have also included the possible effects of inertia in accumulation of ocean drifter instruments in mesoscale features. For example, a study by @beron2016 used a modeling approach to investigated the role of Eckman transport and inertia to explain the observed behavior of undrogued drifters in the ocean gyres. Undrogued drifter trajectory is affected by wind unlike the drogue counter parts which makes the effects of wind negligible. The results showed that the combined effect inertia, not Eckman transport, played a significant role in the observed drifter behavior [@beron2016]. The authors also noted that the presence of other flotsam along with the undrogued drifters in ocean gyres also suggests that aspects inertia also play a role in accumulation of other marine debris [@beron2016]. The approach by @beron2016 has also been improved upon by @beron2019 but also shows the significant role of inertia in flotsam trajectory and accumulation. 

In this study, a numerical approach is used to shed light on the role of hydrodynamic and direct wind drag on macroalgal drift trajectory using Lagrangian based trajectory simulations. We aim to shed light on the 'behaviour' of surface drifting macroalgae from a coastal environment into the open ocean, which will inform future characterisation studies. We will achieve this by comparing the trajectory outputs of virtual passive particles (no drag characteristics added) with kelp particles (drag characteristics added) of varying degrees of hydrodynamic and wind drag exposure. The different degrees of wave and wind exposure are meant to reflect the different buoyancy characteristics, as well as identify the role of magnitude of the drag components on overall trajectory. The modeling of single kelp offers the opportunity to study the role of eddies and vortices in accumulation points on the surface. 

# Methods
## Study site

The region of interest for this study was the Cape Peninsula in the Western Cape (Figure 1A). A release site was chosen for this study, Kommetjie, which is located on the Atlantic side of the Cape Peninsula (Figure 2B). The hydrodynamics in the study region are driven by a complex interaction of wind and waves, and are also influenced by larger oceanic processes. In South Africa, the larger processes can be attributed to the Agulhas Current (AC) and the Benguela Current (BC) [@lutjeharms2000;@lutjeharms2007;@garzoli1996;@hutchings2009;@rubio2009]. The AC is a component of the South-west Indian Ocean sub-gyre, flowing predominantly south-westward following the continental shelf edge and eventually retroflecting eastward back into the South Indian Ocean [@lutjeharms2000;@lutjeharms2007]. The region where the retroflection occurs is known as the Agulhas Retroflection and consists of high levels of mesoscale variability [@garzoli1996]. The variability results in shedding of rings and filaments known as the Agulhas Rings and have an average diameter of ~324 km [@lutjeharms1988;@lutjeharms2006; @lutjeharms2007]. Agulhas Rings are the main contributors to the Agulhas leakage which is the transport of warm water from the Indian Ocean to the South Atlantic Ocean [@garzoli1996; @lutjeharms2006; @beal2015]. The Agulhas leakage is also a source of meso-scale variability within the Benguela region as anticyclonic rings are shed and drift northwestward along the southern Benguela slope region [@rubio2009]. The Benguela region is characterised by strong coastal upwelling which is primarily driven by equatorward winds [@shannon1996;@hardman2003]. It is known as the Benguela Upwelling System (BUS). The BUS starts at 27 S and extends southward to 35 S [@shannon1996]. The region is also characterised by high amounts of mesoscale variability in the form of eddies and filaments [@blanke2002; @blanke2005; @rubio2009]. The Benguela inshore region is dominated by a northwestward flow because of topographical steering, wind stress and interactions with passing Agulhas Rings and eddies [@veitch2010]. 

```{r map, echo=FALSE, message=FALSE, warning=FALSE, strip.white=TRUE, fig.cap="Figure 1: Map of the study domain and the main features pertaining to transport in the region. In panel A, the map of the entire South African coastline and the main currents is presented. The resulting eddies and filaments from the Agulhas retroflection are indicated, and the position of the study area is drawn in as a black rectangle. Detail of the study area is in panel B. Here the splitting of the Benguela Jet, eddie features, and the general flow of the study domain are presented. The release site of simulated kelp ‘particles’ is represented by a blue star."}

library(png)
library(grid)
library(gridExtra)

#map_chp3A <- rasterGrob(as.raster(readPNG("map/chp3_mapA.png")))
#map_chp3B <- rasterGrob(as.raster(readPNG("map/chp3_mapB.png")))
#ggarrange(map_chp3A, map_chp3B, ncol = 2, nrow = 1, labels = "AUTO", align = c("h"))
map_chp3_combined <- rasterGrob(as.raster(readPNG("map/ch3_map_final.png")))
ggarrange(map_chp3_combined)

```

The study domain falls within the southern Benguela upwelling ecosystem, which is a region of high mesoscale variability and activity in the form of eddies, filaments and vortices generated from the Agulhas retroflection [@veitch2018; @veitch2017] they generally flow northward along the coastline and begin to move offshore near Cape Columbine. The Benguela Jet is a coastal flowing current and is driven by a complex interaction of eddies, upwelling, Eckman transport and geostrophic currents [@stramma1989; @veitch2017; @veitch2018; @hutchings2009]. The stability of the jet varies seasonally with more stable flows in winter; and in January, the jet begins to split between Cape Point and Cape Columbine [@veitch2018; @blanke2005; @blanke2002] which results in a weak narrow inshore branch that flows along the shelf edge and a strong flowing north-westwards offshore branch. The area is also characterized by high upwelling activity driven by strong westerly winds [@hutchings2009]. These winds are most intense during summer (December-March) which favors upwelling conditions in the region, and also act to reinforce the flow of the Benguela Jet which occurs due to cold upwelling waters contributing to the across-shore density gradient [@ragoasha2019]. In winter the wind direction is reversed which decreases upwelling favorable conditions, but the core of the Benguela jet is maintained by the intrusion of warm Agulhas waters into the Benguela region over the shelf edge [@veitch2018; @hutchings2009; @ragoasha2019].   

## Particle tracking model

The model is based on parameterizations that have been used for previous studies investigating iceberg, capsized marine vessels and microplastics. It should be noted that most of the previous studies regarding macroalgae trajectory have investigated rafts and not solitary floating individuals. A kelp raft will vary in size and can range from a few meters across to large dense mats the size of a rugby field. Some authors suggest that most macroalgae become entangled through ocean currents and not through the hydrodynamic forces that dislodge them. Large kelp rafts are not a feature around the coast of the Cape Peninsula; rather, solitary kelp are (pers. obs). Therefore, the trajectory of only solitary *E. maxima* individuals will be considered. We performed numerical calculations of particle trajectory with a Lagrangian method [@delandmeter2019], and be described by the equation

$$X(t+\Delta t) = X(t) + \int_{t}^{t+\Delta t} v(x, \tau)d \tau + \Delta X_b(t)$$
where $X$ is the three-dimensional position of a particle, $v(x,t)$ is the three-dimensional velocity field at the location in the ocean model at particle point in time, $t$ is time $X_b(t)$ is a change in position due to 'behavior' of the particle at a particular point in time. In order to investigate the effects of drag components of trajectory of floating macroalgae, this study incorporated drag as the custom behavior. 

This study simulated two scenarios; one where the plant is fully submerged and only exposed to hydrodynamic drag; and the other where parts of the plants are partially exposed resulting in a combination of hydrodynamic and air form drag. Drag based on shape-based coefficients were used in the calculations for determining the overall kelp velocity vectors. A momentum energy equation was used to calculate the drag forces for the relevant simulation. This approach has been employed in modeling iceberg drift trajectory [@andersson2017; @lichey2001; @eik2009] and was adapted to suit this study. The energy momentum equation used to calculate the drag force exerted on the virtual kelp particle was, $$m({d_u/d_t})=F_d + F_a + F_f$$
where $m$ is kelp mass, $d_u$ the virtual kelp particle velocity, $F_d$ the hydrodynamic drag, $F_a$ is the wind drag, $F_f$ the surface-current flow, and $d_t$ is the time step. The assumption made was that the mass of the kelp did not change for each virtual kelp particle over the course of the simulations. Hydrodynamic drag, wind drag, and surface current-flow are two-dimensional vector quantities and were calculated for each time step for each simulation. 

## Simulations

Virtual particles were released with no drag or wind effects from the study site in order to act as a reference for comparison to simulations with varying degrees of hydrodynamic and wind drag, and are referred to hereafter as 'passive particles'. All particles that have any form of drag exposure are hereafter referred to as 'kelp particles'. All simulations have the same release location (Kommetjie) and were run for 30 days with hourly outputs using a fourth order Runge-Kutte advection scheme [@North2009; @VanSebille2018]. Brownian motion was also incorporated in order to account for any stochasticity not resolved by the model. These are standard practices for Lagrangian trajectory studies [@North2009;@delandmeter2019; @VanSebille2018]. The time period used in all simulations were January (summer), April (Autumn), July (winter), and October (Spring) of 2018. These time periods were chosen based on variable mesoscale activities and stability of the Bengulea Jet that occurs through the year. For example, splitting of the Benguela Jet occurs in January, which also coincides with a period of higher wind intensity, upwelling along the coast and mesoscale activity ; while in winter the Benguela jet begins to stablize until summer when the begins to split again [@rubio2009; @veitch2018; @ragoasha2019]. In order to determine if the shape co-efficient used plays a role in model used, a simulation of a kelp with the maximum surface area and drag exposure was run using the shape coefficient for a cylinder to compare to a simulation using a sphere, and was run for 30 days using a fourth order Runge-Kutte advection scheme with brownian motion and a particle set of size 1000. 

To test the different magnitudes that hydrodynamic and wind drag might play in the overall trajectory, simulations were run with varying degrees of drag exposure scenarios. These scenarios were meant to act as proxy for buoyancy, which determines the surface area exposed to hydrodynamic and wind drag. These estimates were expressed as percentages which were used to calculate hydrodynamic and wind drag for applicable simulation. For example, if 85% of the plant is submerged and 15% of above water, then the overall hydrodynamic and wind drag forces would be 85% and 15% of the total drag forces respectively. This approach has been used in past research investigating pelagic *Sargassum* rafts [@putman2020;@putman2018]. The exposure scenarios used in this study were 100%, 95%, 90%, and 85% for hydrodynamic drag; 0 %, 5%, 10%, and 15% for wind (see table 1). Each scenario consisted of a particle set with a size of 1000 were released from Kommetjie at the start of simulation. Since the aim of this investigation was to investigate the relative surface behavior of virtual kelp particles, only the surface layer was used for simulations. It should also be noted that the Copernicus model used places velocity vectors over some of the land covering the coastal domain. This was not considered a concern, as once again, the aim was to investigate surface drift behavior. A summary of the parameters for each simulation are provided in table 1.To determine if vortices and eddies play a role in kelp accumulation on the surface, a separate set of simulations were performed. Unlike the previous simulations these simulation released a particle every hour over the same time periods. 

```{r sim table, eval=TRUE, message=FALSE, warning=FALSE, include=TRUE}

set_flextable_defaults(fonts_ignore=TRUE)

sim_table <- read.csv("tables/chapter_3/simulation_table.csv", sep = ";")

sim_table <- flextable(data = sim_table)
sim_table <- theme_zebra(sim_table, odd_header = "transparent", even_header = "transparent")
sim_table <- set_header_labels(sim_table, Cross.sectional.area = "Cross-sectional area", Drag.Exposure = "Drag Exposure level")
sim_table <- align(x= sim_table, align = "center", part = "all")
sim_table <- set_table_properties(sim_table, width = 1, layout = "autofit")
sim_table <- set_caption(sim_table, "Details for each simulation run for the study. Type refers to either a passive particle with no drag behaviour or a kelp particle that has been advected with any drag exposure. The drag exposure column refers to the parameterisations regarding the level of water and wind drag simulated. All simulations were run with a Runge-Kutte (4th) advection scheme, Brownian motion, 30 days, and included 1000 particles for a 2018 hindcast.")
sim_table

```

## Model inputs
### Ocean and wind model

Both passive and kelp particles were simulated around the South African coastline within hindcast outputs from the Copernicus Marine Environment Monitoring Service (Copernicus, http://marine.copernicus.com). The Copernicus model is based on the modelling framework known as Nucleus for European Modelling of the ocean. The Copernicus outputs used in this study contain 3D daily current information from the top layer to the bottom (Global Analysis Forecast PHY_001_024). The model has a spatial resolution of 0.08$^\circ$ and is interpolated on an Arakawa C native grid. In order to incorporate the effects of direct wind drag within the simulations, the Copernicus Marine Environment Monitoring Service global wind product was used (Global Ocean Wind L4_NRT_012_004). The outputs from the model are composed of 6-hourly averaged fields of surface 10 m wind velocity vectors with a spatial resolution of 0.25$^\circ$. Averaged ocean current and wind data are stored as meridional and zonal velocity vectors. 

### Hydrodynamic and wind drag

The drag coefficient for a spherical particle was used in the calculation of hydrodynamic drag as the trajectory model assumes the particles are spherical. The drag equation used was: $F_d = 0.5 \rho A_c C_d U^2$, where $\rho$ is the density of seawater or air, $A_c$ is the cross-sectional area exposed to hydrodynamic or wind drag, $C_d$ is the drag coefficient for a spherical particle and $U$ is the surface velocity vector of the flow-/wind- field. Hydrodynamic and wind drag components were calculated separately for both the meridional and zonal velocity vectors, as per @furnans2008. Since drag force is dependent on the velocity vectors which vary with time, the meridional and zonal velocities were interpolated and used in the drag force calculation for each time-step. The same approach was used for the wind drag force. The equation that was used to calculate hydrodynamic drag, was also used to calculate wind drag. 

### Cross-sectional area

To incorporate hydrodynamic and wind drag, the cross-sectional area of the kelp was calculated first. Known geometric shapes reflecting the relevant plant sections were used to estimate the surface area for various parts of the plant. For details refer to figure 2. The dimensional data needed were estimated in cases where data was not available for that particular morphological characteristic. The bulb/pneumatocyst is a highly variable morphological characteristic and in some cases can appear absent; the same is true for the holdfast. Therefore, a standard cross-sectional area was used for both the bulb and holdfast, for all simulations. 

```{r message=FALSE, warning=FALSE, include=TRUE, echo=FALSE, fig.height=4, fig.width=7, fig.cap="Figure 2: Diagram of the *E. maxima* morphological characteristics considered in this study, along with the associated geometric shapes used to calculate the overall surface area of each morphological characteristic."}

kelp_shape_figure <- rasterGrob(as.raster(readPNG("figures/chapter_3/chp3_shapedrawing.png")))
ggarrange(kelp_shape_figure)

```

The cross-sectional area calculated was site specific and the dimensions needed were garnered from morphology data from a previous study [@coppin2020]. The minimum, mean and maximum were calculated for each morphological characteristic, which were used for calculating the overall minimum, mean and maximum cross-sectional areas needed to run the various simulations (see table 2). The trajectory of these 'types' of cross-sectional areas (minimum, mean and maximum overall cross-sectional area) were used to determine the influence of drag, both hydrodynamic and wind, on overall trajectory. 

```{r morphology wrangling, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
# Investigate morphology data to assist in estimating surface area

# Read in morphology data
eck_df <- read.csv("data/morph_data/eck_morph_data.csv", sep = ";") %>%
  filter(site!= "Rocky Bank") %>%   # Not using Rocky Bank in this study
  filter(site!= "De Hoop") 
eck_df$site <- as.character(eck_df$site)
eck_df <- eck_df %>% 
  filter(population == "Deep") 
eck_long_df <- gather(eck_df, Morphology, measurement, frond_mass:total_length, factor_key=TRUE)
# Summary stats to make it easier to refer to later, these will not be used any analysis.
site_list <- c("Kommetjie")
eck_stats <- eck_long_df %>% 
  group_by(site, Morphology) %>% 
  summarise(mean = mean(measurement, na.rm = T),
            minimum = min(measurement, na.rm = T),
            maximum = max(measurement, na.rm = T)) %>% 
  ungroup() %>% 
  filter(site %in% site_list) %>% 
  rename(Site = site) %>% 
  rename(Mean = mean) %>% 
  rename(Minimum = minimum) %>% 
  rename(Maximum = maximum)

#eck_stats <- flextable(data = eck_stats)
#eck_stats <- theme_zebra(eck_stats, odd_header = "transparent", even_header = "transparent")
#eck_stats <- align(x= eck_stats, align = "center", part = "all")
#eck_stats <- set_table_properties(eck_stats, width = 1, layout = "autofit")

```

```{r morphology table, message=FALSE, warning=FALSE, include=TRUE, echo=FALSE, eval=TRUE}

set_flextable_defaults(fonts_ignore=TRUE)

area_table <- read.csv("tables/chapter_3/area_table.csv", sep = ";")
area_table <- flextable(data = area_table)
area_table <- theme_zebra(area_table, odd_header = "transparent", even_header = "transparent")
area_table <- align(x= area_table, align = "center", part = "all")
area_table <- set_header_labels(area_table, Plant.characteristic = "Plant characteristic", Approximate.shape = "Approximate shape", Equation.used = "Equation Used", Plant.dimensions = "Plant dimensions")
area_table <- set_header_labels(area_table, Ac.Minimum = "Ac Minimum", Ac.Mean = "Ac Mean", Ac.Maximum = "Ac Maximum")
area_table <- set_table_properties(area_table, width = 1, layout = "autofit")
area_table <- set_caption(area_table, "Table 2: Table summarising the attributes and estimates used to calculate the overall surface area of Kommetjie kelp individuals used in the various simulations. Approximate shape refers to the dimensions of the geometric shape used to represent a particular morphological characteristic. Equations used are the equations relating to the dimensions used for the geometric shape estimate. Plant dimensions are the measurements used, collected in previous work by @coppin2020, used to calculate the associated surface areas. The total surface areas for each plant characteristic for each surface area type make up the remaining columns.")
area_table
```
## Analysis

In order to compare trajectories between cross-sectional area types and wind exposure scenarios, mean trajectories were calculated and density distribution maps were produced. Density distribution maps are an effective method for assessing pathways and ocean connectivity [@vanSebille2018]. In addition, mean trajectory was calculated and included in the density distribution maps to further aid in comparing simulation outputs. The distance that particles traveled was also measured and used to produce boxplots. Distance traveled from the release site can help reveal topographic steering and momentum energy transfer from the wind field to kelp particles [@vanSebille2018]. If the wind direction is in the same direction as the current the virtual particles will cover larger distances due to an increase in the velocity as a result of momentum energy transfer [@putman2020; @putman2018; @vanSebille2018]. 

# Results
## Comparison of coefficients

The comparison of mean trajectories between the sphere and cylindrical shape coefficients revealed no difference (see appendix). This was also reflected when comparing distance travelled by particles and particle density plots (see appendix). The simulation which used a cylindrical shape coefficient showed higher density in an eddy compared to the simulation which used a sphere for the shape coefficient (see appendix). 


```{r data wrangling, message=FALSE, warning=FALSE, include=FALSE}

# Read in simulation data and data wrangling

p_RK4 <- tidync("OceanParcels/trajectory_data/RK4_PFloat.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00")) 
p_RK4_mean <- p_RK4 %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

p_RK4$type <- "RK4" # add extra column 'type' to dataframe and assigned 'RK4' label
p_RK4_mean$type <- "1" # add extra column 'type' to dataframe and assigned 'RK4' label

Min_Kfloat_H100_W00 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H100_W00_mean <- Min_Kfloat_H100_W00 %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H100_W00$type <- "Min_Kfloat_H100_W00" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H100_W00$velocity <- with(Min_Kfloat_H100_W00, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H100_W00_mean$type <- "2" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H095_W05 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H095_W05.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H095_W05_mean <- Min_Kfloat_H095_W05 %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H095_W05$type <- "Min_Kfloat_H095_W05" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H095_W05$velocity <- with(Min_Kfloat_H095_W05, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H095_W05_mean$type <- "3" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H090_W10 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H090_W10.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H090_W10_mean <- Min_Kfloat_H090_W10 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H090_W10$type <- "Min_Kfloat_H090_W10" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H090_W10$velocity <- with(Min_Kfloat_H090_W10, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H090_W10_mean$type <- "4" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H085_W15 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H085_W15.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H085_W15_mean <- Min_Kfloat_H085_W15 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H085_W15$type <- "Min_Kfloat_H085_W15" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H085_W15$velocity <- with(Min_Kfloat_H085_W15, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H085_W15_mean$type <- "5" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_Kfloat_H100_W00 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_Kfloat_H100_W00_mean <- Mean_Kfloat_H100_W00 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_Kfloat_H100_W00$type <- "Mean_Kfloat_H100_W00" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_Kfloat_H100_W00$velocity <- with(Mean_Kfloat_H100_W00, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_Kfloat_H100_W00_mean$type <- "6" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H095_W05 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H095_W05.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H095_W05_mean <- Mean_KFloat_H095_W05 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H095_W05$type <- "Mean_KFloat_H095_W05" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H095_W05$velocity <- with(Mean_KFloat_H095_W05, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H095_W05_mean$type <- "7" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H090_W10 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H090_W10.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H090_W10_mean <- Mean_KFloat_H090_W10 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H090_W10$type <- "Mean_KFloat_H090_W10" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H090_W10$velocity <- with(Mean_KFloat_H090_W10, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H090_W10_mean$type <- "8" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H085_W15 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H085_W15.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H085_W15_mean <- Mean_KFloat_H085_W15 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE)) 

Mean_KFloat_H085_W15$type <- "Mean_KFloat_H085_W15" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H085_W15$velocity <- with(Mean_KFloat_H085_W15, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H085_W15_mean$type <- "9" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H100_W00 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H100_W00_mean <- Max_Kfloat_H100_W00 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H100_W00$type <- "Max_KFloat_H100_W00" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H100_W00$velocity <- with(Max_Kfloat_H100_W00, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H100_W00_mean$type <- "10" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H095_W05 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H095_W05.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H095_W05_mean <- Max_Kfloat_H095_W05 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H095_W05$type <- "Max_KFloat_H095_W05" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H095_W05$velocity <- with(Max_Kfloat_H095_W05, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H095_W05_mean$type <- "11" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H090_W10 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H090_W10.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H090_W10_mean <- Max_Kfloat_H090_W10 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H090_W10$type <- "Max_KFloat_H090_W10" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H090_W10$velocity <- with(Max_Kfloat_H090_W10, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H090_W10_mean$type <- "12" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H085_W15 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H085_W15.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H085_W15_mean <- Max_Kfloat_H085_W15 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H085_W15$type <- "Max_KFloat_H085_W15" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H085_W15$velocity <- with(Max_Kfloat_H085_W15, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H085_W15_mean$type <- "13" # add extra column 'type' to dataframe and assigned 'kelp' label

total_data <- rbind(Min_Kfloat_H100_W00 , Min_Kfloat_H095_W05, Min_Kfloat_H090_W10, Min_Kfloat_H085_W15, Mean_Kfloat_H100_W00, Mean_KFloat_H095_W05, Mean_KFloat_H090_W10, Mean_KFloat_H085_W15, Max_Kfloat_H100_W00, Max_Kfloat_H095_W05, Max_Kfloat_H090_W10, Max_Kfloat_H085_W15)

## April

p_RK4_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/RK4_PFloat_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00")) 
p_RK4_mean_April <- p_RK4_April %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

p_RK4_April$type <- "RK4_April" # add extra column 'type' to dataframe and assigned 'RK4' label
p_RK4_mean_April$type <- "17" # add extra column 'type' to dataframe and assigned 'RK4' label


Min_Kfloat_H100_W00_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H100_W00_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H100_W00_mean_April <- Min_Kfloat_H100_W00_April %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H100_W00_April$type <- "Min_Kfloat_H100_W00_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H100_W00_April$velocity <- with(Min_Kfloat_H100_W00_April, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H100_W00_mean_April$type <- "18" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H095_W05_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H095_W05_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H095_W05_mean_April <- Min_Kfloat_H095_W05_April %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H095_W05_April$type <- "Min_Kfloat_H095_W05_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H095_W05_April$velocity <- with(Min_Kfloat_H095_W05_April, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H095_W05_mean_April$type <- "19" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H090_W10_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H090_W10_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H090_W10_mean_April <- Min_Kfloat_H090_W10_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H090_W10_April$type <- "Min_Kfloat_H090_W10_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H090_W10_April$velocity <- with(Min_Kfloat_H090_W10_April, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H090_W10_mean_April$type <- "20" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H085_W15_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H085_W15_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H085_W15_mean_April <- Min_Kfloat_H085_W15_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H085_W15_April$type <- "Min_Kfloat_H085_W15_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H085_W15_April$velocity <- with(Min_Kfloat_H085_W15_April, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H085_W15_mean_April$type <- "21" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_Kfloat_H100_W00_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H100_W00_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_Kfloat_H100_W00_mean_April <- Mean_Kfloat_H100_W00_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_Kfloat_H100_W00_April$type <- "Mean_Kfloat_H100_W00_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_Kfloat_H100_W00_April$velocity <- with(Mean_Kfloat_H100_W00_April, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_Kfloat_H100_W00_mean_April$type <- "22" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H095_W05_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H095_W05_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H095_W05_mean_April <- Mean_KFloat_H095_W05_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H095_W05_April$type <- "Mean_KFloat_H095_W05_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H095_W05_April$velocity <- with(Mean_KFloat_H095_W05_April, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H095_W05_mean_April$type <- "23" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H090_W10_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H090_W10_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H090_W10_mean_April <- Mean_KFloat_H090_W10_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H090_W10_April$type <- "Mean_KFloat_H090_W10_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H090_W10_April$velocity <- with(Mean_KFloat_H090_W10_April, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H090_W10_mean_April$type <- "24" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H085_W15_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H085_W15_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H085_W15_mean_April <- Mean_KFloat_H085_W15_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE)) 

Mean_KFloat_H085_W15_April$type <- "Mean_KFloat_H085_W15_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H085_W15_April$velocity <- with(Mean_KFloat_H085_W15_April, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H085_W15_mean_April$type <- "25" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H100_W00_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H100_W00_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H100_W00_mean_April <- Max_Kfloat_H100_W00_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H100_W00_April$type <- "Max_KFloat_H100_W00_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H100_W00_April$velocity <- with(Max_Kfloat_H100_W00_April, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H100_W00_mean_April$type <- "26" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H095_W05_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H095_W05_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H095_W05_mean_April <- Max_Kfloat_H095_W05_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H095_W05_April$type <- "Max_KFloat_H095_W05_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H095_W05_April$velocity <- with(Max_Kfloat_H095_W05_April, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H095_W05_mean_April$type <- "27" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H090_W10_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H090_W10_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H090_W10_mean_April <- Max_Kfloat_H090_W10_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H090_W10_April$type <- "Max_KFloat_H090_W10_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H090_W10_April$velocity <- with(Max_Kfloat_H090_W10_April, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H090_W10_mean_April$type <- "28" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H085_W15_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H085_W15_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H085_W15_mean_April <- Max_Kfloat_H085_W15_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H085_W15_April$type <- "Max_KFloat_H085_W15_April" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H085_W15_April$velocity <- with(Max_Kfloat_H085_W15_April, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H085_W15_mean_April$type <- "29" # add extra column 'type' to dataframe and assigned 'kelp' label

total_data_April <- rbind(Min_Kfloat_H100_W00_April, Min_Kfloat_H095_W05_April, Min_Kfloat_H090_W10_April, Min_Kfloat_H085_W15_April, Mean_Kfloat_H100_W00_April, Mean_KFloat_H095_W05_April, Mean_KFloat_H090_W10_April, Mean_KFloat_H085_W15_April, Max_Kfloat_H100_W00_April, Max_Kfloat_H095_W05_April, Max_Kfloat_H090_W10_April, Max_Kfloat_H085_W15_April)

## July

p_RK4_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/RK4_PFloat_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00")) 
p_RK4_mean_July <- p_RK4_July %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

p_RK4_July$type <- "RK4_July" # add extra column 'type' to dataframe and assigned 'RK4' label
p_RK4_mean_July$type <- "30" # add extra column 'type' to dataframe and assigned 'RK4' label

Min_Kfloat_H100_W00_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H100_W00_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H100_W00_mean_July <- Min_Kfloat_H100_W00_July %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H100_W00_July$type <- "Min_Kfloat_H100_W00_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H100_W00_July$velocity <- with(Min_Kfloat_H100_W00_July, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H100_W00_mean_July$type <- "31" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H095_W05_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H095_W05_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H095_W05_mean_July <- Min_Kfloat_H095_W05_July %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H095_W05_July$type <- "Min_Kfloat_H095_W05_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H095_W05_July$velocity <- with(Min_Kfloat_H095_W05_July, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H095_W05_mean_July$type <- "32" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H090_W10_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H090_W10_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H090_W10_mean_July <- Min_Kfloat_H090_W10_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H090_W10_July$type <- "Min_Kfloat_H090_W10_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H090_W10_July$velocity <- with(Min_Kfloat_H090_W10_July, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H090_W10_mean_July$type <- "33" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H085_W15_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H085_W15_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H085_W15_mean_July <- Min_Kfloat_H085_W15_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H085_W15_July$type <- "Min_Kfloat_H085_W15_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H085_W15_July$velocity <- with(Min_Kfloat_H085_W15_July, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H085_W15_mean_July$type <- "34" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_Kfloat_H100_W00_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H100_W00_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_Kfloat_H100_W00_mean_July <- Mean_Kfloat_H100_W00_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_Kfloat_H100_W00_July$type <- "Mean_Kfloat_H100_W00_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_Kfloat_H100_W00_July$velocity <- with(Mean_Kfloat_H100_W00_July, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_Kfloat_H100_W00_mean_July$type <- "35" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H095_W05_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H095_W05_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H095_W05_mean_July <- Mean_KFloat_H095_W05_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H095_W05_July$type <- "Mean_KFloat_H095_W05_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H095_W05_July$velocity <- with(Mean_KFloat_H095_W05_July, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H095_W05_mean_July$type <- "36" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H090_W10_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H090_W10_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H090_W10_mean_July <- Mean_KFloat_H090_W10_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H090_W10_July$type <- "Mean_KFloat_H090_W10_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H090_W10_July$velocity <- with(Mean_KFloat_H090_W10_July, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H090_W10_mean_July$type <- "37" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H085_W15_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H085_W15_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H085_W15_mean_July <- Mean_KFloat_H085_W15_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE)) 

Mean_KFloat_H085_W15_July$type <- "Mean_KFloat_H085_W15_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H085_W15_July$velocity <- with(Mean_KFloat_H085_W15_July, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H085_W15_mean_July$type <- "38" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H100_W00_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H100_W00_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H100_W00_mean_July <- Max_Kfloat_H100_W00_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H100_W00_July$type <- "Max_KFloat_H100_W00_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H100_W00_July$velocity <- with(Max_Kfloat_H100_W00_July, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H100_W00_mean_July$type <- "39" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H095_W05_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H095_W05_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H095_W05_mean_July <- Max_Kfloat_H095_W05_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H095_W05_July$type <- "Max_KFloat_H095_W05_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H095_W05_July$velocity <- with(Max_Kfloat_H095_W05_July, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H095_W05_mean_July$type <- "40" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H090_W10_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H090_W10_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H090_W10_mean_July <- Max_Kfloat_H090_W10_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H090_W10_July$type <- "Max_KFloat_H090_W10_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H090_W10_July$velocity <- with(Max_Kfloat_H090_W10_July, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H090_W10_mean_July$type <- "41" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H085_W15_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H085_W15_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H085_W15_mean_July <- Max_Kfloat_H085_W15_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H085_W15_July$type <- "Max_KFloat_H085_W15_July" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H085_W15_July$velocity <- with(Max_Kfloat_H085_W15_July, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H085_W15_mean_July$type <- "42" # add extra column 'type' to dataframe and assigned 'kelp' label

total_data_July <- rbind(Min_Kfloat_H100_W00_July, Min_Kfloat_H095_W05_July, Min_Kfloat_H090_W10_July, Min_Kfloat_H085_W15_July, Mean_Kfloat_H100_W00_July, Mean_KFloat_H095_W05_July, Mean_KFloat_H090_W10_July, Mean_KFloat_H085_W15_July, Max_Kfloat_H100_W00_July, Max_Kfloat_H095_W05_July, Max_Kfloat_H090_W10_July, Max_Kfloat_H085_W15_July)

## October

p_RK4_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/RK4_PFloat_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00")) 
p_RK4_mean_Oct <- p_RK4_Oct %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

p_RK4_Oct$type <- "RK4_Oct" # add extra column 'type' to dataframe and assigned 'RK4' label
p_RK4_mean_Oct$type <- "43" # add extra column 'type' to dataframe and assigned 'RK4' label

Min_Kfloat_H100_W00_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H100_W00_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H100_W00_mean_Oct <- Min_Kfloat_H100_W00_Oct %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H100_W00_Oct$type <- "Min_Kfloat_H100_W00_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H100_W00_Oct$velocity <- with(Min_Kfloat_H100_W00_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H100_W00_mean_Oct$type <- "44" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H095_W05_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H095_W05_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H095_W05_mean_Oct <- Min_Kfloat_H095_W05_Oct %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H095_W05_Oct$type <- "Min_Kfloat_H095_W05_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H095_W05_Oct$velocity <- with(Min_Kfloat_H095_W05_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H095_W05_mean_Oct$type <- "45" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H090_W10_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H090_W10_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H090_W10_mean_Oct <- Min_Kfloat_H090_W10_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H090_W10_Oct$type <- "Min_Kfloat_H090_W10_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H090_W10_Oct$velocity <- with(Min_Kfloat_H090_W10_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H090_W10_mean_Oct$type <- "46" # add extra column 'type' to dataframe and assigned 'kelp' label

Min_Kfloat_H085_W15_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Min_KFloat_H085_W15_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H085_W15_mean_Oct <- Min_Kfloat_H085_W15_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H085_W15_Oct$type <- "Min_Kfloat_H085_W15_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H085_W15_Oct$velocity <- with(Min_Kfloat_H085_W15_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Min_Kfloat_H085_W15_mean_Oct$type <- "47" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_Kfloat_H100_W00_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H100_W00_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_Kfloat_H100_W00_mean_Oct <- Mean_Kfloat_H100_W00_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_Kfloat_H100_W00_Oct$type <- "Mean_Kfloat_H100_W00_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_Kfloat_H100_W00_Oct$velocity <- with(Mean_Kfloat_H100_W00_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_Kfloat_H100_W00_mean_Oct$type <- "48" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H095_W05_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H095_W05_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H095_W05_mean_Oct <- Mean_KFloat_H095_W05_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H095_W05_Oct$type <- "Mean_KFloat_H095_W05_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H095_W05_Oct$velocity <- with(Mean_KFloat_H095_W05_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H095_W05_mean_Oct$type <- "49" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H090_W10_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H090_W10_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H090_W10_mean_Oct <- Mean_KFloat_H090_W10_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H090_W10_Oct$type <- "Mean_KFloat_H090_W10_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H090_W10_Oct$velocity <- with(Mean_KFloat_H090_W10_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H090_W10_mean_Oct$type <- "50" # add extra column 'type' to dataframe and assigned 'kelp' label

Mean_KFloat_H085_W15_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Mean_KFloat_H085_W15_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H085_W15_mean_Oct <- Mean_KFloat_H085_W15_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE)) 

Mean_KFloat_H085_W15_Oct$type <- "Mean_KFloat_H085_W15_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H085_W15_Oct$velocity <- with(Mean_KFloat_H085_W15_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Mean_KFloat_H085_W15_mean_Oct$type <- "51" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H100_W00_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H100_W00_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H100_W00_mean_Oct <- Max_Kfloat_H100_W00_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H100_W00_Oct$type <- "Max_KFloat_H100_W00_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H100_W00_Oct$velocity <- with(Max_Kfloat_H100_W00_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H100_W00_mean_Oct$type <- "52" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H095_W05_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H095_W05_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H095_W05_mean_Oct <- Max_Kfloat_H095_W05_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H095_W05_Oct$type <- "Max_KFloat_H095_W05_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H095_W05_Oct$velocity <- with(Max_Kfloat_H095_W05_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H095_W05_mean_Oct$type <- "53" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H090_W10_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H090_W10_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H090_W10_mean_Oct <- Max_Kfloat_H090_W10_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H090_W10_Oct$type <- "Max_KFloat_H090_W10_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H090_W10_Oct$velocity <- with(Max_Kfloat_H090_W10_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H090_W10_mean_Oct$type <- "54" # add extra column 'type' to dataframe and assigned 'kelp' label

Max_Kfloat_H085_W15_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H085_W15_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H085_W15_mean_Oct <- Max_Kfloat_H085_W15_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H085_W15_Oct$type <- "Max_KFloat_H085_W15_Oct" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H085_W15_Oct$velocity <- with(Max_Kfloat_H085_W15_Oct, sqrt(kelpvelU^2 + kelpvelV^2))
Max_Kfloat_H085_W15_mean_Oct$type <- "55" # add extra column 'type' to dataframe and assigned 'kelp' label

total_data_Oct <- rbind(Min_Kfloat_H100_W00_Oct, Min_Kfloat_H095_W05_Oct, Min_Kfloat_H090_W10_Oct, Min_Kfloat_H085_W15_Oct, Mean_Kfloat_H100_W00_Oct, Mean_KFloat_H095_W05_Oct, Mean_KFloat_H090_W10_Oct, Mean_KFloat_H085_W15_Oct, Max_Kfloat_H100_W00_Oct, Max_Kfloat_H095_W05_Oct, Max_Kfloat_H090_W10_Oct, Max_Kfloat_H085_W15_Oct)

```

## Trajectory comparison

The mean trajectories of the different cross-sectional areas are similar to the mean trajectory of the passive particles (Figure 2A). When comparing mean trajectories between the different cross-sectional areas for the 100% hydrodynamic drag simulations, no differences can be seen; rather, there is only a slight variation. The results from the simulations including different hydrodynamic and wind drag exposures and cross-sectional area types show differences in mean trajectory when compared to the passive simulation (Figure 2B). The end points of the simulations including hydrodynamic and wind drag were different compared to the passive simulations, as well the final location of the kelp particles being further from the release site. When comparing the different hydrodynamic and wind drag simulations to each other, only slight variation in mean trajectories was evident. In all simulations particles flowed in a north-westward direction.

The mean trajectories of kelp particles were different compared to the mean trajectory of passive particles for April (autumn). Mean trajectories for kelp particles with different cross-sectional areas exposed to only hydrodynamic drag travelled further northward compared to the passive particles (see Figure 2C-D). The mean trajectories of kelp particles with different cross-sectional area types and a combination of wind and hydrodynamic drag flowed further north-westward compared to the passive particles. Across all simulations for April, the end locations were different, and hydrodynamic only kelp particles travelled less distance compared to kelp particles with both wind and hydrodynamic drag. Differences in mean trajectories between kelp and passive particles were also evident in the July (winter) simulations (see Figure 2E-F). Mean trajectories of passive particles flowed north-westward, while kelp particles across cross-sectional areas and exposed to only hydrodynamic drag initially flowed in a southerly direction and then flowed westward offshore; resulting in entrainment within an eddy. Similar behaviour is evident when comparing passive particles with kelp particles exposed to both hydrodynamic and wind drag. In the combined hydrodynamic and water drag scenarios, and across cross-sectional areas; kelp particles travelled initially southward and then westward offshore and also becoming entrained in an eddy. In the October (Spring) simulations, differences in end locations were evident between passive and kelp particles across cross-sectional areas and drag scenarios (see Figure 7F-G). Mean Trajectory of kelp particles with different cross-sectional areas and exposed to only hydrodynamic drag ended a greater distance from the release site compared to the passive particles. This was also evident when comparing kelp particles with different cross-sectional areas and exposure to wind and hydrodynamic drag with passive particles; with the end location a further from the release location. In both the April and October simulations all particles flowed north-westward, while in winter the mean trajectory resulted in entrainment within an eddy.  

```{r meantraj, message=FALSE, warning=FALSE, include=FALSE, echo = FALSE}

load("map/south_africa_coast_hi_res.Rdata")

total_mean_water <- rbind(p_RK4_mean, Min_Kfloat_H100_W00_mean, Mean_Kfloat_H100_W00_mean, Max_Kfloat_H100_W00_mean)
total_mean_ww <- rbind(p_RK4_mean, Min_Kfloat_H095_W05_mean, Min_Kfloat_H090_W10_mean, Min_Kfloat_H085_W15_mean, Mean_KFloat_H095_W05_mean, Mean_KFloat_H090_W10_mean, Mean_KFloat_H085_W15_mean, Max_Kfloat_H095_W05_mean, Max_Kfloat_H090_W10_mean, Max_Kfloat_H085_W15_mean)

total_mean_water$type <- factor(total_mean_water$type, levels=c("1", "2", "6", "10"))
total_mean_ww$type <- factor(total_mean_ww$type, levels=c("1", "3", "4", "5", "7", "8", "9", "11", "12", "13"))


waterdrag_plot <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_water, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

wwdrag_plot <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_ww, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

total_mean_water_April <- rbind(p_RK4_mean_April, Min_Kfloat_H100_W00_mean_April, Mean_Kfloat_H100_W00_mean_April, Max_Kfloat_H100_W00_mean_April)
total_mean_ww_April <- rbind(p_RK4_mean_April, Min_Kfloat_H095_W05_mean_April, Min_Kfloat_H090_W10_mean_April, Min_Kfloat_H085_W15_mean_April, Mean_KFloat_H095_W05_mean_April, Mean_KFloat_H090_W10_mean_April, Mean_KFloat_H085_W15_mean_April, Max_Kfloat_H095_W05_mean_April, Max_Kfloat_H090_W10_mean_April, Max_Kfloat_H085_W15_mean_April)

total_mean_water_April$type <- factor(total_mean_water_April$type, levels=c("17", "18", "22", "26"))
total_mean_ww_April$type <- factor(total_mean_ww_April$type, levels=c("17", "19", "20", "21", "23", "24", "25", "27", "28", "29"))


waterdrag_plot_April <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_water_April, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

wwdrag_plot_April <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill ="grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_ww_April, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

total_mean_water_July <- rbind(p_RK4_mean_July, Min_Kfloat_H100_W00_mean_July, Mean_Kfloat_H100_W00_mean_July, Max_Kfloat_H100_W00_mean_July)
total_mean_ww_July <- rbind(p_RK4_mean_July, Min_Kfloat_H095_W05_mean_July, Min_Kfloat_H090_W10_mean_July, Min_Kfloat_H085_W15_mean_July, Mean_KFloat_H095_W05_mean_July, Mean_KFloat_H090_W10_mean_July, Mean_KFloat_H085_W15_mean_July, Max_Kfloat_H095_W05_mean_July, Max_Kfloat_H090_W10_mean_July, Max_Kfloat_H085_W15_mean_July)

total_mean_water_July$type <- factor(total_mean_water_July$type, levels=c("30", "31", "35", "39"))
total_mean_ww_July$type <- factor(total_mean_ww_July$type, levels=c("30", "32", "33", "34", "36", "37", "38", "40", "41", "42"))


waterdrag_plot_July <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_water_July, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

wwdrag_plot_July <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_ww_July, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

total_mean_water_Oct <- rbind(p_RK4_mean_Oct, Min_Kfloat_H100_W00_mean_Oct, Mean_Kfloat_H100_W00_mean_Oct, Max_Kfloat_H100_W00_mean_Oct)
total_mean_ww_Oct <- rbind(p_RK4_mean_Oct, Min_Kfloat_H095_W05_mean_Oct, Min_Kfloat_H090_W10_mean_Oct, Min_Kfloat_H085_W15_mean_Oct, Mean_KFloat_H095_W05_mean_Oct, Mean_KFloat_H090_W10_mean_Oct, Mean_KFloat_H085_W15_mean_Oct, Max_Kfloat_H095_W05_mean_Oct, Max_Kfloat_H090_W10_mean_Oct, Max_Kfloat_H085_W15_mean_Oct)

total_mean_water_Oct$type <- factor(total_mean_water_Oct$type, levels=c("43", "44", "48", "52"))
total_mean_ww_Oct$type <- factor(total_mean_ww_Oct$type, levels=c("43", "45", "46", "47", "49", "50", "51", "53", "54", "55"))


waterdrag_plot_Oct <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_water_Oct, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

wwdrag_plot_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black",     fill = "grey") +
  coord_cartesian(xlim = c(8, 28), ylim = c(-38, -26)) +
  geom_path(data = total_mean_ww_Oct, aes(x = lon, y = lat, colour = type))+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  scale_colour_discrete("Type") +  
  guides(fill=guide_legend(title="Number of particles")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height=11, fig.width=8, fig.cap="Figure 3: Comparison of mean trajectories. Panel (A) represents hydrodynamic drag only simulations and Panel (B) represents simulations for both wind and hydrodynamic drag, for January, Panel (C) represents hydrodynamic drag only simulations and Panel (D) represents simulations for both wind and hydrodynamic drag, for April. Panel (E) represents hydrodynamic drag only simulations and Panel (F) represents simulations for both wind and hydrodynamic drag, for July. Panel (G) represents hydrodynamic drag only simulations and Panel (H) represents simulations for both wind and hydrodynamic drag, for October. In all panels the passive simulations are represented by black lines."}

ggarrange(waterdrag_plot, wwdrag_plot, waterdrag_plot_April, wwdrag_plot_April, waterdrag_plot_July, wwdrag_plot_July, waterdrag_plot_Oct, wwdrag_plot_Oct, ncol = 2, nrow = 4, font.label = list(size = 11, face = "bold"), common.legend = FALSE, legend = c("right"), labels = "AUTO", align = "hv")

```

## Comparison of density distributions

Across all simulations particles flowed in a north-westward direction. The density plots for simulations that considered any form of drag showed a higher density of particles along the mean trajectory path compared to the passive simulation which has an almost even density of particles across grids. In addition the density plots show that the particles in simulations that considered any form of drag got entrained in a vorticity while particles in the passive simulation deflected away (Figure 3). Comparison of cross-sectional areas and different drag exposure scenarios show no differences in mean trajectory and spatial patterns in density, with only slight variations across types. 

In April and across all simulations, particles flowed in a north-westward direction (see Figure 4). The density plots that considered any form of drag showed narrow, higher density along the mean trajectory compared to passive simulation. In addition, simulations that considered any form of drag got entrained within an eddy further north-westward from the end location of passive particles. Only slight variations across cross-sectional areas and drag exposure scenarios are evident. Simulations for July showed that the flow was also north-westward, but all kelp particles across cross-sectional areas and drag scenarios show high density of particles entrained in a eddy located westward of the release site compared to passive particles (see Figure 5). Variation in density along the mean trajectory and eddy for all kelp particles is evident. Kelp particles with only hydrodynamic drag across cross-sectional areas showed lower density of particles along the mean trajectory compared to kelp particles with both wind and hydrodynamic drag. October simulations showed no differences in density of particles along the mean trajectory when comparing passive and kelp particles. Only slight variations in density and trajectory can be seen with no entrainment (see Figure 6). Kelp particles with any cross-sectional area and drag exposure scenario flowed further offshore when compared to passive particles. 

```{r density plots, message=FALSE, warning=FALSE, echo=FALSE}

## Heatmaps of study domain, use previous data for study site map and histograms
## Coastline of Southern Africa

load("map/south_africa_coast_hi_res.Rdata")

heatmap_RK4 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = p_RK4, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = p_RK4_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H100_W00 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H100_W00, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 1100)) +
  geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H100W100") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H095_W05 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H095_W05, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 1100)) +
  geom_path(data = Min_Kfloat_H095_W05_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  #ggtitle("H095W05") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H090_W10, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 1100)) +
  geom_path(data = Min_Kfloat_H090_W10_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H090W10") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H085_W15 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H085_W15, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Min_Kfloat_H085_W15_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H085W15") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_Kfloat_H100_W00 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_Kfloat_H100_W00, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Mean_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H095_W05 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app1, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H095_W05, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Mean_KFloat_H095_W05_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H090_W10, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Mean_KFloat_H090_W10_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H085_W15 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H085_W15, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Mean_KFloat_H085_W15_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H100_W00 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H100_W00, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Max_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H095_W05 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H095_W05, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Max_Kfloat_H095_W05_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H090_W10, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Max_Kfloat_H090_W10_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H085_W15 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H085_W15, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1100)) +
  geom_path(data = Max_Kfloat_H085_W15_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

## April

heatmap_RK4_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = p_RK4_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = p_RK4_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H100_W00_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H100_W00_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H100_W00_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H100W100") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H095_W05_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H095_W05_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H095_W05_mean_April, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  #ggtitle("H095W05") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H090_W10_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H090_W10_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H090_W10_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H090W10") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H085_W15_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H085_W15_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H085_W15_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H085W15") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_Kfloat_H100_W00_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_Kfloat_H100_W00_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",       limits = c(1, 1000)) +
  geom_path(data = Mean_Kfloat_H100_W00_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H095_W05_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app1, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H095_W05_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",       limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H095_W05_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H090_W10_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H090_W10_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H090_W10_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H085_W15_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H085_W15_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H085_W15_mean_April, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H100_W00_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H100_W00_April , bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H100_W00_mean_April ,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H095_W05_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H095_W05_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H095_W05_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H090_W10_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H090_W10_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H090_W10_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H085_W15_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H085_W15_April, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H085_W15_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

## July

heatmap_RK4_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = p_RK4_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = p_RK4_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H100_W00_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H100_W00_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H100_W00_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H100W100") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H095_W05_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H095_W05_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H095_W05_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  #ggtitle("H095W05") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H090_W10_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H090_W10_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H090_W10_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H090W10") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H085_W15_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H085_W15_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H085_W15_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H085W15") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_Kfloat_H100_W00_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_Kfloat_H100_W00_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",       limits = c(1, 1000)) +
  geom_path(data = Mean_Kfloat_H100_W00_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H095_W05_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app1, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H095_W05_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",       limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H095_W05_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H090_W10_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H090_W10_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H090_W10_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H085_W15_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H085_W15_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H085_W15_mean_July, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H100_W00_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H100_W00_July , bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H100_W00_mean_July ,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H095_W05_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H095_W05_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H095_W05_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H090_W10_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H090_W10_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H090_W10_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H085_W15_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H085_W15_July, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H085_W15_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

## October

heatmap_RK4_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = p_RK4_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = p_RK4_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H100_W00_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H100_W00_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H100_W00_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H100W100") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H095_W05_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H095_W05_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H095_W05_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  #ggtitle("H095W05") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H090_W10_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H090_W10_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H090_W10_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H090W10") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H085_W15_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H085_W15_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",        limits = c(1, 1000)) +
  geom_path(data = Min_Kfloat_H085_W15_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H085W15") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_Kfloat_H100_W00_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_Kfloat_H100_W00_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",       limits = c(1, 1000)) +
  geom_path(data = Mean_Kfloat_H100_W00_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H095_W05_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app1, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H095_W05_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  scale_fill_continuous(type = "viridis",       limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H095_W05_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H090_W10_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H090_W10_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H085_W15_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H085_W15_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Mean_KFloat_H085_W15_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H100_W00_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H100_W00_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H100_W00_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H095_W05_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H095_W05_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H095_W05_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H090_W10_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H090_W10_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H090_W10_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H085_W15_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H085_W15_Oct, bins = 80, aes(x = lon, y = lat), legend = TRUE) +
  scale_fill_continuous(type = "viridis", limits = c(1, 1000)) +
  geom_path(data = Max_Kfloat_H085_W15_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 3: Comparison of density plots at the end run time for scenarios 1 - 13, for January 2018 (summer). The plots are regular hexagons within the density of particles were calculated. The mean trajectories for each scenario are also plotted for comparison. The reader is referred to tables 1 and 2 for details pertaining to each scenario.', fig.height=8, fig.width=8}

leg_Jan <- get_legend(heatmap_RK4)

ggarrange(heatmap_RK4, heatmap_Min_Kfloat_H100_W00, heatmap_Min_Kfloat_H095_W05,heatmap_Min_Kfloat_H090_W10,heatmap_Min_Kfloat_H085_W15, heatmap_Mean_Kfloat_H100_W00, heatmap_Mean_KFloat_H095_W05, heatmap_Mean_KFloat_H090_W10, heatmap_Mean_KFloat_H085_W15, heatmap_Max_KFloat_H100_W00,heatmap_Max_KFloat_H095_W05, heatmap_Max_KFloat_H090_W10, heatmap_Max_KFloat_H085_W15,as_ggplot(leg_Jan), labels = c("1","2","3","4","5","6","7","8","9","10","11","12","13"), common.legend = TRUE, legend = c("none"),font.label = list(size = 11, face = "bold")) 

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 4: Comparison of density plots at the end run time for scenarios 17 - 29, for April 2018 (winter). The plots are regular hexagons within the density of particles were calculated. The mean trajectories for each scenario are also plotted for comparison. The reader is referred to tables 1 and 2 for details pertaining to each scenario.', fig.height=8, fig.width=8}

leg_April <- get_legend(heatmap_RK4_April)

ggarrange(heatmap_RK4_April,heatmap_Min_Kfloat_H100_W00_April, heatmap_Min_Kfloat_H095_W05_April,heatmap_Min_Kfloat_H090_W10_April,heatmap_Min_Kfloat_H085_W15_April, heatmap_Mean_Kfloat_H100_W00_April, heatmap_Mean_KFloat_H095_W05_April, heatmap_Mean_KFloat_H090_W10_April, heatmap_Mean_KFloat_H085_W15_April, heatmap_Max_KFloat_H100_W00_April,heatmap_Max_KFloat_H095_W05_April, heatmap_Max_KFloat_H090_W10_April, heatmap_Max_KFloat_H085_W15_April,as_ggplot(leg_April), labels = c("17", "18","19","20","21","22","23","24","25","26","27","28", "29"), common.legend = TRUE, legend = c("none"), font.label = list(size = 11, face = "bold"))

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 5: Comparison of density plots at the end run time for scenarios 30 - 42, for July 2018 (winter). The plots are regular hexagons within the density of particles were calculated. The mean trajectories for each scenario are also plotted for comparison. The reader is referred to tables 1 and 2 for details pertaining to each scenario.', fig.height=8, fig.width=8}

leg_July <- get_legend(heatmap_RK4_July)

ggarrange(heatmap_RK4_July,heatmap_Min_Kfloat_H100_W00_July, heatmap_Min_Kfloat_H095_W05_July,heatmap_Min_Kfloat_H090_W10_July,heatmap_Min_Kfloat_H085_W15_July, heatmap_Mean_Kfloat_H100_W00_July, heatmap_Mean_KFloat_H095_W05_July, heatmap_Mean_KFloat_H090_W10_July, heatmap_Mean_KFloat_H085_W15_July, heatmap_Max_KFloat_H100_W00_July,heatmap_Max_KFloat_H095_W05_July, heatmap_Max_KFloat_H090_W10_July, heatmap_Max_KFloat_H085_W15_July, as_ggplot(leg_July),labels = c("30","31","32","33","34","35","36","37","38","39","40","41","42"), common.legend = TRUE, legend = c("none"), font.label = list(size = 11, face = "bold"))

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 6: Comparison of density plots at the end run time for scenarios 43 - 55, for October 2018 (spring). The plots are regular hexagons within the density of particles were calculated. The mean trajectories for each scenario are also plotted for comparison. The reader is referred to tables 1 and 2 for details pertaining to each scenario.', fig.height=8, fig.width=8}

leg_Oct <- get_legend(heatmap_RK4_Oct)

ggarrange(heatmap_RK4_Oct, heatmap_Min_Kfloat_H100_W00_Oct, heatmap_Min_Kfloat_H095_W05_Oct,heatmap_Min_Kfloat_H090_W10_Oct,heatmap_Min_Kfloat_H085_W15_Oct, heatmap_Mean_Kfloat_H100_W00_Oct, heatmap_Mean_KFloat_H095_W05_Oct, heatmap_Max_KFloat_H090_W10_Oct, heatmap_Mean_KFloat_H085_W15_Oct, heatmap_Max_KFloat_H100_W00_Oct,heatmap_Max_KFloat_H095_W05_Oct, heatmap_Max_KFloat_H090_W10_Oct, heatmap_Max_KFloat_H085_W15_Oct, as_ggplot(leg_Oct),labels = c("43","44","45","46","47","48","49","50","51","52","53","54","55"), common.legend = TRUE, legend = c("none"), font.label = list(size = 11, face = "bold"))

```

## Comparison of distances 

There were significant differences among the median distances travelled for all particles in each simulation (Figure 4; p < 0.05). The simulations that considered for 100% hydrodynamic drag travelled a shorter distance than particles for simulations which considered a combination of hydrodynamic and wind drag scenarios. Comparison between simulations that considered hydrodynamic and wind drag show no significant differences with only slight variations among simulations. When comparing distances between passive and kelp particles for April, significant differences are evident. (Figure 11, simulations 17-29; p < 0.05). Kelp particles with only 90% hydrodynamic and 10% wind drag across cross-sectional areas travelled shorter distance across compared to other kelp particles. The shortest distance travelled was the scenario with the maximum cross-sectional area and drag exposure scenarios. No significant differences are evident for the July simulations, with only slight variation across simulations (see Figure 11, simulations 30-42; p > 0.05). In October, the plot shows significant differences when comparing both passive and kelp particles (see Figure 11, simulations 43-55; p < 0.05). Kelp particles with only 90% hydrodynamic drag across cross-sectional areas travelled shorter distance compared to all other particles. As seen in the April simulations, the kelp particles with the maximum cross-sectional area and drag exposure travelled the shortest distance compared to all other particles.

```{r distance plot processing, message=FALSE, warning=FALSE, include=FALSE}

data_dis <- total_data %>% 
  select(!(kelpvelU)) %>%
  select(!(kelpvelV)) %>%
  select(!(velocity)) 
           
total_dis_data <- rbind(p_RK4, data_dis)  

pos <- c("RK4",
         "Min_Kfloat_H100_W00",
         "Min_Kfloat_H095_W05",
         "Min_Kfloat_H090_W10",
         "Min_Kfloat_H085_W15",
         "Mean_Kfloat_H100_W00",
         "Mean_Kfloat_H095_W05",
         "Mean_Kfloat_H090_W10",
         "Mean_Kfloat_H085_W15",
         "Max_Kfloat_H100_W00",
         "Max_Kfloat_H095_W05",
         "Max_Kfloat_H090_W10",
         "Max_Kfloat_H085_W15")

dis_plot <- ggplot(data = total_dis_data, aes(x = type, y = distance, show.legend = FALSE))+
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Scenario")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

custom_labs <- c("1","2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13") #create custom labels and add them to dis_plot

dis_plot <- dis_plot +
  scale_x_discrete(labels= custom_labs)
  
pos_April <- c("RK4_April",             
         "Min_Kfloat_H100_W00_April",
         "Min_Kfloat_H095_W05_April",
         "Min_Kfloat_H090_W10_April",
         "Min_Kfloat_H085_W15_April",
         "Mean_Kfloat_H100_W00_April",
         "Mean_Kfloat_H095_W05_April",
         "Mean_Kfloat_H090_W10_April",
         "Mean_Kfloat_H085_W15_April",
         "Max_Kfloat_H100_W00_April",
         "Max_Kfloat_H095_W05_April",
         "Max_Kfloat_H090_W10_April",
         "Max_Kfloat_H085_W15_April")

dis_plot_April <- ggplot(data = total_data_April, aes(x = type, y = distance, show.legend = FALSE))+
  geom_boxplot(data = p_RK4_April, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Scenario")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

custom_labs_April <- c("17","18","19","20","21","22","23","24","25","26","27","28", "29") #create custom labels and add them to dis_plot

dis_plot_April <- dis_plot_April +
  scale_x_discrete(labels= custom_labs_April)

pos_July <- c("RK4_July",             
         "Min_Kfloat_H100_W00_July",
         "Min_Kfloat_H095_W05_July",
         "Min_Kfloat_H090_W10_July",
         "Min_Kfloat_H085_W15_July",
         "Mean_Kfloat_H100_W00_July",
         "Mean_Kfloat_H095_W05_July",
         "Mean_Kfloat_H090_W10_July",
         "Mean_Kfloat_H085_W15_July",
         "Max_Kfloat_H100_W00_July",
         "Max_Kfloat_H095_W05_July",
         "Max_Kfloat_H090_W10_July",
         "Max_Kfloat_H085_W15_July")

dis_plot_July <- ggplot(data = total_data_July, aes(x = type, y = distance, show.legend = FALSE))+
  geom_boxplot(data = p_RK4_July, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Scenario")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

custom_labs_July <- c("30","31","32","33","34","35","36","37","38","39","40","41", "42") #create custom labels and add them to dis_plot

dis_plot_July <- dis_plot_July +
  scale_x_discrete(labels= custom_labs_July)

pos_Oct <- c("RK4_Oct",              
         "Min_Kfloat_H100_W00_Oct",
         "Min_Kfloat_H095_W05_Oct",
         "Min_Kfloat_H090_W10_Oct",
         "Min_Kfloat_H085_W15_Oct",
         "Mean_Kfloat_H100_W00_Oct",
         "Mean_Kfloat_H095_W05_Oct",
         "Mean_Kfloat_H090_W10_Oct",
         "Mean_Kfloat_H085_W15_Oct",
         "Max_Kfloat_H100_W00_Oct",
         "Max_Kfloat_H095_W05_Oct",
         "Max_Kfloat_H090_W10_Oct",
         "Max_Kfloat_H085_W15_Oct")

dis_plot_Oct <- ggplot(data = total_data_Oct, aes(x = type, y = distance, show.legend = FALSE))+
  geom_boxplot(data = p_RK4_Oct, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Scenario")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

custom_labs_Oct <- c("43","44","45","46","47","48","49","50","51","52","53","54","55") #create custom labels and add them to dis_plot

dis_plot_Oct <- dis_plot_Oct +
  scale_x_discrete(labels= custom_labs_Oct)
```

```{r distance plot, message=FALSE, warning=FALSE, echo = FALSE, fig.cap="Figure 7: Boxplots of total distance travelled by all particles from the release site over the course of the simulation for scenarios 1 - 13, for January 2018 (summer). The x-axis represents the scenario number and the y-axis is the distance travelled in kilometers. The lower and upper hinges correspond to the first and third quartiles. The whiskers represent the range, solid black lines represent the median and black dots are outliers. The reader is referred to tables 1 and 2 for details pertaining to each scenario.", fig.height=7, fig.width=5}

ggarrange(dis_plot, dis_plot_April, dis_plot_July,dis_plot_Oct, label = "AUTO", ncol = 1, nrow = 4)

```

## Accumulation

```{r message=FALSE, echo=FALSE, warning=FALSE}

# January

kelp_acc <- tidync("OceanParcels/trajectory_data/chap3_kelpsim_acc.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
kelp_acc_mean <- kelp_acc %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

kelp_acc$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_mean$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc$age <- with(kelp_acc, age/3600)

pass_acc <- tidync("OceanParcels/trajectory_data/chap3_passivesim_acc.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
pass_acc_mean <- pass_acc %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

pass_acc$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_mean$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc$age <- with(pass_acc, age/3600)

# April

kelp_acc_April <- tidync("OceanParcels/trajectory_data/chap3_kelpsim_acc_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
kelp_acc_mean_April <- kelp_acc_April %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

kelp_acc_April$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_mean_April$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_April$age <- with(kelp_acc_April, age/3600)

pass_acc_April <- tidync("OceanParcels/trajectory_data/chap3_passivesim_acc_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
pass_acc_mean_April <- pass_acc_April %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

pass_acc_April$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_mean_April$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_April$age <- with(pass_acc, age/3600)

total_acc_data_April <- rbind(pass_acc_April, kelp_acc_April)
total_acc_mean_April <- rbind(pass_acc_mean_April, kelp_acc_mean_April)

mean_traj_acc_April <- ggplot() +
  geom_path(data = total_acc_mean_April, aes(x = lon, y = lat, colour = type)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw()

# July

kelp_acc_July <- tidync("OceanParcels/trajectory_data/chap3_kelpsim_acc_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
kelp_acc_mean_July <- kelp_acc_July %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

kelp_acc_July$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_mean_July$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_July$age <- with(kelp_acc_July, age/3600)

pass_acc_July <- tidync("OceanParcels/trajectory_data/chap3_passivesim_acc_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
pass_acc_mean_July <- pass_acc_July %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

pass_acc_July$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_mean_July$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_July$age <- with(pass_acc_July, age/3600)

total_acc_data_July <- rbind(pass_acc_July, kelp_acc_July)
total_acc_mean_July <- rbind(pass_acc_mean_July, kelp_acc_mean_July)

mean_traj_acc_July <- ggplot() +
  geom_path(data = total_acc_mean_July, aes(x = lon, y = lat, colour = type)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw()

# October

kelp_acc_Oct <- tidync("OceanParcels/trajectory_data/chap3_kelpsim_acc_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
kelp_acc_mean_Oct <- kelp_acc_Oct %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

kelp_acc_Oct$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_mean_Oct$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_Oct$age <- with(kelp_acc_Oct, age/3600)

pass_acc_Oct <- tidync("OceanParcels/trajectory_data/chap3_passivesim_acc_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
pass_acc_mean_Oct <- pass_acc_Oct %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

pass_acc_Oct$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_mean_Oct$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_Oct$age <- with(pass_acc_Oct, age/3600)

total_acc_data_Oct <- rbind(pass_acc_Oct, kelp_acc_Oct)
total_acc_mean_Oct <- rbind(pass_acc_mean_Oct, kelp_acc_mean_Oct)

mean_traj_acc_Oct <- ggplot() +
  geom_path(data = total_acc_mean_Oct, aes(x = lon, y = lat, colour = type)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw()

## Coastline of Southern Africa
load("map/south_africa_coast_hi_res.Rdata")

# January

heatmap_RK4_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = pass_acc, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = pass_acc_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Passive particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_kelp_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = kelp_acc, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = kelp_acc_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Kelp particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_RK4_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = pass_acc, aes(x = lon, y = lat, colour = distance)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_kelp_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = kelp_acc, aes(x = lon, y = lat, colour = age)) +
  #scale_fill_continuous(type = "viridis", limits = c(0, 30)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Age")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# April

heatmap_RK4_acc_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = pass_acc_April, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = pass_acc_mean_April, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Passive particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_kelp_acc_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = kelp_acc_April, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = kelp_acc_mean_April,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Kelp particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_RK4_acc_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = pass_acc_April, aes(x = lon, y = lat, colour = distance)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_kelp_acc_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = kelp_acc_April, aes(x = lon, y = lat, colour = age)) +
  #scale_fill_continuous(type = "viridis", limits = c(0, 30)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Age")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# July

heatmap_RK4_acc_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = pass_acc_July, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = pass_acc_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Passive particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_kelp_acc_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = kelp_acc_July, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = kelp_acc_mean_July,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Kelp particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_RK4_acc_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = pass_acc_July, aes(x = lon, y = lat, colour = distance)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_kelp_acc_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = kelp_acc_July, aes(x = lon, y = lat, colour = age)) +
  #scale_fill_continuous(type = "viridis", limits = c(0, 30)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Age")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# October

heatmap_RK4_acc_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = pass_acc_Oct, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = pass_acc_mean_Oct, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Passive particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_kelp_acc_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = kelp_acc_Oct, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "viridis", limits = c(1, 720)) +
  geom_path(data = kelp_acc_mean_Oct, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Kelp particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_RK4_acc_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = pass_acc_Oct, aes(x = lon, y = lat, colour = distance)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_kelp_acc_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = kelp_acc_Oct, aes(x = lon, y = lat, colour = age)) +
  #scale_fill_continuous(type = "viridis", limits = c(0, 30)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Age")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

total_acc_data <- rbind(pass_acc, kelp_acc, pass_acc_April, kelp_acc_April,pass_acc_July, kelp_acc_July,pass_acc_Oct, kelp_acc_Oct)
total_acc_mean <- rbind(pass_acc_mean, kelp_acc_mean, pass_acc_mean_April, kelp_acc_mean_April, pass_acc_mean_July, kelp_acc_mean_July, pass_acc_mean_Oct, kelp_acc_mean_Oct)

mean_traj_acc <- ggplot() +
  geom_path(data = total_acc_mean, aes(x = lon, y = lat, colour = type)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw()


# Distance

#dis_plot_acc <- ggplot(data = total_acc_data, aes(x = type, y = distance, show.legend = FALSE)) +
#  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
#  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = "right") +
#  theme_bw() +
#  ylab("Distance (km)") +
#  xlab("Scenario") +
  #coord_flip() +
#  theme_bw()
  #theme(plot.title = element_text(hjust = 1))

```

```{r accumulation data outputs, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 8: Comparison of density between passive and kelp accumulation scenarios for each season.For each month, passive particles are plotted on the left colum", fig.height=9, fig.width=7}

ggarrange(heatmap_RK4_acc, heatmap_kelp_acc,heatmap_RK4_acc_April, heatmap_kelp_acc_April, heatmap_RK4_acc_July, heatmap_kelp_acc_July, heatmap_RK4_acc_Oct, heatmap_kelp_acc_Oct, common.legend = TRUE, legend = c("bottom"), ncol = 2, nrow = 4, labels = c("January", "", "April", "","July", "", "October"), font.label = list(size = 11, face = "bold"), align = "hv")

```

```{r age data outputs, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 9: Comparison of age between passive and kelp accumulation scenarios.", fig.height=9, fig.width=7}

ggarrange(point_RK4_acc, point_kelp_acc, point_RK4_acc_April, point_kelp_acc_April, point_RK4_acc_July, point_kelp_acc_July, point_RK4_acc_Oct, point_kelp_acc_Oct, common.legend = TRUE, legend = c("bottom"), ncol = 2, nrow = 4, labels = c("January", "", "April", "","July", "", "October"), font.label = list(size = 11, face = "bold"), align = "hv")

```

The role of eddies that exist within the study domain over the time period play a clear role in the accumulation and dispersal of kelp particles. Passive particles tend to remain on the outer edge of the eddy and then are expelled on the other side and continue to follow the ocean current (see Figure 8). The opposite is true for kelp particles which have the highest exposure level of hydrodynamic and wind drag. The kelp particles are entrained in the eddy (see Figure 8). This is also reflected when comparing the age of particles at the end of the simulation. In Figure 9, younger particles are near the release site and older particles further away from shore, while older kelp particles are retained in the eddy. 

# Discussion

The treatment of drifting macroalgae as purely Lagrangian will not be able to accurately determine patterns of passive dispersal, such as entrainment in eddies or vortices [@fossette2012; @miron2020]. Although past research has shown the inclusion of inertia and windage greatly increase observed macroalgae trajectory and entrainment characteristics [@putman2018; @brooks2018;@brooks2019; @putman2020], past research has focused on large macroalgal-rafts which can vary greatly in size and surface area. None of the past research has taken advantage of the advancement in numerical ocean models and Lagrangian trajectory modeling to investigate how aspects of drag (hydrodynamic and wind) affect the trajectory patterns of solitary drifting macroalgae. This study compared particles trajectories with simulations that included no forms of drag with simulations that included various forms of both hydrodynamic and wind drag. The mean virtual kelp trajectory deviated from the mean passive  trajectory when including varying levels of hydrodynamic and wind drag scenarios. The results from this study show the inclusion of hydrodynamic and wind drag results in observable entrainment patterns, and broadens our understanding of how surface area plays a role in solitary drifting macroalgae trajectory, in this case that of *E. maxima*.

Past research has inferred from direct and indirect techniques that drifting macroalgae tend to follow the prevailing surface currents [@thiel2005; @hobday2000; @fraser2011; @rothausler2011; @rothausler2011]. The results from this numerical experiment confirm that drifting macroalgae do follow the surface current in the study region when considering only hydrodynamic drag. In addition, not only are the trajectories similar but so are the end points at the end of simulation. However, when *ad hoc* wind drag (windage) is considered in combination with hydrodynamic drag the end locations differ greatly when compared to purely Lagrangian particle trajectories. The inclusion of wind drag causes the kelp particles to flow further away from the coast and with a greater distance travelled from the release location. The difference in trajectory and distance covered can be attributed to the inclusion of wind drag. Wind drag adds to the effects of hydrodynamic drag when the wind direction and current direction are opposite to each other. However, when the wind direction is in the same or similar direction to that of the current, momentum energy from the wind is transferred to the object [@hackett2006; @putman2020]. This causes the kelp particles to travel further as well as exposed to different time varying flows. Past studies have shown this when including windage as a function of inertia [@putman2018;@brooks2019; @putman2020]. A study by @putman2020 used *ad hoc* windage factors that was based on the surface current velocity to assess the approach for improving transport predictions of pelagic *Sargassum sp*. The results showed that including ad-hoc windage factors improved virtual trajectories compared to tracked *Sargassum sp* mats which was partly due to the inclusion of momentum energy transfer from wind. This is also reflected in the analysis comparing distances travelled by all the particles in each simulation. The particles in the simulations that included wind drag traveled significantly greater distances compared to the passive or hydrodynamic only drag. Similar patterns are seen in the additional simulations run for April (autumn), July (winter), and October (spring); however even kelp particles with only hydrodynamic drag flow further compared to passive particles in these times of the year. This may be a result of the kelp particles exposed to different time-varying flows, which results in the kelp particles following a different surface current vector compared to passive particles. This also results in different end-points and therefore these results further confirm that drag is an important factor to account for when investigating macroalgal drift patterns.

The addition of drag forces causes the kelp particles to cluster together along the mean trajectory compared to that of the passive particles which are more evenly dispersed. This is most likely due to the shared drag characteristics among the kelp particles which included the plants weight and surface area into the calculation. Other studies investigating flotsam trajectory characteristics have found similar results [@breivik2011; @olascoaga2020; @miron2020]. A study by @miron2020 conducted field experiments using a range of objects such as spheres, cubes, and cuboids to compare to investigate the effect of inertia on particles dynamics. The results from the study showed that objects tended to cluster according to the shape of the object which the authors attributed to shared characteristics of inertia. Although drag forces and not inertia were used in this study, the same conclusion applies; drag is therefore an important characteristic to consider when investigating or predicting solitary drifting macroalgae trajectory. 

The ocean is comprised of time-varying flows and changes in an objects velocity that can cause the object to be exposed to different flow patterns over time. The lack of dissimilarity in trajectory between different cross-sectional area types (minimum, mean and maximum) suggests that reduction in velocity in relation to cross-sectional area is negligible. A similar result was found by @gouvello2020 who investigated the effects of swimming behavior on sea turtle hatchling dispersal in the Agulhas region. The results suggested that the hatchling trajectories are mostly influenced by the ocean currents in the first year of hatching due as juveniles do not swim fast enough to alter their overall trajectory. Therefore, the differences in cross-sectional area types may not be significant enough to have an effect on the relevant zonal and meridional velocity vectors. Another possible reason is the resolution of the ocean model used. The resolution of the underlying ocean model is an important aspect of Lagrangian ocean modeling and must be able to resolve sub-grid scale ocean processes for finer scale applications. A study by @hart2018 assessed the inclusion of stochastic motion, wind and currents into forecasting for search and rescue using the same model ocean model used in this study. The authors found that the inclusion of Brownian motion greatly increased the accuracy in representing sub-grid scale processes and that the inclusion of wind, currents and stochastic motion greatly improved forecasting applications. Therefore, the authors argue that the lack of dissimilarity between simulations of different cross-sectional area and drag exposure scenarios is not as a result of the resolution of the model. 

The same is also true when comparing different hydrodynamic and wind drag exposure scenarios. These scenarios reflect different buoyancy situations which result in different amounts of surface area exposed to hydrodynamic and/or wind drag. The similarities between the different combined drag scenarios suggest that higher magnitudes of wind exposure do not significantly alter trajectories. Instead, the results from this study suggest that the inclusion of drag forces in simulating macroalgal trajectory may result in improving accuracy of entrainment patterns. All the simulations that included any form of drag resulted in a high density of particles entrained in an eddy. The entrainment and expulsion from eddies and vortices are an important characteristic of floating macroalgae. Accuracy in predicting entrainment and expulsion of macroalgae-rafts from eddies has been investigated previously by @putman2018 and @putman2020, who show that including windage greatly improves entrainment patterns when comparing virtual and real *Sargassum* rafts. However, these studies investigated large rafts and not floating individuals. Inertia is based on the size/mass of the raft, while hydrodynamic and wind drag are based on current velocity and surface area. Therefore, the role of inertia may be negligible for a solitary individual and rather other forms of drag, such as in this study, should be considered. The results from this study suggest that the inclusion of hydrodynamic and/or wind drag is an important component when simulating virtual kelp particles, and will greatly increase the accuracy of entrainment and expulsion from sub-grid mesoscale oceanographic features, such as eddies and vortices.

The role of eddies and vortices in the entrainment of kelp is further supported by the accumulation simulations. These results clearly show that the inclusion of drag greatly increases the number of particles entrained in the eddy within the study domain. Eddies and vortices may act as accumulation zones for kelp where the formation of rafts may occur, or the kelp is entrained for long enough to eventually sink in area below the eddy. In a study by @woodborne1989 references a site offshore approximately 120 km from Cape Columbine where dredged kelp was found. The area referenced by @woodborne1989 coincides with the area where virtual kelp are entrained by an eddy. The use of a cylindrical shape coefficient instead of a sphere in the calculation of drag force also had no effect on the mean trajectory. Instead, the inclusion of a different shape coefficient increased to the density of particles entrained in an eddy field. Therefore, more accurately parameterizing shape will therefore allow for further improvements in models of macroalgal dispersal patterns. 

# Conclusion

Most of the past research has focused on large macroalgae rafts which can vary greatly in size and shape; however, no research exists to clarify the drifting characteristics of solitary macroalgae. Understanding how to accurately model the distribution of solitary kelp can lead to be understanding of accumulation zones and sinks and ultimately the ecological links pertaining to those processes. The findings from this study indicate that solitary floating virtual *E. maxima* particles tend to follow the prevailing surface currents and the inclusion of wind causes the trajectories to differ greatly from that of a purely Lagrangian particle. Furthermore, the inclusion of both hydrodynamic and wind drag cause clustering of particles along the trajectory as well causing particles to become entrained in eddies. Different cross-sectional areas exposed to hydrodynamic and wind drag had no effect on overall trajectory suggesting that those differences are negligible when investigating dispersal patterns of drifting *E. maxima*. In addition, the use of a cylindrical shape coefficient has no effect on mean trajectory, but it does cause higher density of particles to become entrained in an eddy. Overall, the inclusion of drag forces is an important aspect to consider when investigating the dispersal patterns of solitary macroalgae, while differences in cross-sectional areas are not. This study also provides an approach which can be adapted to model any floating solitary macroalgae, provided the surface area can be estimated accurately. Gaps in the research exist when considering what oceanographic processes play a role in solitary macroalgal dispersal as well as how these vary seasonally. The identification of biological and physical factors that play a role in accumulation zones is also needed, as well as better estimates for sinking rates and raft-times. 

# References

# Appendix

```{r shape data, message=FALSE, echo=FALSE, warning=FALSE}

load("map/south_africa_coast_hi_res.Rdata")

# January

sphere <- tidync("OceanParcels/trajectory_data/Max_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
sphere_mean <- sphere %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

sphere$type <- "Sphere" 
sphere$Month <- "January" 
sphere_mean$type <- "Sphere" 

# read in data again for one max simulation, as cannot sort issue out with rename df...
cyl <- tidync("OceanParcels/trajectory_data/Max_ShapeFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
cyl_mean <- cyl %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

cyl$type <- "Cylinder" 
cyl$Month <- "January" 
cyl_mean$type <- "Cylinder" 


# Make mean trajectory plot
shape_plot <- ggplot()+
  #geom_path(data = p_RK4_mean, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = sphere_mean, aes(x = lon, y = lat), color = 'blue')+
  geom_path(data = cyl_mean, aes(x = lon, y = lat), color = 'red')+
  xlab("Longtitude") + 
  ylab("Latitude") +
  ggtitle("January") +
  #guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# make density map
heatmap_sphere <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = sphere, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = sphere_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  ggtitle("") + 
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_cyl <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = cyl, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = cyl_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# April

sphere_April <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H100_W00_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
sphere_mean_April <- sphere_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

sphere_April$type <- "Sphere" 
sphere_April$Month <- "April" 
sphere_mean_April$type <- "Sphere" 

# read in data again for one max simulation, as cannot sort issue out with rename df...
cyl_April <- tidync("OceanParcels/trajectory_data/Max_ShapeFloat_H100_W00_April.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
cyl_mean_April <- cyl_April %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

cyl_April$type <- "Cylinder" 
cyl_April$Month <- "April" 
cyl_mean_April$type <- "Cylinder" 


# Make mean trajectory plot
shape_plot_April <- ggplot()+
  #geom_path(data = p_RK4_mean_April, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = sphere_mean_April, aes(x = lon, y = lat), color = 'blue')+
  geom_path(data = cyl_mean_April, aes(x = lon, y = lat), color = 'red')+
  xlab("Longtitude") + 
  ylab("Latitude") +
  ggtitle("April") +
  #guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# make density map
heatmap_sphere_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = sphere_April, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = sphere_mean_April, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  ggtitle("") + 
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_cyl_April <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = cyl_April, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = cyl_mean_April, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# July

sphere_July <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H100_W00_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
sphere_mean_July <- sphere_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

sphere_July$type <- "Sphere" 
sphere_July$Month <- "July" 
sphere_mean_July$type <- "Sphere" 

# read in data again for one max simulation, as cannot sort issue out with rename df...
cyl_July <- tidync("OceanParcels/trajectory_data/Max_ShapeFloat_H100_W00_July.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
cyl_mean_July <- cyl_July %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

cyl_July$type <- "Cylinder" # add extra column 'type' to dataframe and assigned 'kelp' label
cyl_July$Month <- "July" # add extra column 'type' to dataframe and assigned 'kelp' label
cyl_mean_July$type <- "Cylinder" # add extra column 'type' to dataframe and assigned 'kelp' label


# Make mean trajectory plot
shape_plot_July <- ggplot()+
  #geom_path(data = p_RK4_mean_July, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = sphere_mean_July, aes(x = lon, y = lat), color = 'blue')+
  geom_path(data = cyl_mean_July, aes(x = lon, y = lat), color = 'red')+
  xlab("Longtitude") + 
  ylab("Latitude") +
  ggtitle("July") +
  #guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# make density map
heatmap_sphere_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = sphere_July, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = sphere_mean_July, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  ggtitle("") + 
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_cyl_July <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = cyl_July, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = cyl_mean_July, aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# October

sphere_Oct <- tidync("OceanParcels/trajectory_data/chapter3_additional/Max_KFloat_H100_W00_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
sphere_mean_Oct <- sphere_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

sphere_Oct$type <- "Sphere" 
sphere_Oct$Month <- "October" 
sphere_mean_Oct$type <- "Sphere" 

# read in data again for one max simulation, as cannot sort issue out with rename df...
cyl_Oct <- tidync("OceanParcels/trajectory_data/Max_ShapeFloat_H100_W00_Oct.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
cyl_mean_Oct <- cyl_Oct %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

cyl_Oct$type <- "Cylinder" 
cyl_Oct$Month <- "October"
cyl_mean_Oct$type <- "Cylinder" 


# Make mean trajectory plot
shape_plot_Oct <- ggplot()+
  #geom_path(data = p_RK4_mean_Oct, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = sphere_mean_Oct, aes(x = lon, y = lat), color = 'blue')+
  geom_path(data = cyl_mean_Oct, aes(x = lon, y = lat), color = 'red')+
  xlab("Longtitude") + 
  ylab("Latitude") +
  ggtitle("October") +
  #guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# make density map
heatmap_sphere_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = sphere_Oct, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = sphere_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  ggtitle("") + 
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_cyl_Oct <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = cyl_Oct, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "viridis", limits = c(1, 13000)) +
  geom_path(data = cyl_mean_Oct,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# Distance plot

shape_data_total <- rbind(sphere, cyl, sphere_April, cyl_April, sphere_July, cyl_July, sphere_Oct, cyl_Oct)
shape_pos <- c("January", "April", "July", "October")
shape_dis_plot <- ggplot(data = shape_data_total, aes(x = Month, y = distance, show.legend = TRUE, fill = type))+
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = TRUE, stat = "boxplot") +
  scale_x_discrete(limits = shape_pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif")+
  ylab("Distance (km)")+
  xlab("Month") + 
  ggtitle("Comparison of distance travelled") +
  guides(fill=guide_legend(title="Coefficient")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r shape data outputs, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 9: Comparison of trajectory data between spehere and cylinder shape coeficients.The mean trajectory comparison between passive and kel The reader is referred to tables 1 and 2 for details pertaining to each scenario.", fig.height=10, fig.width=8}

shape_plot_A <- ggarrange(shape_plot, shape_plot_April, shape_plot_July, shape_plot_Oct, heatmap_sphere, heatmap_sphere_April,heatmap_sphere_July, heatmap_sphere_Oct, heatmap_cyl, heatmap_cyl_April, heatmap_cyl_July, heatmap_cyl_Oct, common.legend = TRUE, legend = c("bottom"), ncol = 4, nrow = 3, align = "hv", labels = c("A", "", "", "", "B", "", "", "", "C"), font.label = list(size = 11, face = "bold"))

ggarrange(shape_plot_A, shape_dis_plot, ncol = 1, nrow = 2, legend = c("right"), labels = c("", "D") , font.label = list(size = 11, face = "bold"))

```



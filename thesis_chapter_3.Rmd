---
title: 'A numerical experiment investigating the influence of drag in trajectory patterns of floating macroalgae'
author: 
- R Coppin^[University of the Western Cape], C Rautenbach^[National Institute of Water and Atmospheric Research], AJ Smit^[University of the Western Cape]
output:
  word_document:
    reference_docx: markdown/frontiers_template.docx
  html_document:
  pdf_document:
    fig_caption: yes
    latex_engine: xelatex
bibliography: references.bib
csl: markdown/frontiers.csl.txt
abstract: "**Abstract**: The ocean currents act as an important dispersal mechanism of material on the ocean surface, both natural and anthropogenic. Macroalage are one of the most important natural dispersal mechanisms, and are regarded as the tumble-weed of the ocean. Despite the many studies that exist, the relative role of wind and surface currents in macrolage trajectory is still unknown. Past studies also focus on kelp-rafts, which can vary greatly in size making it difficult to form a concensus as to the relative role of wind versus surface currents. In addition, past studies have not conisidered surface-area in relation to drag characterisics of floating macroalgae, which have been shown to play a role in the trajectory and accumulation of other flotsam. The advances in Lagrangian trajectory modeling has been exponential in recent years and allows the use of numerical experiments to investigate trajectory of flotsam in the ocean. This study aimed to shed light on the relative role of wind versus surface currents, and the role of drag in macrolagae trajectory and accumulation. This study did not investigate kelp-raft behaviour but instead focused on solitary kelp individuals. This was achieved by comparing simulations of virtual kelp particles which incorporate drag with that of purley Lagrangian particles. The results showed that the virtual kelp particles do follow the ocean currents in general, but that the inclusion of drag into the scenarios causes accumulation in eddies within the study domain. The results also point to the importance of sub-mesoscale features, such as eddies, as important surface accumlation zones for solitary floating macroalage."
---

```{r software, message=FALSE, warning=FALSE, include=FALSE}
## Load software need for entire script

#library(computeMSD)
library(ggplot2)
library(rgdal)
library(gridExtra)
library(ggpubr)
library(ggord)
library(mapproj)
library(vegan)
library(dplyr)
library(ggpubr)
library(maps)
library(flextable)
library(officer)
library(tidync)
library(tidyverse)
library(hexbin)
library(lubridate)

```


# Introduction

There are a range of objects, both natural and anthropogenic, floating in the ocean of which macroalgae are regarded as one of the most important passive dispersal mechanisms of marine taxa. Floating kelp acts as a passive dispersal mechanism for a range of marine taxa and is sometimes referred to as the 'tumble-weed' of the ocean [@edgar1987; @bushing1994; @norton1992; @helmuth1994; @holmquist1994; @smith2002; @McCormick2008]; as well as input of allochthonous materials to near and distant ecosystems [@cartraud2021; @colombini2003; @Filbee-Dexter2018-wp; @zuercher2019; @Krumhansl2012; @vanderklift2008; @bustamante1995]. 

Some macroalgal species are negatively buoyant and sink to the seafloor when detached from the substrate, while other species of macroalgae have air-filled pneumatocysts or stipes which allow the plants to reach the surface where light is more abundant. In turn, the positively buoyant pneumatocysts cause plants to float to the surface when dislodged from the substratum. The structure and number of pneumatocysts varies between species. For example species from the genera *Macrocystis*, *Sargassum*, *Ascophyllum*, and *Fucus* have thalli with many small pneumatocysts, while other kelp species such as *Nereocystis luetkeana*, *Pelagophycus porra*, *Ecklonia radiata*, *Ecklonia maxima* have a single, large pneumatocysts [@dayton1985; @smith2002; @thiel2005; @graiff2016; @batista2018]. In some cases the stipe itself is air-filled, such as with *E. maxima* and *E. radiata*. Although there have been reports of floating Chlorophyta species and some Rhodophyta species, Phaeophyceae species are the most reported forms of floating algae. This is most likely because the green and red species reported floating are not actually positively buoyant, but instead are kept at the surface by gas trapped in-between or in the thalli [@dromgoole1982; @back2000]. The giant kelp *Macrocystis pyrifera* [@helmuth1994; @kingsford1995; @hobday2000; @macaya2005; @graiff2016; @batista2018], the bull kelp *Durvillaea antarctica* [@collins2010; @tala2013 ; @tala2017; @saunders2014; @smith2002; @wichmann2012; @batista2018], and pelagic *Sargassum* species [@putman2020; @brooks2019; @putman2018; @brooks2018; @wang2019] have been the focus of much of the research regarding spatial and temporal dispersal patterns, the ecological role of rafting, marine connectivity and raft-time.

Past research points to macroalgae trajectory being largely determined by prevailing wind conditions and surface currents [@thiel2005; @hobday2000; @fraser2011; @rothausler2011; @rothausler2011]. Although ocean currents are regarded as the primary influence, the relative importance of wind versus surface current is still unknown although the role of wind has been recognised as important in several studies. For example, a study by @harrold1989 investigated the seasonal trajectories of radio-transmitter tagged *M. pyrifera* in nearshore Monterrey Bay. The results showed that kelp rafts, with little surface area, exposed to the wind were largely driven by a combination of wind and surface currents, however the relative importance of wind and was not clear. In addition, the trajectories of tagged kelp were more consistent with the formation of eddies during winter. Previous studies have identified wind as an important mechanism of dispersal in wind dominated ocean systems. For example, in the sub-Antarctic latitudes the West Wind Drift causes continuous unidirectional surface flow and is regarded as an important potential mechanism for dispersal of floating bull kelp *Durvillaea antarctica*. Other studies have used genetic approaches to determine macroalgae raft trajectory characteristics by inferring source location from genetically similar populations [@nikula2013]. For example, a study by @fraser2011 on the rafting capabilities of *D. antarctica* used a combination of population genetics and relative age estimate of goosebarnacles attached to the raft. The presence of goosebarnacles suggests a long raft time as these species have a slow growth rate. Genetic analyses showed these species are able to raft up to $\sim$ 390km from their local origin. The authors suggested that wind and water-movement were the primary influences of trajectory; however, this was only inferred from the genetic results and local climatology data [@fraser2011]. Past research has shown that buoyancy and drag also play a role in determining the trajectory and rate of transport for surface floating material [onink2019; @shen2019; @dasaro2018; @gates2018; @beron2016; @trinanes2016; @furnans2008]. The 'sail' area of an object floating at sea is the surface area exposed to the wind which results in air form drag, while the area of the object below the surface of the water is exposed to surface currents which result in hydrodynamic form drag [@breivik2011; @griffin2017]. In addition, past research conducted within the maritime industry has shown that the size and shape of a vessel determine the relative importance of waves or wind as drivers of trajectory, as well as orientation of the object. If the length of the object is longer than the significant wave height then waves will be the primary driver of trajectory while the opposite is true for smaller objects where the effect of waves is regarded as negligible [@breivik2011; @griffin2017]. Drag is ultimately determined by the size and shape of the object which are properties that vary considerably with macroalgae species. 

To accurately determine the trajectory of marine macroalgae water and wind drag need to be taken into account. Past research by @allen1999 and @breivik2011 have provided estimates of drag for various objects based on experimental work, which consisted of both direct and indirect methods of the Leeway model. However, this work does not consider biological material such as macroalgae. Although drag estimates do exist, these have been applied for macroalgae not detached from the substratum and are regarded as fixed-point estimates. Although various approaches have been used in the past to investigate floating macroalgal trajectories, very few studies have employed the use of Langrangian trajectory modeling. Furthermore, none of the existing studies using this modeling approach have considered macroalgal morphology cross-sectional area (**i.e.** shape) as an aspect of drag and ultimately trajectory. Studies by @brooks2019, @putman2018, and @putman2020 used Lagrangian approaches to investigate the effects of inertia, raft-size, and windage on macroalgae trajectory. @brooks2019 used a custom growth model to estimate changes in biomass and ultimately radial size, while a customised Hybrid Coordinate Ocean Model (HYCOM) for the trajectory simulations was used. The results showed that trajectory of pelagic *Sargussum* was significantly influenced by inertia and the radial size of the rafts. Other work by @putman2020 investigated the effect of including windage in macroalgae trajectory simulations. The authors showed that including **ad-hoc** windage factors greatly improved accuracy regarding entrainment or expulsion from eddies when compared to tracked sargassum mats in the ocean. Langrangian trajectory modeling is a useful tool, however, the various models available often assume the object to be a spherical particle, which is obviously not the case for both biological and anthropogenic forms of marine debris in nature. The radial size included by @brooks2019 is an improvement, however this approach does not consider the complex morphology on an individual level into account.

In addition, past studies focus on kelp-rafts, not solitary floating kelp, and therefore are not able to investigate the role of eddies and vortices in the accumulation of kelp at the surface. Gyres, eddies and converging surface currents have been identified as important in the accumulation and dispersal of plastics and other marine debris [@onink2019; @dasaro2018; @brach2018]. Past studies investigating the dispersal of marine debris have also included the possible effects of inertia in accumulation of ocean drifter instruments in mesoscale features. For example, a study by @beron2016 used a modeling approach to investigated the role of Eckman transport and inertia to explain the observed behavior of undrogued drifters in the ocean gyres. Undrogued drifter trajectory is affected by wind unlike the drogue counter parts which makes the effects of wind negligible. The results showed that the combined effect inertia, not Eckman transport, played a significant role in the observed drifter behavior [@beron2016]. The authors also noted that the presence of other flotsam along with the undrogued drifters in ocean gyres also suggests that aspects inertia also play a role in accumulation of other marine debris [@beron2016]. The approach by @beron2016 has also been improved upon by @beron2019 but also shows the significant role of inertia in flotsam trajectory and accumulation. 

In this study, a numerical approach is used to shed light on the role of hydrodynamic and direct wind drag on macroalgal drift trajectory using Lagrangian based trajectory simulations. It should be noted that this study does not attempt to characterise the dispersal of drifting macroalage within the study domain. The authors argue that too little is know about the drift characteristics of solitary floating macroalgae to characterise dispersal effectivley. Instead, this study will aim to shed light on the 'behaviour' of surface drifting macroalgae from a coastal environment into the open ocean, which will inform future characterisation studies. This will be achieved by comparing the trajectory outputs of virtual 'passive' particles (no drag characteristics added) with kelp particles (drag characteristics added) of varying degrees of hydrodynamic and wind drag exposure. The different degrees of wave and wind exposure are meant to reflect the different buoyancy characteristics, as well as identify the role of magnitude of the drag components on overall trajectory. In addition, the modeling of single kelp offers the opportunity to study the role of eddies and vortices in accumulation points on the surface. Therefore, separate simulations will be run to compare the entrained characteristics of passive particle with a kelp particle. 

# Methods
## Study site

The region of interest for this study was the Cape Peninsula in the Western Cape (Figure 1A). A release site was chosen for this study, Kommetjie, which is located on the Atlantic side of the Cape Peninsula (Figure 2B). The hydrodynamics in the study region are driven by a complex interaction of wind and waves, which are also influenced by larger oceanic processes. In South Africa, the larger processes can be attributed to the Agulhas Current (AC) and the Benguela Current (BC)[@lutjeharms2000; @lutjeharms2007 ;@garzoli1996 ;@hutchings2009; @rubio2009]. The AC is a component of the South-west Indian Ocean sub-gyre, flowing predominantly south-westward following the continental shelf edge and eventually retroflecting eastward back into the South Indian Ocean [@lutjeharms2000;@lutjeharms2007]. The region where the retroflection occurs is known as the Agulhas Retroflection and consists of high levels of mesoscale variability [@garzoli1996]. The variability results in shedding of rings and filaments known as the Agulhas Rings and have an average diameter of ~324km [@lutjeharms1988; @lutjeharms2006; @lutjeharms2007]. The Agulhas Rings are the main contributors to the Agulhas leakage which are the transport of warm water from the Indian Ocean to the South Atlantic Ocean [@garzoli1996; @lutjeharms2006; @beal2015]. The Agulhas leakage is also a source of meso-scale variability within the Benguela region as anticyclonic rings are shed and drift northwestward along the southern Benguela slope region [@rubio2009]. The Benguela region is characterised by strong coastal upwelling cells which are primarily driven by equatorward winds [@shannon1996; @hardman2003]. It is known as the Benguela Upwelling System (BUS) The BUS starts at 27$^\circ$S and extends southward to 35$^\circ$S [@shannon1996]. The region is also characterised by high amounts of mesoscale variability in the form of eddies and filaments [@blanke2002; @blanke2005; @rubio2009]. The Benguela inshore region is dominated by a northwestward flow because of topographical steering, wind stress and interactions with passing Agulhas Rings and eddies [@veitch2010]. 

```{r map, echo=FALSE, message=FALSE, warning=FALSE, strip.white=TRUE, fig.cap="Figure 1:Map of the study domain and the main features pertaining to transport in the region. In panel A, the map of the entire South African coastline and the main currents presented. The resulting eddies and filaments from the Agulhas retroflection and study area are presented. In panel B, the splitting of the Benguela Jet, eddie features and general flow of the study domain are presented. The release site is represented by a blue star."}

library(png)
library(grid)
library(gridExtra)

#map_chp3A <- rasterGrob(as.raster(readPNG("map/chp3_mapA.png")))
#map_chp3B <- rasterGrob(as.raster(readPNG("map/chp3_mapB.png")))
#ggarrange(map_chp3A, map_chp3B, ncol = 2, nrow = 1, labels = "AUTO", align = c("h"))
map_chp3_combined <- rasterGrob(as.raster(readPNG("map/ch3_map_final.png")))
ggarrange(map_chp3_combined)

```

The study domain falls within the southern Benguela upwelling ecosystem, which is a region of high mesoscale variability and activity. These occur mostly in the form of eddies, filaments and vortices which are generated from the Agulhas retroflection [@veitch2018; @veitch2017], generally flowing northward along the coastline and begin to move offshore near Cape Columbine. The Benguela Jet is a coastal flowing current and is driven by a complex interaction of eddies, upwelling, eckman transport and geostrophic currents [@stramma1989; @veitch2017; @veitch2018; @hutchings2009]. The stability of the jet varies seasonally with more stable flows in winter and splitting of the jet during summer and spring. In January, the jet begins to split between Cape Point and Cape Columbine [@veitch2018; @blanke2005; @blanke2002] which results into a weak narrow inshore branch which flows along the shelf edge and a strong flowing north-westwards offshore branch. The area is also an area of high upwelling activity driven by strong westerly winds [@hutchings2009]. These winds are most intense during summer (December-March) which favours upwelling conditions in the region, and also act to reinforce the flow of the Benguela Jet; which occurs due to cold upwelling waters contributing to the across-shore density gradient [@ragoasha2019]. In winter the wind direction is reversed which decreases upwelling favorable conditions, but the core of the Benguela jet is maintained by the intrusion of warm agulhas waters into the Benguela region over the shelf edge [@veitch2018; @hutchings2009; @ragoasha2019].   

## Particle tracking model

The model is based on parameterisations that have been used for previous studies investigating iceberg, capsized marine vessels and microplastics. It should be noted that most of the previous studies regarding macroalgae trajectory have investigated rafts and not solitary floating individuals. A kelp raft will vary in size and can range from a few meters across to large dense mats the size of a rugby field. Furthermore, some authors suggest that most macroalgae become entangled through ocean currents and not through the hydrodynamic forces that dislodge them. In addition, large kelp rafts are not a feature around the coast of the Cape Peninsula; rather, solitary kelp are (pers. obs). Therefore, the trajectory of only solitary *E. maxima* individuals will be considered. Numerical calculations of particle trajectory were performed with a Lagrangian method [@delandmeter2019], and be described by the equation

$$X(t+\Delta t) = X(t) + \int_{t}^{t+\Delta t} v(x, \tau)d \tau + \Delta X_b(t)$$
where $X$ is the three-dimensional position of a particle, $v(x,t)$ is the three-dimensional velocity field at the location in the ocean model at particle point in time, $t$ is time, $X_b(t)$ is a change in position due to 'behavior' of the particle at a particular point in time. This can range from swimming in fish to sinking or beaching. In order to investigate the effects of drag components of trajectory of floating macroalgae, this study incorporated drag as the custom behavior. 

This study simulated two scenarios; one where the plant is fully submerged and only exposed to hydrodynamic drag; and the other where parts of the plants are partially exposed resulting in a combination of hydrodynamic and air form drag. Drag based on shape-based coefficients were used in the calculations for determining the overall kelp velocity vectors. A momentum energy equation was used to calculate the drag forces for the relevant simulation. This approach has been employed in modeling iceberg drift trajectory [@andersson2017; @lichey2001; @eik2009] and was adapted to suit this study. The energy momentum equation used to calculate the drag force exerted on the virtual kelp particle was, $$m({d_u/d_t})=F_d + F_a + F_f$$
where $m$ is kelp mass, $d_u$ the virtual kelp particle velocity, $F_d$ the hydrodynamic drag, $F_a$ is the wind drag, $F_f$ the surface-current flow, and $d_t$ is the time step. The assumption made was that the mass of the kelp did not change for each virtual kelp particle over the course of the simulations. Hydrodynamic drag, wind drag and surface current-flow are two-dimensional vector quantities and were calculated for each time step for each simulation. 

## Simulations

Virtual particles were released with no drag or wind effects from the study site in order to act as a reference for comparison to simulations with varying degrees of hydrodynamic and wind drag, and are referred to hereafter as 'passive particles'. All particles that have any form of drag exposure are hereafter referred to as 'kelp' particles. All simulations have the same release location (Kommetjie) and were run for 30 days with hourly outputs using a fourth order Runge-Kutte advection scheme [@North2009; @VanSebille2018]. Brownian motion was also incorporated in order to account for any stochasticity not resolved by the model. These are standard practices for Lagrangian trajectory studies [@North2009;@delandmeter2019; @VanSebille2018]. To test the different magnitudes that hydrodynamic and wind drag might play in the overall trajectory, simulations were run with varying degrees of drag exposure scenarios. These scenarios were meant to act as proxy for buoyancy, which determines the surface area exposed to hydrodynamic and wind drag. These estimates were expressed as percentages which were used to calculate hydrodynamic and wind drag for applicable simulation. For example, if 85% of the plant is submerged and 15% of above water, then the overall hydrodynamic and wind drag forces would be 85% and 15% of the total drag forces respectively. This approach has been used in past research investigating pelagic Sargassum rafts [@putman2020;@putman2018]. The exposure scenarios used in this study were 100%, 95%, 90%, and 85% for hydrodynamic drag; 0 %, 5%, 10%, and 15% for wind (see table 1). Each scenario consisted of a particle set with a size of 1000 where released from Kommetjie at the start of simulation. The particles sets were advected with a Runge-Kutte fourth order scheme for 30 days and incorporated brownian motion. Since the aim of this investigation was to investigate the relative surface behaviour of virtual kelp particles, only the surface layer was used for simulations. It should also be noted that the Copernicus model used places velocity vectors over some of the land covering the coastal domain. This was not considered a concern, as once again, the aim was to investigate surface drift behavior. The time period chosen to run the simulations was 01-01-2018 un 30-01-2018. This particular time period was chosen as the splitting of the Benguela Jet occurs in Janurary, which also conincides with a period of higher wind intensity, upwelling along the coast and mesoscale activity [@rubio2009; @veitch2018; @ragoasha2019]. 

```{r sim table, echo=FALSE, message=FALSE, warning=FALSE, fig.cap=" Details for each simulation run for the study. The table cosists of parameterisations for each scenario. The ID coloumn refers to the syntax used in the relevant OceanParcels script (see additional material for link to script). Type refers to either a passive particle with no drag behaviour or a kelp particle that has been advected with any drag exposure. The drag exposure column refers to the parameterisations regarding the level of water and wind drag simulated."}

set_flextable_defaults(fonts_ignore=TRUE)

sim_table <- read.csv("tables/chapter_3/simulation_table.csv", sep = ";")

sim_table <- flextable(data = sim_table)
sim_table <- theme_zebra(sim_table, odd_header = "transparent", even_header = "transparent")
sim_table <- set_header_labels(sim_table, Cross.sectional.area = "Cross-sectional area", Drag.Exposure = "Drag Exposure level")
sim_table <- align(x= sim_table, align = "center", part = "all")
sim_table <- set_table_properties(sim_table, width = 1, layout = "autofit")
sim_table <- set_caption(sim_table, "Table 1:Details for each simulation executed for the study.")
sim_table

```

To determine if vortices and eddies play a role in kelp accumulation on the surface, a separate set of simulations were performed. Unlike the previous simulations these simulation released a particle every hour. These were run over the same time period for 30 days with hourly outputs using a fourth order Runge-Kutte advection scheme and incorporated Brownian motion. In order to determine if the shape co-efficient used plays a role in model used, a simulation of a kelp with the maximum surface area and drag exposure was run using the shape coefficient for a cylinder to compare to a simulation using a sphere, and was run for 30 days using a fourth order Runge-Kutte advection scheme with brownian motion and a particle set of size 1000. 

## Model inputs
### Ocean and wind model

Both passive and kelp particles were simulated around the South African coastline within hind-cast outputs from the Copernicus Marine Environment Monitoring Service (Copernicus, http://marine.copernicus.com). The Copernicus model is based on the modelling framework known as Nucleus for European Modelling of the ocean. The Copernicus outputs used in this study contains 3D daily current information from the top layer to the bottom (Global Analysis Forecast PHY_001_024). The model is forcedhas a spatial resolution of 0.08$^\circ$ and is interpolated on an Arakawa C native grid. In order to incorporate the effects of direct wind drag within the simulations, the Copernicus Marine Environment Monitoring Service global wind product was used (Global Ocean Wind L4_NRT_012_004). The outputs from the model is composed of 6-hourly averaged fields of surface 10m wind velocity vectors with a spatial resolution of 0.25$^\circ$. Both averaged ocean current and wind data are stored as meridonal and zonal velocity vectors. 

### Hydrodynamic and wind drag

The drag coefficient for a spherical particle was used in the calculation of hydrodynamic drag as the trajectory model assumes the particles are spherical. The drag equation used was: $F_d = 0.5 \rho A_c C_d U^2$, where $\rho$ is the density of seawater or air, $A_c$ is the cross-sectional area exposed to hydrodynamic or wind drag, $C_d$ is the drag coefficient for a spherical particle and $U$ is the surface velocity vector of the flow-/wind- field. Hydrodynamic and wind drag components were calculated separately for both the meridonal and zonal velocity vectors, as per @furnans2008. Since drag force is dependent on the velocity vectors which vary with time, the meridonal and zonal velocities were interpolated and used in the drag force calculation for each time-step. The same approach was used for the wind drag force. The equation that was used to calculate hydrodynamic drag, was also used to calculate wind drag. 

### Cross-sectional area

To incorporate hydrodynamic and wind drag, the cross-sectional area of the kelp was calculated first. Known geometric shapes reflecting the relevant plant sections were used to estimate the surface area for various parts of the plant. For details please refer to figure 2. The dimensional data needed were estimated in cases where data was not available for that particular morphological characteristic. The bulb/pneumatocyst is a highly variable morphological characteristic and in some cases can appear absent; the same is true for the holdfast. Therefore, a standard cross-sectional area was used for both the bulb and holdfast, for all simulations. 

```{r message=FALSE, warning=FALSE, include=TRUE, echo=FALSE, fig.height=4, fig.width=7, fig.cap="Figure 2: Diagram of the *E.maxima* morphological characteristics considered in this study, along with the associated geometric shapes used to calculate the overall surface area of each morphological characteristic."}

kelp_shape_figure <- rasterGrob(as.raster(readPNG("figures/chapter_3/chp3_shapedrawing.png")))
ggarrange(kelp_shape_figure)

```

The cross-sectional area calculated was site specific and the dimensions needed were garnered from morphology data from a previous study [@coppin2020]. The minimum, mean and maximum were calculated for each morphological characteristic, which were used for calculating the overall minimum, mean and maximum cross-sectional areas needed to run the various simulations (see table 1). The trajectory of these 'types' of cross-sectional areas (minimum, mean and maximum overall cross-sectional area) were used to determine the influence of drag, both hydrodynamic and wind, on overall trajectory. 

```{r morphology wrangling, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
# Investigate morphology data to assist in estimating surface area

# Read in morphology data
eck_df <- read.csv("data/morph_data/eck_morph_data.csv", sep = ";") %>%
  filter(site!= "Rocky Bank") %>%   # Not using Rocky Bank in this study
  filter(site!= "De Hoop") 
eck_df$site <- as.character(eck_df$site)
eck_df <- eck_df %>% 
  filter(population == "Deep") 
eck_long_df <- gather(eck_df, Morphology, measurement, frond_mass:total_length, factor_key=TRUE)
# Summary stats to make it easier to refer to later, these will not be used any analysis.
site_list <- c("Kommetjie")
eck_stats <- eck_long_df %>% 
  group_by(site, Morphology) %>% 
  summarise(mean = mean(measurement, na.rm = T),
            minimum = min(measurement, na.rm = T),
            maximum = max(measurement, na.rm = T)) %>% 
  ungroup() %>% 
  filter(site %in% site_list) %>% 
  rename(Site = site) %>% 
  rename(Mean = mean) %>% 
  rename(Minimum = minimum) %>% 
  rename(Maximum = maximum)

#eck_stats <- flextable(data = eck_stats)
#eck_stats <- theme_zebra(eck_stats, odd_header = "transparent", even_header = "transparent")
#eck_stats <- align(x= eck_stats, align = "center", part = "all")
#eck_stats <- set_table_properties(eck_stats, width = 1, layout = "autofit")

```

```{r morphology table, message=FALSE, warning=FALSE, include=TRUE, echo=FALSE, fig.cap=" Table summarising the atrributes and estimates used to calculate the overall surface area of Kommetjie kelp individuals used in the various simulation. Approximate shape refers to the dimensions of the geometric shape used to represent a particular morpholgical characteristic. Equations used are the equations relating to the dimensions used for the geometric shape estimate. Plant dimensions are the measurements used, collected in previous work by @coppin2020, used to calculate the associated surface areas. The total surface areas for each plant characteristic for each surface area type make up the remaining columns."}

set_flextable_defaults(fonts_ignore=TRUE)

area_table <- read.csv("tables/chapter_3/area_table.csv", sep = ";")
area_table <- flextable(data = area_table)
area_table <- theme_zebra(area_table, odd_header = "transparent", even_header = "transparent")
area_table <- align(x= area_table, align = "center", part = "all")
area_table <- set_header_labels(area_table, Plant.characteristic = "Plant characteristic", Approximate.shape = "Approximate shape", Equation.used = "Equation Used", Plant.dimensions = "Plant dimensions")
area_table <- set_header_labels(area_table, Ac.Minimum = "Ac Minimum", Ac.Mean = "Ac Mean", Ac.Maximum = "Ac Maximum")
area_table <- set_table_properties(area_table, width = 1, layout = "autofit")
area_table <- set_caption(area_table, "Table 2:Summary of the atrributes and estimates used to calculate the overall surface area of Kommetjie kelp individuals used in the various simulation.")
area_table
```
## Analysis

In order to compare trajectories between cross-sectional area types and wind exposure scenarios, mean trajectories were calculated and density distribution maps were produced. Density distribution maps are an effective method for assessing pathways and ocean connectivity [@vanSebille2018]. In addition, mean trajectory was calculated and included in the density distribution maps to further aid in comparing simulation outputs. The distance that particles traveled was also measured and used to produce boxplots. Distance traveled from the release site can help reveal topographic steering and momentum energy transfer from the wind field to kelp particle [@VanSebille2018]. If the wind direction is in the same direction as the current the virtual particles will cover larger distances due to an increase in the velocity as a result of momentum energy transfer [@putman2020; @putman2018; @vanSebille2018]. 

# Results

```{r data wrangling, message=FALSE, warning=FALSE, include=FALSE}

# Read in simulation data and data wrangling

p_RK4 <- tidync("OceanParcels/trajectory_data/RK4_PFloat.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00")) 
p_RK4_mean <- p_RK4 %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

p_RK4$type <- "RK4" # add extra column 'type' to dataframe and assigned 'RK4' label

Min_Kfloat_H100_W00 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H100_W00_mean <- Min_Kfloat_H100_W00 %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H100_W00$type <- "Min_Kfloat_H100_W00" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H100_W00$velocity <- with(Min_Kfloat_H100_W00, sqrt(kelpvelU^2 + kelpvelV^2))

Min_Kfloat_H095_W05 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H095_W05.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H095_W05_mean <- Min_Kfloat_H095_W05 %>% # calculate mean trajectory
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H095_W05$type <- "Min_Kfloat_H095_W05" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H095_W05$velocity <- with(Min_Kfloat_H095_W05, sqrt(kelpvelU^2 + kelpvelV^2))

Min_Kfloat_H090_W10 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H090_W10.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H090_W10_mean <- Min_Kfloat_H090_W10 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H090_W10$type <- "Min_Kfloat_H090_W10" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H090_W10$velocity <- with(Min_Kfloat_H090_W10, sqrt(kelpvelU^2 + kelpvelV^2))

Min_Kfloat_H085_W15 <- tidync("OceanParcels/trajectory_data/Min_KFloat_H085_W15.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Min_Kfloat_H085_W15_mean <- Min_Kfloat_H085_W15 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Min_Kfloat_H085_W15$type <- "Min_Kfloat_H085_W15" # add extra column 'type' to dataframe and assigned 'kelp' label
Min_Kfloat_H085_W15$velocity <- with(Min_Kfloat_H085_W15, sqrt(kelpvelU^2 + kelpvelV^2))

Mean_Kfloat_H100_W00 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_Kfloat_H100_W00_mean <- Mean_Kfloat_H100_W00 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_Kfloat_H100_W00$type <- "Mean_Kfloat_H100_W00" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_Kfloat_H100_W00$velocity <- with(Mean_Kfloat_H100_W00, sqrt(kelpvelU^2 + kelpvelV^2))

Mean_KFloat_H095_W05 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H095_W05.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H095_W05_mean <- Mean_KFloat_H095_W05 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H095_W05$type <- "Mean_KFloat_H095_W05" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H095_W05$velocity <- with(Mean_KFloat_H095_W05, sqrt(kelpvelU^2 + kelpvelV^2))

Mean_KFloat_H090_W10 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H090_W10.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H090_W10_mean <- Mean_KFloat_H090_W10 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Mean_KFloat_H090_W10$type <- "Mean_KFloat_H090_W10" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H090_W10$velocity <- with(Mean_KFloat_H090_W10, sqrt(kelpvelU^2 + kelpvelV^2))

Mean_KFloat_H085_W15 <- tidync("OceanParcels/trajectory_data/Mean_KFloat_H085_W15.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Mean_KFloat_H085_W15_mean <- Mean_KFloat_H085_W15 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE)) 

Mean_KFloat_H085_W15$type <- "Mean_KFloat_H085_W15" # add extra column 'type' to dataframe and assigned 'kelp' label
Mean_KFloat_H085_W15$velocity <- with(Mean_KFloat_H085_W15, sqrt(kelpvelU^2 + kelpvelV^2))

Max_Kfloat_H100_W00 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H100_W00_mean <- Max_Kfloat_H100_W00 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H100_W00$type <- "Max_KFloat_H100_W00" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H100_W00$velocity <- with(Max_Kfloat_H100_W00, sqrt(kelpvelU^2 + kelpvelV^2))

Max_Kfloat_H095_W05 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H095_W05.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H095_W05_mean <- Max_Kfloat_H095_W05 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H095_W05$type <- "Max_KFloat_H095_W05" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H095_W05$velocity <- with(Max_Kfloat_H095_W05, sqrt(kelpvelU^2 + kelpvelV^2))

Max_Kfloat_H090_W10 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H090_W10.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H090_W10_mean <- Max_Kfloat_H090_W10 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H090_W10$type <- "Max_KFloat_H090_W10" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H090_W10$velocity <- with(Max_Kfloat_H090_W10, sqrt(kelpvelU^2 + kelpvelV^2))

Max_Kfloat_H085_W15 <- tidync("OceanParcels/trajectory_data/Max_KFloat_H085_W15.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
Max_Kfloat_H085_W15_mean <- Max_Kfloat_H085_W15 %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

Max_Kfloat_H085_W15$type <- "Max_KFloat_H085_W15" # add extra column 'type' to dataframe and assigned 'kelp' label
Max_Kfloat_H085_W15$velocity <- with(Max_Kfloat_H085_W15, sqrt(kelpvelU^2 + kelpvelV^2))

total_data <- rbind(Min_Kfloat_H100_W00 , Min_Kfloat_H095_W05, Min_Kfloat_H090_W10, Min_Kfloat_H085_W15, Mean_Kfloat_H100_W00, Mean_KFloat_H095_W05, Mean_KFloat_H090_W10, Mean_KFloat_H085_W15, Max_Kfloat_H100_W00, Max_Kfloat_H095_W05, Max_Kfloat_H090_W10, Max_Kfloat_H085_W15)

```

## Trajectory comparison

The mean trajectories of the different cross-sectional areas are similar to the mean trajectory of the passive particles (Figure 2A). When comparing mean trajectories between the different cross-sectional areas for the 100% hydrodynamic drag simulations, no differences can be seen; rather, there is only a slight variation. The results from the simulations including different hydrodynamic and wind drag exposures and cross-sectional area types show differences in mean trajectory when compared to the passive simulation (Figure 2B). The end points of the simulations including hydrodynamic and wind drag were different compared to the passive simulations, as well the final location of the kelp particles being further from the release site. When comparing the different hydrodynamic and wind drag simulations to each other, only slight variation in mean trajectories was evident. In all simulations particles flowed in a north-westward direction. 

```{r meantraj, message=FALSE, warning=FALSE, include=FALSE, echo = FALSE}

load("map/south_africa_coast_hi_res.Rdata")

waterdrag_plot <- ggplot()+
  #geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black", fill = NA) +
  geom_path(data = p_RK4_mean, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = Mean_Kfloat_H100_W00_mean, aes(x = lon, y = lat), color = 'blue')+
  geom_point(data = Mean_Kfloat_H100_W00_mean, aes(x = lon, y = lat), shape = 20)+
  geom_path(data = Mean_Kfloat_H100_W00_mean, aes(x = lon, y = lat), color = 'orange')+
  geom_path(data = Max_Kfloat_H100_W00_mean, aes(x = lon, y = lat), color = 'red')+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

wwdrag_plot <- ggplot()+
  #geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 1.0, colour = "black", fill = NA) +
  geom_path(data = p_RK4_mean, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = Min_Kfloat_H095_W05_mean, aes(x = lon, y = lat), color = 'grey')+
  geom_path(data = Min_Kfloat_H090_W10_mean, aes(x = lon, y = lat), color = 'green')+
  geom_path(data = Min_Kfloat_H085_W15_mean, aes(x = lon, y = lat), color = 'pink')+
  geom_path(data = Mean_KFloat_H095_W05_mean, aes(x = lon, y = lat), color = 'yellow')+
  geom_path(data = Mean_KFloat_H090_W10_mean, aes(x = lon, y = lat), color = 'orange')+
  geom_path(data = Mean_KFloat_H085_W15_mean, aes(x = lon, y = lat), color = 'red')+
  geom_path(data = Max_Kfloat_H095_W05_mean, aes(x = lon, y = lat), color = 'blue')+
  geom_path(data = Max_Kfloat_H090_W10_mean, aes(x = lon, y = lat), color = 'orange')+
  geom_path(data = Max_Kfloat_H085_W15_mean, aes(x = lon, y = lat), color = 'red')+
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() 

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height=4, fig.width=7, fig.cap="Figure 2: Comparison of mean trajectories. Plot A is the comparison of mean trajectories for only hydrodynamic drag and plot B is the comparison of mean trajectories for simulations with varying degrees of hydrodynamic and wind drag. In plot A, the black line represents simulation 1, the blue line 2, the orange line 6 and the red line 10. In plot B, the black line represents simulation 1, the grey line simulation 3, the green 4, the pink 5, the yellow 7, orange 8, red 9, blue 11, bronze 12, and cherry 13. The reader is referred to tables 1 and 2 for details pertaining to each scenario."}
ggarrange(waterdrag_plot, wwdrag_plot, labels = "AUTO")
```

## Comparison of density distributions

Across all simulations particles flowed in a north-westward direction (Figure 3). The density plots for simulations that considered any form of drag showed a higher density of particles along the mean trajectory path compared to the passive simulation which has an almost even density of particles across grids (Figure 3A, 3E, 3I). In addition the density plots show that the particles in simulations that considered any form of drag got entrained in a vorticity while particles in the passive simulation deflected away (Figure 3). Comparison of cross-sectional areas and different drag exposure scenarios show no differences in mean trajectory and spatial patterns in density, with only slight variations across types. 

```{r density plots, message=FALSE, warning=FALSE, echo=FALSE}

## Heatmaps of study domain, use previous data for study site map and histograms
## Coastline of Southern Africa

load("map/south_africa_coast_hi_res.Rdata")

heatmap_RK4 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = p_RK4, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = p_RK4_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H100_W00 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H100_W00, bins = 80, aes(x = lon, y = lat)) +  
  scale_fill_continuous(type = "gradient",limits = c(1, 13000)) +
  geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H100W100") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H095_W05 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H095_W05, bins = 80, aes(x = lon, y = lat)) +  
  scale_fill_continuous(type = "gradient",limits = c(1, 13000)) +
  geom_path(data = Min_Kfloat_H095_W05_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  #ggtitle("H095W05") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H090_W10, bins = 80, aes(x = lon, y = lat)) +  
  scale_fill_continuous(type = "gradient",limits = c(1, 13000)) +
  geom_path(data = Min_Kfloat_H090_W10_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H090W10") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Min_Kfloat_H085_W15 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Min_Kfloat_H085_W15, bins = 80, aes(x = lon, y = lat)) +  
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Min_Kfloat_H085_W15_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  #ggtitle("H085W15") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_Kfloat_H100_W00 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_Kfloat_H100_W00, bins = 80, aes(x = lon, y = lat)) +  
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Mean_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H095_W05 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app1, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H095_W05, bins = 80, aes(x = lon, y = lat)) +  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Mean_KFloat_H095_W05_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H090_W10, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Mean_KFloat_H090_W10_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Mean_KFloat_H085_W15 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Mean_KFloat_H085_W15, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Mean_KFloat_H085_W15_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H100_W00 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H100_W00, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Max_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H095_W05 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H095_W05, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Max_Kfloat_H095_W05_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H090_W10 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H090_W10, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Max_Kfloat_H090_W10_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


heatmap_Max_KFloat_H085_W15 <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = Max_Kfloat_H085_W15, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = Max_Kfloat_H085_W15_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 3: Comparison of density plots at the end run time for scenarios 1 - 13, for January 2018 (summer). The plots are regular hexagons within the density of particles is calculated. The mean trajectories for each scenario are also plotted for comparison. The reader is referred to tables 1 and 2 for details pertaining to each scenario.', fig.height=10.2, fig.width=7.5}

figure_a <- ggarrange(heatmap_Min_Kfloat_H100_W00, heatmap_Min_Kfloat_H095_W05,heatmap_Min_Kfloat_H090_W10,heatmap_Min_Kfloat_H085_W15, heatmap_Mean_Kfloat_H100_W00, heatmap_Mean_KFloat_H095_W05, heatmap_Mean_KFloat_H090_W10, heatmap_Mean_KFloat_H085_W15, heatmap_Max_KFloat_H100_W00,heatmap_Max_KFloat_H095_W05, heatmap_Max_KFloat_H090_W10, heatmap_Max_KFloat_H085_W15, labels = c("2","3","4","5","6","7","8","9","10","11","12","13"), common.legend = TRUE, legend = c("none"), font.label = list(size = 11, face = "bold"))

figure_b <- ggarrange(heatmap_RK4, legend = c("right"), labels = c("1"), font.label = list(size = 11, face = "bold"))

ggarrange(figure_b, figure_a, ncol = 1, nrow = 2)

```

## Comparison of distances 

There were significant differences among the median distances travelled for all particles in each simulation (Figure 4; p < 0.05). The simulations that considered for 100% hydrodynamic drag travelled a shorter distance than particles for simulations which considered a combination of hydrodynamic and wind drag scenarios. Comparison between simulations that considered hydrodynamic and wind drag show no significant differences with only slight variations among simulations. 

```{r distance plot processing, message=FALSE, warning=FALSE, include=FALSE, fig.height=3, fig.width=4}

pos <- c("RK4",
         "Min_Kfloat_H100_W00",
         "Min_Kfloat_H095_W05",
         "Min_Kfloat_H090_W10",
         "Min_Kfloat_H085_W15",
         "Mean_Kfloat_H100_W00",
         "Mean_Kfloat_H095_W05",
         "Mean_Kfloat_H090_W10",
         "Mean_Kfloat_H085_W15",
         "Max_Kfloat_H100_W00",
         "Max_Kfloat_H095_W05",
         "Max_Kfloat_H090_W10",
         "Max_Kfloat_H085_W15")

dis_plot <- ggplot(data = total_data, aes(x = type, y = distance, show.legend = FALSE))+
  geom_boxplot(data = p_RK4, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Scenario")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

custom_labs <- c("1","2", "3", "4", "5", "7", "8", "9", "10", "11", "12", "13") #create custom labels and add them to dis_plot

dis_plot <- dis_plot +
  scale_x_discrete(labels= custom_labs)
  

```

```{r distance plot, message=FALSE, warning=FALSE, echo = FALSE, fig.cap="Figure 4: Boxplots of total distance travelled by all particles from the release site over the course of the simulation for scenarios 1 - 13, for January 2018 (summer). The x-axis represents the scenario number and the y-axis is the distance travelled in kilometers. The lower and upper hinges correspond to the first and third quartiles. The whiskers represent the range, solid black lines represent the median and black dots are outliers. The reader is referred to tables 1 and 2 for details pertaining to each scenario."}
dis_plot
```

## Accumulation

```{r message=FALSE, echo=FALSE, warning=FALSE}

kelp_acc <- tidync("OceanParcels/trajectory_data/chap3_kelpsim_acc.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
kelp_acc_mean <- kelp_acc %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

kelp_acc$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label
kelp_acc_mean$type <- "Kelp" # add extra column 'type' to dataframe and assigned 'kelp' label

pass_acc <- tidync("OceanParcels/trajectory_data/chap3_passivesim_acc.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, age) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
pass_acc_mean <- pass_acc %>% #calculate mean trajectory
  group_by(t) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

pass_acc$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label
pass_acc_mean$type <- "Passive" # add extra column 'type' to dataframe and assigned 'kelp' label

total_acc_data <- rbind(pass_acc, kelp_acc)
total_acc_mean <- rbind(pass_acc_mean, kelp_acc_mean)

mean_traj_acc <- ggplot() +
  geom_path(data = total_acc_mean, aes(x = lon, y = lat, colour = type)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw()

## Coastline of Southern Africa
load("map/south_africa_coast_hi_res.Rdata")

heatmap_RK4_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = pass_acc, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = pass_acc_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Passive particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_kelp_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = p_RK4, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = kelp_acc, bins = 80, aes(x = lon, y = lat), legend = FALSE) +  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = kelp_acc_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("Kelp particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_RK4_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = pass_acc, aes(x = lon, y = lat, colour = distance)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


point_kelp_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = kelp_acc, aes(x = lon, y = lat, colour = age)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  guides(fill=guide_legend(title="Age")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

point_kelp_acc <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  geom_point(data = kelp_acc, aes(x = lon, y = lat, colour = age)) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) +
  xlab("Longtitude") +
  ylab("Latitude") +
  ggtitle("") +
  #scale_color_viridis_c(name = "Age") +
  guides(fill=guide_legend(title="Age")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


dis_plot_acc <- ggplot(data = total_acc_data, aes(x = type, y = distance, show.legend = FALSE)) +
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = "right") +
  theme_bw() +
  ylab("Distance (km)") +
  xlab("Scenario") +
  #coord_flip() +
  theme_bw()
  #theme(plot.title = element_text(hjust = 1))


```

```{r accumulation data outputs, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 5: Comparison of trajectory data between passive and kelp accumulation scenarios. Panel A are a comparison of density plots  and panel B is a comparison of age.", fig.height=8, fig.width=8}

plot_A <- ggarrange(heatmap_RK4_acc, heatmap_kelp_acc, common.legend = TRUE, legend = c("bottom"), ncol = 2, nrow = 1)
plot_B <- ggarrange(point_RK4_acc, point_kelp_acc, common.legend = TRUE, legend = c("bottom"), ncol = 2, nrow = 1)

ggarrange(plot_A, plot_B, labels = c("AUTO"), ncol = 1, nrow = 2)

```

The role of eddies that exist within the study domain over the time period play a clear role in the accumulation and dispersal of kelp particles. Passive particles tend to remain on the outer edge of the eddy and then are expelled on the other side and continue to follow the ocean current (see Figure 5A). The opposite is true for kelp particles which have the highest exposure level of hydrodynamic and wind drag. The kelp particles are entrained in the eddy (see Figure 5A). This is also reflected when comparing the age of particles at the end of the simulation. In Figure 5B, younger particles are near the release site and older particles further away from shore, while older kelp particles are retained in the eddy. 

## Comparison of coefficents

The comparison of mean trajectories between the sphere and cylindrical shape coefficients revealed no difference (Figure 6A). This was also reflected when comparing distance travelled by particles and particle density plots (Figure 6B). The simulation which used a cylindrical shape coefficient showed higher density in an eddy compared to the simulation which used a sphere for the shape coefficient (Figure 6C-D). 

```{r shape data, message=FALSE, echo=FALSE, warning=FALSE}

sphere <- tidync("OceanParcels/trajectory_data/Max_KFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
sphere_mean <- sphere %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

sphere$type <- "Sphere" # add extra column 'type' to dataframe and assigned 'kelp' label
sphere_mean$type <- "Sphere" # add extra column 'type' to dataframe and assigned 'kelp' label

# read in data again for one max simulation, as cannot sort issue out with rename df...
cyl <- tidync("OceanParcels/trajectory_data/Max_ShapeFloat_H100_W00.nc") %>%
  hyper_tibble() %>%
  dplyr::select(trajectory, lon, lat, time, distance, kelpvelU, kelpvelV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))
cyl_mean <- cyl %>% #calculate mean trajectory 
  group_by(t) %>% 
  summarise(across(lon:lat, mean, na.rm= TRUE))

cyl$type <- "Cylinder" # add extra column 'type' to dataframe and assigned 'kelp' label
cyl_mean$type <- "Cylinder" # add extra column 'type' to dataframe and assigned 'kelp' label


# Make mean trajectory plot
shape_plot <- ggplot()+
  geom_path(data = p_RK4_mean, aes(x = lon, y = lat), color = 'black')+
  geom_path(data = sphere_mean, aes(x = lon, y = lat), color = 'blue')+
  geom_path(data = cyl_mean, aes(x = lon, y = lat), color = 'orange')+
  xlab("Longtitude") + 
  ylab("Latitude") +
  ggtitle("Mean trajectory comparison") +
  #guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

# make density map
heatmap_sphere <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = sphere, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = sphere_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  guides(fill=guide_legend(title="Number of particles")) +
  ggtitle("Cylinder") + 
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

heatmap_cyl <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 1.0, colour = "black", fill = NA) +
  #geom_bin2d(data = k_app2, bins = 80, aes(x = lon, y = lat)) +
  geom_hex(data = cyl, bins = 80, aes(x = lon, y = lat)) +
  scale_fill_continuous(type = "gradient", limits = c(1, 13000)) +
  geom_path(data = cyl_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  xlab("Longtitude") + 
  ylab("Latitude") + 
  ggtitle("Sphere") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

shape_data_total <- rbind(sphere, cyl)

shape_dis_plot <- ggplot(data = shape_data_total, aes(x = type, y = distance, show.legend = FALSE))+
  geom_boxplot(notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(limits = pos)+
  stat_compare_means(method = "kruskal.test", label = "p.signif")+
  ylab("Distance (km)")+
  xlab("Type") + 
  ggtitle("Comparison of distance travelled") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r shape data outputs, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 6: Comparison of trajectory data between a kelp sphere and kelp cylinder. Plot A is the comparison of mean trajectories, plot B is the comparison of total distance travelled by all particles, and plot C and D are the density plots for simulations using a sphere and cylinderical shape coefficient. The reader is referred to tables 1 and 2 for details pertaining to each scenario.", fig.height=8, fig.width=8}

ggarrange(shape_plot, shape_dis_plot, heatmap_sphere, heatmap_cyl, labels = c("AUTO"), common.legend = TRUE, legend = c("bottom"), ncol = 2, nrow = 2)

```


# Discussion

The treatment of drifting macroalgae as purely Lagrangian will not be able to accurately determine patterns of passive dispersal, such as entrainment in eddies or vortices [@fossette2012; @miron2020]. Although past research has shown the inclusion of inertia and windage greatly increase observed macroalgae trajectory and entrainment characteristics [@putman2018; @brooks2018;@brooks2019; @putman2020], past research has focused on large macroalgal-rafts which can vary greatly in size and surface area. None of the past research has taken advantage of the advancement in numerical ocean models and Lagrangian trajectory modeling to investigate how aspects of drag (hydrodynamic and wind) affect the trajectory patterns of solitary drifting macroalgae. This study compared particles trajectories with simulations that included no forms of drag with simulations that included various forms of both hydrodynamic and wind drag. The mean virtual kelp trajectory deviated from the mean passive  trajectory when including varying levels of hydrodynamic and wind drag scenarios. The results from this study show the inclusion of hydrodynamic and wind drag results in observable entrainment patterns, and broadens our understanding of how surface area plays a role in solitary drifting macroalgae trajectory, in this case that of *E. maxima*.

Past research has inferred from direct and indirect techniques that drifting macroalgae tend to follow the prevailing surface currents [@thiel2005; @hobday2000; @fraser2011; @rothausler2011; @rothausler2011]. The results from this numerical experiment confirm that drifting macroalgae do follow the surface current in the study region when considering only hydrodynamic drag. In addition, not only are the trajectories similar but so are the end points at the end of simulation. However, when *ad-hoc* wind drag (windage) is considered in combination with hydrodynamic drag the end locations differ greatly when compared to purely Lagrangian particle trajectories. The inclusion of wind drag causes the kelp particles to flow further away from the coast and with a greater distance travelled from the release location. The difference in trajectory and distance covered can be attributed to the inclusion of wind drag. Wind drag adds to the effects of hydrodynamic drag when the wind direction and current direction are opposite to each other. However, when the wind direction is in the same or similar direction to that of the current, momentum energy from the wind is transferred to the object [@hackett2006; @putman2020]. This causes the kelp particles to travel further as well as exposed to different time varying flows. Past studies have shown this when including windage as a function of inertia [@putman2018;@brooks2019; @putman2020]. A study by @putman2020 used *ad-hoc* windage factors that was based on the surface current velocity to assess the approach for improving transport predictions of pelagic *Sargassum sp*. The results showed that including ad-hoc windage factors improved virtual trajectories compared to tracked *Sargassum sp* mats which was partly due to the inclusion of momemtum energy transfer from wind. This is also reflected in the analysis comparing distances travelled by all the particles in each simulation. The particles in the simulations that included wind drag traveled significantly greater distances compared to the passive or hydrodynamic only drag. 

The addition of drag forces causes the kelp particles to cluster together along the mean trajectory compared to that of the passive particles which are more evenly dispersed. This is most likely due to the shared drag characteristics among the kelp particles which included the plants weight and surface area into the calculation. Other studies investigating flotsam trajectory characteristics have found similar results [@breivik2011; @olascoaga2020; @miron2020]. A study by @miron2020 conducted field experiments using a range of objects such as spheres, cubes, and cuboids to compare to investigate the effect of inertia on particles dynamics. The results from the study showed that objects tended to cluster according to the shape of the object which the authors attributed to shared characteristics of inertia. Although drag forces and not inertia were used in this study, the same conclusion applies; drag is therefore an important characteristic to consider when investigating or predicting solitary drifting macroalgae trajectory. 

The ocean is comprised of time-varying flows and changes in an objects velocity that can cause the object to be exposed to different flow patterns over time. The lack of dissimilarity in trajectory between different cross-sectional area types (minimum, mean and maximum) suggests that reduction in velocity in relation to cross-sectional area is negligible. A similar result was found by @gouvello2020 who investigated the effects of swimming behavior on sea turtle hatchling dispersal in the Agulhas region. The results suggested that the hatchling trajectories are mostly influenced by the ocean currents in the first year of hatching due to  as juveniles do are not swim fast enough to alter thier overall trajectory. Therefore, the differences in cross-sectional area types may not be significant enough to have an effect on the relevant zonal and meridonal velocity vectors. Another possible reason is the resolution of the ocean model used. The resolution of the underlying ocean model is an important aspect of Lagrangian ocean modeling and must be able to resolve sub-grid scale ocean processes for finer scale applications. A study by @hart2018 assessed the inclusion of stochastic motion, wind and currents into forecasting for search and rescue using the same model ocean model used in this study. The authors found that the inclusion of Brownian motion greatly increased the accuracy in representing sub-grid scale processes and that the inclusion of wind, currents and stochastic motion greatly improved forecasting applications. Therefore, the authors argue that the lack of dissimilarity between simulations of different cross-sectional area and drag exposure scenarios is not as a result of the resolution of the model. 

The same is also true when comparing different hydrodynamic and wind drag exposure scenarios. These scenarios reflect different buoyancy situations which result in different amounts of surface area exposed to hydrodynamic and/or wind drag. The similarities between the different combined drag scenarios suggest that higher magnitudes of wind exposure do not significantly alter trajectories. Instead, the results from this study suggest that the inclusion of drag forces in simulating macroalgal trajectory may result in improving accuracy of entrainment patterns. All the simulations that included any form of drag resulted in a  high density of particles entrained in a eddy. The entrainment and expulsion from eddies and vorticities are an important characteristic of floating macroalgae. Accuracy in predicting entrainment and expulsion of macroalgae-rafts from eddies has been investigated previously by @putman2018 and @putman2020, who show that including windage greatly improves entrainment patterns when comparing virtual and real Sargassum rafts. However, these studies investigated large rafts and not floating individuals. Inertia is based on the size/mass of the raft, while hydrodynamic and wind drag are based on current velocity and surface area. Therefore, the role of inertia may be negligible for a solitary individual and rather other forms of drag, such as in this study, should be considered. The results from this study suggest that the inclusion of hydrodynamic and/or wind drag is an important component when simulating virtual kelp particles, and will greatly increase the accuracy of entrainment and expulsion from sub-grid mesoscale oceanographic features, such as eddies and vortices.

The role of eddies and vortices in the entrainment of kelp is further supported by the accumulation simulations. These results cleary show that the inclusion of drag greatly increases the number of particles entrained in the eddy within the study domain. Eddies and vortices may act as accumulation zones for kelp where the formation of rafts may occur, or the kelp is entrained for long enough to eventually sink in area below the eddy. In a study by @woodborne1989 references a site offshore approximately 120km from Cape Columbine where dredged kelp was found. The area referenced by @woodborne1989 coincides with the area where virtual kelp are entrained by a vorticy. The use of a cylindrical shape coefficient instead of a sphere in the calculation of drag force also had no effect on the mean trajectory. Instead, the inclusion of a different shape coefficient increased to the density of particles entrained in an eddy field. Therefore, more accurately parameterizing shape will therefore allow for further improvements in models of macroalgal dispersal patterns. 

# Conclusion

Most of the past research has focused on large macroalgae rafts which can vary greatly in size and shape; however, no research exists to clarify the drifting characteristics of solitary macroalgae. Understanding how to accurately model the distribution of solitary kelp can lead to be understanding of accumulation zones and sinks and ultimately the ecological links pertaining to those processes. The findings from this study indicate that solitary floating virtual *E. maxima* particles tend to follow the prevailing surface currents and the inclusion of wind causes the trajectories to differ greatly from that of a purely Lagrangian particle. Furthermore, the inclusion of both hydrodynamic and wind drag cause clustering of particles along the trajectory as well causing particles to become entrained in eddies. Different cross-sectional areas exposed to hydrodynamic and wind drag had no effect on overall trajectory suggesting that those differences are negligible when investigating dispersal patterns of drifting *E.maxima*. In addition, the use of a cylindrical shape coefficient has no effect on mean trajectory, but it does cause higher density of particles to become entrained in an eddy. Overall, the inclusion of drag forces is an important aspect to consider when investigating the dispersal patterns of solitary macroalgae, while differences in cross-sectional areas are not. This study also provides an approach which can be adapted to model any floating solitary macroalgae, provided the surface area can be estimated accurately. Gaps in the research exist when considering what oceanographic processes play a role in solitary macroalgal dispersal as well as how these vary seasonally. The identification of biological and physical factors that play a role in accumulation zones is also needed, as well as better estimates for sinking rates and raft-times. 

# References


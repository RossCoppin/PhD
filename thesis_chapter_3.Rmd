---
title: 'Numerical experiment investigating the influence of drag on trajectory patterns of floating macroalgae'
author: "R Coppin^[Department of Biodiversity and Conservation Biology, University of the Western Cape, Private Bag X17, Bellville 7535, South Africa], C Rautenbach^[National Institute of Water and Atmospheric Research, Hamilton: Gate 10 Silverdale Road Hillcrest, 3216], AJ Smit^[Department of Biodiversity and Conservation Biology, University of the Western Cape, Private Bag X17, Bellville 7535, South Africa, South African Environmental Observation Network, Elwandle Coastal Node, Port Elizabeth, South Africa]"
output:
  pdf_document:
    latex_engine: xelatex 
    toc: no
  html_document:
  word_document:
    reference_docx: markdown/frontiers_template.docx
bibliography: references.bib
csl: markdown/elsevier-harvard2.csl
abstract: "Ocean currents act as an important dispersal mechanism of natural and anthropogenic material on the ocean surface. Macroalgae are one of the most important natural dispersal vectors of marine organisms and are regarded as the ‘tumble-weed of the ocean.’ Despite many studies on the topic, the relative role of wind and surface currents in influencing the trajectory of macroalgal dispersal is still uncertain. Past studies focused on kelp-rafts, which can vary greatly in size, making it difficult to form a consensus as to the relative role of wind versus surface currents. In addition, these studies have not considered surface-area in relation to drag characteristics of the macroalgae, both of which have been shown to play a role in the trajectory and accumulation of flotsam. Advances in Lagrangian trajectory modeling have been rapid in recent years and allow the use of numerical experiments to investigate trajectories of flotsam in the ocean. This study aimed to shed light on the relative role of wind versus surface currents, and the role of drag in macroalgal trajectory and accumulation. We focused on solitary kelp plants. This was achieved by comparing simulations of virtual kelp ‘particles’ which incorporate drag with that of purely Lagrangian particles (no drag). Geometric representations for each morphological characteristic was used to calculate the overall surface area used in the calculation of the relevant drag components (hydrodynamic and wind) for each scenario (submerged and partially submerged) and flow-field combinations (currents only, currents with wind, currents with Stokes drift, currents with wind and Stokes drift). The results showed that the virtual kelp particles do follow the ocean currents in general, but that the inclusion of drag into the scenarios causes accumulation in eddies within the study domain."
nocite:  |
  @Algaebase
  @Worms
header-includes:
  - \usepackage[left]{lineno}
  - \linenumbers
---

```{r software, message=FALSE, warning=FALSE, include=FALSE}
## Load software need for entire script

load("map/south_africa_coast_hi_res.Rdata")
load("map/sa_bathy.RData")

library(tidyverse)
library(flextable)
library(tidync)
library(ncdf4)
library(lubridate)
library(gridExtra)
library(ggpubr)
library(jpeg)
library(gridExtra)
library(grid)

```

# Introduction

Passive dispersal vectors of marine taxa include a range of natural and anthropogenic objects that float in the ocean, and kelp are regarded as one of the most important of these [@edgar1987;@norton1992;@bushing1994;@holmquist1994; @helmuth1994;@smith2002; @McCormick2008]. Floating macroalgae are regarded as important transport mechanisms for marine invertebrates which remain attached to the plant when dislodged from the substratum [@edgar1987;@norton1992;@bushing1994;@holmquist1994; @helmuth1994;@smith2002; @McCormick2008]. For example a study by @holmquist1994 investigated the long-distance dispersal of the bivalve *Gaimardia trapesina* Lamarck via drifting kelp. The authors used observational techniques to quantify kelp-rafts along with haphazard sampling of the kelp-rafts observed. Genetic samples were taken from the target species for each of the haphazardly sampled kelp-rafts for comparison amongst populations. The results suggest that kelp-rafting, along with the local wind patterns, most likely played a key role in the dispersal of  *G. trapesina* between genetically similar but spatially disconnected populations. Kelps ecological role in terms of organic subsidy is not limited to the local environment, and instead plays an important role in organic input into deep, offshore ecosystems [@bustamante1995; @colombini2003;@vanderklift2008;@Krumhansl2012; @filbee2018;@zuercher2019;@cartraud2021]. For example, a study by @filbee2018, investigated the allochthonous input of kelp detritus into deep fjords within northern Norway. The authors used a combination of video surveys, biomass estimates and tagging of detrital material to characterise kelp detritus within shallow, sub-tidal and deep fjord systems. The results showed that the organic subsidy into the different systems was linked to loss of biomass from kelp forests during times of high wave exposure. Furthermore, the results showed that kelp detritus is an important organic subsidy for distant ecosystems, suggesting resource coupling between nearshore kelp forests and offshore systems [@filbee2018]. The formation of kelp rafts also act as floating refuges for marine organisms as well as natural fish aggregation devices. Work by @witherington2012 showed the reliance of young sea turtles on drifting pelagic Sargassum rafts as a source of food and refuge from marine predators, and work by @kingsford1992 showed the reliance of some fish larvae (*Paralabrax clathratus* Girard, *Chromis punctipinnis* Cooper and Sebastes spp) on kelp-rafts for habitat complexity and transport to offshore areas. 

Some macroalgal species are negatively buoyant and sink to the seafloor when detached from the substrate, while other species have air-filled pneumatocysts or stipes which allow the plants to remain at the surface where light is more abundant, and in turn cause plants to float to the surface when detached. The structure and number of pneumatocysts vary among species. For example, species belonging to the genera Macrocystis, Sargassum, Ascophyllum, and Fucus have thalli with many small pneumatocysts, while other species such as *Nereocystis luetkeana* (K.Mertens) Postels & Ruprecht, *Pelagophycus porra* (Léman) Setchell, *Ecklonia radiata* (C.Agardh) J.Agardh, and *Ecklonia maxima* (Osbeck) Papenfuss have single, large pneumatocysts [@dayton1985; @smith2002;@thiel2005; @graiff2016; @batista2018]. In some cases, the stipe itself may be air-filled, such as with *E. maxima* and *E. radiata*. Although there have been reports of floating species of Chlorophyta and Rhodophyta, Phaeophyceae species are the most reported forms of floating algae. This is most likely because the green and red species reported to float are not actually positively buoyant, but instead are kept at the surface by gas trapped in-between or in their thalli [@dromgoole1982; @back2000]. The giant kelp *Macrocystis pyrifera* (Linnaeus) C.Agardh [@helmuth1994; @kingsford1995;@hobday2000;@macaya2005; @graiff2016;@batista2018], the bull kelp *Durvillaea antarctica* (Chamisso) Hariot [@smith2002; @collins2010; @wichmann2012; @tala2013; @tala2017; @saunders2014; @batista2018], and pelagic Sargassum species [@brooks2018; @brooks2019; @putman2018; @putman2020; @wang2019] have been the focus of much of the research regarding spatial and temporal dispersal patterns, the ecological role of rafting, marine connectivity and raft-time.

Past research points to macroalgal trajectories being largely determined by  a combination of prevailing wind conditions and surface currents [@hobday2000; @thiel2005; @rothausler2011;@fraser2011]. Although ocean currents are regarded as the primary influence, the relative importance of wind versus surface current is still unknown, although the role of wind has been recognized as important in several studies. For example, a study by @harrold1989 investigated the seasonal trajectories of radio-transmitter tagged *M. pyrifera* in nearshore Monterey Bay. The results showed that kelp rafts, with little surface area exposed to the wind, were largely driven by a combination of wind and surface currents; however, the relative importance of wind was not clear. This work also showed that the trajectories of tagged kelp were congruent with the formation of eddies during winter. Other studies have used genetic approaches to determine macroalgal raft trajectory characteristics by inferring source location from genetically similar populations. For example a study by @nikula2013 used genetic markers (mtDNA and AFLP) of invertebrate species to show that in the sub-Antarctic latitudes the West Wind Drift causes continuous unidirectional surface flow and is regarded as an important mechanism for dispersal of floating bull kelp *D. antarctica*. Another study by @fraser2011 on the rafting capabilities of *D. antarctica* used a combination of population genetics and relative age estimate of goose barnacles attached to kelp-rafts. The presence of goose barnacles suggests a long rafting time as these species have a slow growth rate. Genetic analyses showed these species can raft up to 390 km from their local origin. The authors suggested that wind and surface currents were the primary influences of trajectory; however, this was inferred from the genetic analyses and local climatology data [@fraser2011]. 

Besides wind and surface currents, waves are also an important ocean feature and work by the maritime industry has shown that the size, shape, and orientation of the object of a vessel determine the relative importance of waves or wind as drivers of trajectory [@breivik2011; @griffin2016]. In general, if the length of the object is longer than the significant wave height then waves will be the primary driver of trajectory while the opposite is true for shorter objects where the effect of waves is regarded as negligible [@breivik2011; @griffin2016]. Stokes drift is a wave-driven process and previous work has identified this as an aspect that needs to be considered when investigating dispersal of macroalgal species. Stokes drift is the net drift velocity of a particle floating at the ocean surface in the direction of wave propagation due to the differences between the velocity of the fluid particle and flow-field [@bremer2018]. More generally, the particle floating at the surface moves slightly faster in the direction of the wave as a result of the oscillatory motion of fluid particles within a wave. Stokes drift can significantly influence the trajectory of a particle or object floating at the surface of the ocean. For example, work by @fraser2018 included Stokes drift into the advection scheme for the Lagrangian model used to investigate the dispersal potential of the southern bull kelp *D. antarctica* to reach Antarctica. The results showed that the inclusion of wave-driven Stokes drift and mesoscale eddies suggest frequent incursions into Antarctica, which the authors attributed to storm-forced surface waves, further highlighting the role of wave-driven processes in the open ocean.

Research has shown that buoyancy and drag also play a role in determining the trajectory and rate of transport for surface floating material [@furnans2008; @beron2016; @trinanes2016; @dasaro2018; @gates2018; @onink2019; @shen2019].  Therefore, to  accurately determine the trajectory of marine kelp, both water and wind drag need to be considered. Drag is the force an object experiences when moving through a fluid which is proportional to the velocity of the object [@Vogel2020]. The fluid viscosity and the friction from the surface of the object results in the overall drag component, as well as the surface area and shape of the object [@Vogel2020]. If the object is partially submerged, as a result of buoyancy forces, then drag will be a combination of drag from the air and fluid [@Vogel2020]. The ‘sail’ area of an object floating at sea is the surface area exposed to the wind (air) which results in air-form drag, while the area of the object below the surface of the water is exposed to surface currents which result in hydrodynamic-form drag [@breivik2011; @griffin2017]. @allen1999 and @breivik2011 have provided estimates of drag for various objects based on experimental work using both direct and indirect methods of the Leeway model, However, this work did not consider biological material such as macroalgae. Therefore, no drag estimates exist for macroalgae floating at the surface of the ocean and alternative approaches should be used to account for the drag components. Although drag estimates do exist, these have been applied for kelp not detached from the substratum and are regarded as fixed-point estimates [@Denny1997; @Gaylord1997-ow; @Denny2002a; @Denny2002b;@Gaylord1997-ow]. 

Although various approaches have been used in the past to investigate floating macroalgal trajectories, very few studies have employed the use of Langrangian trajectory modeling. Works by @brooks2019, @putman2018 and @putman2020, used Lagrangian approaches to investigate the effects of inertia, raft-size, and windage (drag from the wind) on kelp trajectory. For example, @brooks2019 used a custom growth model to estimate changes in biomass and ultimately radial size, while a customized Hybrid Coordinate Ocean Model (HYCOM) for the trajectory simulations was used. Their results showed that the trajectory of pelagic Sargassum was significantly influenced by inertia and the radial size of the rafts. In the inclusion of wind into studies has also been performed on an *ad-hoc* basis, where a fraction of wind velocity field is simply added to the ocean velocity field in terms of the velocity vectors (meridonal and zonal); for example 1%, 2%, 5% of the ocean velocity field has been used previously [@putman2018;@putman2020]. @putman2020 investigated the effect of including windage in kelp trajectory simulations and showed that including ad hoc windage factors greatly improved accuracy regarding entrainment or expulsion from eddies when compared to tracked Sargassum mats in the ocean. Langrangian trajectory modeling is clearly a useful tool; however, the various models available often assume the object to either be purely Lagrangian (no drag) or to be only influenced by windage (drag from the wind), which is obviously not the case for both biological and anthropogenic forms of marine debris in nature. The radial size in relation to windage included by @brooks2019 is an improvement but this approach does not consider hydrodynamic drag. Another example is work by @zhong2012 describing Sargassum distribution in relation to mesoscale and submesoscale eddies by simulating passive tracers. The authors used two model configurations, one with an idealised eddy-flow and another that simulates flow in the western Gulf of Mexico to advect passive tracers as a proxy for Sargassum. The authors showed that mesoscale and submesoscale features both play a role in accumulation zones for the virtual Sargassum and were able to explain some of the observed accumulation of Sargassum in the western Gulf of Mexico. Treating the virtual Sargassum particles as passive tracers may be the reason for the unexplained patterns during comparison of simulated and observed distributions. The authors do mention running simulations which included Stokes drag and inertia using a Maxey-Riley approach, and state that it made no significant difference to the overall results. However, the authors only used the density as a parameter for calculating the relevant forces by making the particles 10% lighter than the surrounding fluid. Additionally, the authors did not consider surface area or take hydrodynamic drag and windage into account, all of which are important influencers of trajectory. 

Gyres, eddies, and converging surface currents have been identified as important in the accumulation and dispersal of plastics and other marine debris [@brach2018; @dasaro2018; @onink2019]. Investigations into the dispersal of marine debris have also included the possible effects of inertia in the accumulation of ocean drifter instruments in mesoscale features. For example, @beron2016 used a modelling approach to investigate the role of Ekman transport and inertia to explain the observed behavior of undrogued drifters in the ocean gyres. Undrogued drifter trajectory is affected by wind, unlike the drogue counterparts which makes the effects of wind negligible. The results showed that inertia, not Ekman transport, played a significant role in the observed drifter behaviour [@beron2016]. These authors also noted that the presence of other flotsam, along with the undrogued drifters in ocean gyres, suggests that aspects of inertia also play a role in accumulation of other marine debris [@beron2016]. The approach by @beron2016 has also been improved upon by @beron2019 but they also highlight the significant role of inertia in flotsam trajectory and accumulation.

This study aims to use a numerical approach to shed light on the role of hydrodynamic and direct wind drag on macroalgal drift trajectory using Lagrangian based trajectory simulations. The ‘behaviour’ of surface drifting kelp is investigated with specific focus on trajectories from a coastal environment to the open ocean. We achieved this by comparing the trajectory outputs of virtual passive particles (purely Lagrangian i.e no drag characteristics added, as a reference) with kelp particles (drag characteristics added) with surface area exposed to the various drag components. 

# Methods

## Study site

The region of interest for this study was the Cape Peninsula in the Western Cape (Figure 1A). Kommetjie, located on the Atlantic side of the Cape Peninsula (Figure 1B), was chosen as a release site. The hydrodynamics in the study region are characterized by a complex interaction of wind, sea waves and ocean swell, and are also influenced by larger-scale regional oceanic processes. The larger processes in the region can be attributed to the Agulhas Current (AC) and the Benguela Current (BC) [@lutjeharms2000;@lutjeharms2007;@garzoli1996;@hutchings2009;@rubio2009]. The AC is a component of the South-west Indian Ocean sub-gyre, flowing predominantly south-westward following the continental shelf edge and eventually retroreflecting eastward back into the South Indian Ocean [@lutjeharms2000;@lutjeharms2007]. 

The region where the retroflection occurs is known as the Agulhas Retroflection and consists of high levels of mesoscale variability [@garzoli1996]. The variability results in shedding of rings and filaments known as the Agulhas Rings and have an average diameter of ~324km [@lutjeharms1988;@lutjeharms2006; @lutjeharms2007]. Agulhas Rings are the main contributors to the Agulhas leakage which is the transport of warm water from the Indian Ocean to the South Atlantic Ocean [@garzoli1996; @lutjeharms2006; @beal2015]. The Agulhas leakage is also a source of mesoscale variability within the Benguela region as anticyclonic rings are shed and drift northwestward along the southern Benguela slope region [@rubio2009]. The Benguela region ---known as the Benguela Upwelling System (BUS)--- is characterized by strong coastal upwelling which is primarily driven by equatorward winds [@shannon1996;@hardman2003;@veitch2018; @veitch2017]. The BUS starts at 27$^\circ$S and extends southward to 35$^\circ$S [@shannon1996]. The region is also characterized by large amounts of mesoscale variability in the form of eddys and filaments [@blanke2002; @blanke2005; @rubio2009]. Inshore, the BUS is dominated by a northwestward flow, known as the Benguela Jet, due to topographical steering, wind stress and interactions with passing Agulhas Rings and eddys [@stramma1989; @veitch2010; @veitch2017; @veitch2018; @hutchings2009]. The stability of the jet varies seasonally with more stable flows in winter; in January, the jet begins to split between Cape Point and Cape Columbine [@veitch2018; @blanke2005; @blanke2002] which results in a weak narrow inshore branch that flows along the shelf edge and a strong flowing north-westwards offshore branch. The area is also characterized by high upwelling activity driven by strong westerly winds [@hutchings2009]. These winds are most intense during Austral summer (December-March) which favours upwelling conditions in the region, and also act to reinforce the flow of the Benguela Jet which favours upwelling waters contributing to the across-shore density gradient [@ragoasha2019]. In Austral winter the wind direction is reversed which decreases upwelling favorable conditions, but the core of the Benguela Jet is maintained by the intrusion of warm Agulhas waters into the Benguela region over the shelf edge [@veitch2018; @hutchings2009; @ragoasha2019]. 

```{r map chp3, echo=FALSE, message=FALSE, warning=FALSE, strip.white=TRUE, fig.cap="Figure 1: Map of the study domain and the main features pertaining to transport in the region. In panel A, the map of the western portion of the South African coastline and the main currents is presented. The resulting eddies and filaments forming from the Agulhas retroflection are indicated, and the position of the study area is drawn in as a black rectangle. Details of the study area are given in panel B. Here the splitting of the Benguela Jet, eddy features, and the general flow within the study domain are presented. The release site of simulated kelp ‘particles’ is represented by a black triangle."}

library(png)
library(grid)
library(gridExtra)

#map_chp3A <- rasterGrob(as.raster(readPNG("map/chp3_mapA.png")))
#map_chp3B <- rasterGrob(as.raster(readPNG("map/chp3_mapB.png")))
#ggarrange(map_chp3A, map_chp3B, ncol = 2, nrow = 1, labels = "AUTO", align = c("h"))
map_chp3_combined <- rasterGrob(as.raster(readPNG("map/chp3_map_final_v2.png")))
ggarrange(map_chp3_combined)

```

## Numerical models

Virtual particles were released with no drag effects from the study site to act as a reference for comparison to simulations with varying combinations of hydrodynamic and wind drag and are referred to hereafter as ‘passive particles.’ All particles that have any form of drag exposure are hereafter referred to as ‘kelp particles.’ All simulations have the same release location. The release site, Kommetjie, was in an area of a known kelp population, which a previous study by @coppin2020 collected morphological data from. Due to the resolution of the underlying ocean model (see Ocean and wind model section) nearshore processes are not resolved well. Therefore, the release site was placed in the adjacent grid cell in order to better represent offshore transport and to avoid model limitations with regards to nearshore transport. Since the aim of this investigation was to investigate the relative surface behaviour of virtual kelp particles, only the surface layer of the underpinning hydrodynamic models were used. It should also be noted that the Copernicus model (see Ocean and wind model section) used velocity vectors over some of the land covering the coastal domain. 

The time period used in all simulations were Austral summer, autumn, winter, and spring of 2018. These time periods were chosen based on variable mesoscale activities and stability of the Benguela Jet that occurs throughout the year. For example, splitting of the Benguela Jet occurs in January, which also coincides with a period of higher wind intensity, upwelling along the coast and mesoscale activity while in winter the Benguela Jet begins to stabilize until summer [@rubio2009; @Veitch2019; @ragoasha2019]. Simulations were executed for the duration of each season, with 3-hourly timesteps and 3-hourly outputs using a fourth-order Runge-Kutta advection scheme for both passive and kelp particles. Drag components for kelp particles were incorporated by the modifiable component of the OceanParcels advection scheme [@North2009; @vanSebille2018].

To test the different magnitudes that hydrodynamic and wind drag might play in the overall trajectory, simulations were run with degrees of drag exposure scenarios based on personal observations of drifting kelp. This acts as a proxy for buoyancy, which determines the surface area exposed to hydrodynamic and wind drag. These estimates were expressed as percentages which were used to calculate hydrodynamic and wind drag for the applicable simulation. The scenarios used in this study were 100%  and 85% for hydrodynamic and Stokes drag and 0% and 15% for wind.  Simulations were separated into fully submerged (100% hydrodynamic drag and 0% wind drag, see Figure 2A) and partially submerged (85% hydrodynamic drag, and 15% wind drag, See Figure 2C-D) categories. For each of the categories, particles were advected with different combinations of flow-fields (currents, currents-Stokes drift, currents-wind, currents-wind-Stokes drift).  A similar approach has been used in past research investigating the role of windage in distribution of pelagic Sargassum rafts by @putman2018 and @putman2020 in the form of ad hoc windage estimates; although the authors did not include hydrodynamic drag unlike the current study. 

To determine if vortices and eddies play a role in kelp accumulation on the surface, a separate set of simulations were performed. Unlike the previous simulations, these simulations released 10 particles over the latitudinal extent of the study domain from the study site, equidistant from each other. A summary of the simulations executed are provided in table 2.

## Particle tracking model

The model is based on parameterizations that have been used for previous studies investigating the dispersal patterns of various flotsam by implementing custom parameterisations of Lagrangian trajectory models [@furnans2008; @beron2016; @hart2018; @brooks2019; @putman2020; @jutzeler2020]. Once dislodged, kelp can accumulate on the surface and become entangled to form a dense mat known as a kelp-raft [@hobday2000a; @smith2002]. Kelp rafts are not a common feature around the coast of the Cape Peninsula; rather, solitary kelp is (pers. obs). Therefore, the trajectory of only solitary *E. maxima* individuals will be considered. All simulations in this study used the OceanParcels software package (version 2.0), which is an open source, customizable Lagrangian Trajectory tool [@delandmeter2019]. OceanParcels calculates the advection of particle trajectory with a Lagrangian method [@delandmeter2019], which can be described by the equation:

$$X(t+\Delta t) = X(t) + \int_{t}^{t+\Delta t} v(x, \tau)d \tau + \Delta X_b(t)$$

Here, ${X}_t$ is the position of the particle at time $t$, ${X}(t + \Delta t)$ is the position after a timestep $\Delta t$, ${v}({x},t)$ is the ocean velocity field, $dt$ is the time-step and $\Delta{X_b}(t)$ is a change in position due to 'behavior' or some kind of effect. To determine the new position of a particle, the integral has to be calculated. To investigate the effects of drag components of trajectory of floating macroalgae, this study incorporated drag as the custom behaviour for virtual kelp particles and zero effect for passive particles. 

This study simulated two scenarios: one where the plant is fully submerged and only exposed to hydrodynamic drag, and the other where parts of the plants are partially exposed resulting in a combination of hydrodynamic and air form drag. Drag based on spherical shape-based coefficients were used in the calculations for determining the overall kelp velocity vectors. The assumption made was that the mass of the kelp did not change for each virtual kelp particle over the course of the simulations. Hydrodynamic drag, wind drag, Stokes drag, and surface current-flow are two-dimensional vector quantities and were calculated for each time step for each simulation.

## Model inputs

### Cross-sectional area and simulation scenarios

To incorporate hydrodynamic and wind drag, the cross-sectional area of the kelp was calculated first. AlgaeBase was used to confirm the latest taxonomic associations for the study species [@Algaebase]. Known geometric shapes reflecting the relevant plant sections were used to estimate the surface area for various parts of the plant. The structure of *E. maxima* consist of a single primary blade that develops above a gas-filled float and a hollow stipe below. Secondary blades are produced laterally from the primary blade from several meristematic regions along the margins of the primary blade and is held to the substrate by finger-like haptera known collectively as the holdfast [@Dyer2018-rv]. For details refer to Figure 2A. 

The dimensional data needed were estimated in cases where data was not available for that morphological characteristic. The bulb/pneumatocyst is a highly variable morphological characteristic and in some cases can appear absent; the same is true for the holdfast. Therefore, a standard cross-sectional area was used for both the bulb and holdfast, for all simulations. 

```{r message=FALSE, warning=FALSE, include=TRUE, echo=FALSE, fig.height=4, fig.width=7, fig.cap="Figure 2: Panel A is a diagram of the *E. maxima* morphological characteristics considered in this study, along with the associated geometric shapes used to calculate the overall surface area of each morphological characteristic. Panel B represents the full submerged scenario, panel C represents the combined drag scenario when kelp is partially submerged and panel D represents a partially submerged kelp is exposed to hydrodynamic drag and momentum transfer from the wind when in the same direction of the current. The kelp Schematic was adapted from @Dyer2018-rv."}

kelp_shape_figure <- rasterGrob(as.raster(readPNG("figures/chapter_3/figure_2_v2.png")))
ggarrange(kelp_shape_figure)

```

The cross-sectional area calculated was site-specific and the dimensions needed were garnered from morphology data from a previous study by @coppin2020. The minimum, mean and maximum cross-sectional areas (Ac, Table 1) were calculated for each morphological characteristic, which were used for calculating the cross-sectional area needed to run the various simulations. Initially, experiments included minimum and mean surface areas but no differences could be seen. Therefore, the minimum and mean cross-sectional areas were ignored and simulations only considered the maximum cross-sectional area. Different combinations of flow fields were used for both passive and kelp particles, in order to determine the influence of drag (hydrodynamic, Stokes drift and wind) on macroalgal trajectory. The different combination of flow-fields and the relative associated drag components are hereafter referred to as ‘scenarios’.

```{r morphology wrangling, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
# Investigate morphology data to assist in estimating surface area

# Read in morphology data
eck_df <- read.csv("data/morph_data/eck_morph_data.csv", sep = ";") %>%
  filter(site!= "Rocky Bank") %>%   # Not using Rocky Bank in this study
  filter(site!= "De Hoop") 
eck_df$site <- as.character(eck_df$site)
eck_df <- eck_df %>% 
  filter(population == "Deep") 
eck_long_df <- gather(eck_df, Morphology, measurement, frond_mass:total_length, factor_key=TRUE)
# Summary stats to make it easier to refer to later, these will not be used any analysis.
site_list <- c("Kommetjie")
eck_stats <- eck_long_df %>% 
  group_by(site, Morphology) %>% 
  summarise(mean = mean(measurement, na.rm = T),
            minimum = min(measurement, na.rm = T),
            maximum = max(measurement, na.rm = T)) %>% 
  ungroup() %>% 
  filter(site %in% site_list) %>% 
  rename(Site = site) %>% 
  rename(Mean = mean) %>% 
  rename(Minimum = minimum) %>% 
  rename(Maximum = maximum)

#eck_stats <- flextable(data = eck_stats)
#eck_stats <- theme_zebra(eck_stats, odd_header = "transparent", even_header = "transparent")
#eck_stats <- align(x= eck_stats, align = "center", part = "all")
#eck_stats <- set_table_properties(eck_stats, width = 1, layout = "autofit")

```

```{r morphology table, message=FALSE, warning=FALSE, include=TRUE, echo=FALSE, eval=TRUE}

set_flextable_defaults(fonts_ignore=FALSE)

area_table <- read.csv("tables/chapter_3/area_table.csv", sep = ";")
area_table <- flextable(data = area_table)
area_table <- theme_zebra(area_table, odd_header = "transparent", even_header = "transparent")
area_table <- align(x= area_table, align = "center", part = "all")
area_table <- set_header_labels(area_table, Plant.characteristic = "Plant characteristic", Approximate.shape = "Approximate shape", Equation.used = "Equation Used", Plant.dimensions = "Plant dimensions")
area_table <- set_header_labels(area_table, Ac.Minimum = "Ac Minimum", Ac.Mean = "Ac Mean", Ac.Maximum = "Ac Maximum")
#area_table <- set_table_properties(area_table, width = 1, layout = "autofit")
area_table <- fontsize(area_table, size = 8, part = "body")
area_table <- fontsize(area_table, size = 8, part = "header")
area_table <- set_caption(area_table, " Summary of the attributes and estimates used to calculate the overall surface area of Kommetjie kelp individuals used in the various simulations. Approximate shape refers to the dimensions of the geometric shape used to represent a particular morphological characteristic. Equations used are the equations relating to the dimensions used for the geometric shape estimate. Plant dimensions are the measurements used, collected in previous work by @coppin2020, used to calculate the associated surface areas. Ac refers to the cross-sectional area calculated. The total surface areas for each plant characteristic for each surface area type make up the remaining columns. Where applicable r is the radius, h is the heigh, l is the length, w is the width, and h is the height.")
area_table
```

### Flow-models

Both passive and kelp particles were simulated around the South African coastline within hindcast outputs from the Copernicus Marine Environment Monitoring Service (Copernicus, http://marine.copernicus.com). The Copernicus model is based on the modelling framework known as Nucleus for European Modelling of the Ocean (NEMO). The Copernicus outputs used in this study contain 3D daily current information from the surface layer to the bottom (Global Analysis Forecast PHY_001_030). The model has a spatial resolution of 0.08 geographical degrees and is interpolated on a rectangular grid. To incorporate the effects of direct wind drag within the simulations, the Copernicus Marine Environment Monitoring Service global wind product was used (Global Ocean Wind L4_NRT_012_004). The outputs from the model are composed of 6-hourly averaged fields of surface 10 m wind velocity vectors with a spatial resolution of 0.25 geographical degrees. Finally, to test the direct effects of Stokes-drift, the Copernicus Marine Environment Monitoring Service global wave product was used (Global Analysis Forecast WAVE_001_027) which are composed of 3-hourly instantaneous velocity vectors on a standard grid at 0.08 geographical degrees. Averaged ocean current, wind and Stokes drift data are stored as meridional and zonal velocity vectors.

### Drag components

Drag components calculated was incoporated into simulations by means of the modifiable custom behavior component of the underling OceanParcels advection scheme. The drag coefficient for a spherical particle was used in the calculation of hydrodynamic drag, as the trajectory model assumes the particles are spherical. The drag equation used was: $F_d = (0.5 \rho A_c C_d U^2)/m$, where $\rho$ is the density of seawater or air, $A_c$ is the cross-sectional area exposed to the relevant drag component, $C_d$ is the drag coefficient for a spherical particle, $m$ is the total mas of the plant, and $U$ is the surface velocity vector of the flow-/wind- field. Dividing the calculated force by the mass of the plant transforms it to the appropriate units (m/s) for use in the trajectory modelling script. Hydrodynamic, wind drag and Stoke's drift components were calculated separately for both the meridional and zonal velocity vectors [@furnans2008; @putman2018; @putman2020]. The same equation and approach used to calculate hydrodynamic drag, was also used to calculate wind and Stokes drift drag components. Since drag force is dependent on the velocity vectors which vary with time, the meridional and zonal velocities were interpolated and used in the drag force calculation for each time-step. The velocity of the resultant drag component is then added to the particle velocity, which is based on the underlying Euerlian flow-field, and determines the overall velocity of the particle and grid node position.  

## Analysis

To compare trajectories between scenarios and seasons, trajectories were calculated, and density distribution maps were produced. Single trajectories allow comparison of pathways between scenarios, and density distribution maps are an effective method for assessing pathways and ocean connectivity [@vanSebille2018]. The distance that particles traveled was also measured and used to produce boxplots. Distance traveled from the release site can help reveal topographic steering and momentum energy transfer from the wind field to kelp particles [@vanSebille2018]. If the wind direction is in the same direction as the current the virtual particles will cover larger distances due to an increase in the velocity because of momentum energy transfer [@putman2020; @putman2018; @vanSebille2018]. Topographic steering occurs when ocean currents make contact with underlying bathymetery features, such as sea mounts and ridges. Under topographic steering currents will tend to follow lines of constant potential vorticity [@davis1991;@vanSebille2018]. 

# Results

Overall, the results showed that the inclusion of drag parameters influenced trajectory patterns and entrainment patterns of virtual kelp particles. Single trajectories for each of the scenarios will be presented, followed by the comparison of density distributions and distance travelled by particles. Finally, the results from the separate set of experiments advecting single particles across the study domain will be presented. 

```{r data readin, message=FALSE, warning=FALSE, include=FALSE}

## single release

total_summer_single <- read.csv(file = "data/chapter_3/total_summer_single.csv")
total_autumn_single <- read.csv(file = "data/chapter_3/total_autumn_single.csv")
total_winter_single <- read.csv(file = "data/chapter_3/total_winter_single.csv")
total_spring_single <- read.csv(file = "data/chapter_3/total_spring_single.csv")

total_passive_summer_single <- read.csv(file = "data/chapter_3/total_passive_summer_single.csv")
total_passive_autumn_single <- read.csv(file = "data/chapter_3/total_passive_autumn_single.csv")
total_passive_winter_single <- read.csv(file = "data/chapter_3/total_passive_winter_single.csv")
total_passive_spring_single <- read.csv(file = "data/chapter_3/total_passive_spring_single.csv")

total_passive_summer_single <- total_passive_summer_single %>% 
  filter(type!= "Currents and Wind") %>% 
  filter(type!= "Currents, Wind and Stokes")

total_passive_winter_single <- total_passive_winter_single %>% 
  filter(type!= "Currents and Wind") %>% 
  filter(type!= "Currents and Stokes") %>% 
  filter(type!= "Currents, Wind and Stokes")

total_passive_spring_single <- total_passive_spring_single %>% 
  filter(type!= "Currents and Wind") %>% 
  filter(type!= "Currents and Stokes") %>% 
  filter(type!= "Currents, Wind and Stokes")
  
## continued release

total_summer <- read.csv(file = "data/chapter_3/total_summer_noscale.csv")
total_summer_mean <- read.csv(file = "data/chapter_3/total_summer_mean.csv")

total_autumn <- read.csv(file = "data/chapter_3/total_autumn_noscale.csv")
total_autumn_mean <- read.csv(file = "data/chapter_3/total_autumn_mean.csv")

total_winter <- read.csv(file = "data/chapter_3/total_winter_noscale.csv")
total_winter_mean <- read.csv(file = "data/chapter_3/total_winter_mean.csv")

total_spring <- read.csv(file = "data/chapter_3/total_spring_noscale.csv")
total_spring_mean <- read.csv(file = "data/chapter_3/total_spring_mean.csv")

total_passive_summer <- read.csv(file = "data/chapter_3/total_passive_summer.csv")
total_passive_summer_mean <- total_passive_summer %>% 
  group_by(t, type) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))
total_passive_autumn <- read.csv(file = "data/chapter_3/total_passive_autumn.csv")
total_passive_autumn_mean <- total_passive_autumn %>% 
  group_by(t, type) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))
total_passive_winter <- read.csv(file = "data/chapter_3/total_passive_winter.csv")
total_passive_winter_mean <- total_passive_winter %>% 
  group_by(t, type) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))
total_passive_spring <- read.csv(file = "data/chapter_3/total_passive_spring.csv")
total_passive_spring_mean <- total_passive_spring %>% 
  group_by(t, type) %>%
  summarise(across(lon:lat, mean, na.rm= TRUE))

# Line/Eddy experiment

total_eddy_hydro <- read.csv(file = "data/chapter_3/total_eddy_hydro.csv")
total_eddy_hydrostksdrag <- read.csv(file = "data/chapter_3/total_eddy_hydrostksdrag.csv")
total_eddy_hydrowinddrag <- read.csv(file = "data/chapter_3/total_eddy_hydrowinddrag.csv")
total_eddy_hydrowindstksdrag <- read.csv(file = "data/chapter_3/total_eddy_hydrowindstksdrag.csv")

total_eddy_passive_curr <- read.csv(file = "data/chapter_3/total_eddy_passive_curr.csv")
total_eddy_passive_currstks <- read.csv(file = "data/chapter_3/total_eddy_passive_currstks.csv")
total_eddy_passive_currwind <- read.csv(file = "data/chapter_3/total_eddy_passive_currwind.csv")
total_eddy_passive_currwindstks <- read.csv(file = "data/chapter_3/total_eddy_passive_currwindstks.csv")

load("map/south_africa_coast_hi_res.Rdata")
load("map/sa_bathy.RData")

```

## Trajectory comparison

The trajectories of the virtual kelps under different drag scenarios during Austral summer show no differences with those of passive particles advected by currents but do differ with passive particles advected by the different combinations of currents, Stokes drift and wind fields (Austral summer; Figure 3A). The results from the simulations of virtual kelp particles show no differences between scenarios. Any passive particles advected with Stokes drift travelled further than those that did not, while the combination of wind and currents for passive particles travelled the least distance compared to the other simulations for the same time period (Figure 3A, blue line). In all simulations for Austral summer, particles flowed-north-westward except for the currents and wind combination for passive particles which initially travelled shoreward. 

The trajectories of kelp particles across all drag scenarios showed no difference with passive particles advected by currents, but differences between the other passive scenarios and kelp particles was evident for Austral Autumn (Figure 3B). When comparing passive particles, only slight variations were evident for any simulation including Stokes drift, while currents and currents-wind showed slight variations between each other; with passive particles advected by currents travelling further offshore. The results from the simulations show that any scenario including Stokes drift for the passive particles results in the  trajectories flowing closer to shore (Figure 3B). Particles flowed in a north-westward direction and then slightly eastward near the end of the simulation run, across all simulations for both passive and kelp particles. 

No differences were evident across drag scenarios, and between passive particles advected by currents, and between kelp particles of different drag scenarios for Austral Winter (Figure 3C). There was slight variation between passive trajectories with the only variation the further distance travelled by passive particles for the currents-wind scenario. Unlike the previous time-periods, the overall direction for both passive and kelp particles was shoreward (eastwards) and then south along the eastern part of the coastline. 

In Austral Spring, no differences between kelp particles with different drag scenarios was evident, and no difference was evident between all kelp particle scenarios and passive particles advected by currents (Figure 3D). When comparing passive particles clear differences between current and current-wind scenarios is evident, with passive particles advected by currents displaced further offshore compared to passive particles with current-wind scenario. No difference in trajectories between passive particles advected by currents-Stokes drift and currents-wind-Stokes drift was evident with only a slight variation in distance travelled. Particles travelled in a north-westward direction across all scenarios for both passive and kelp particles.  Overall, all kelp particles regardless of the drag scenario followed the same trajectory as passive particles advected by currents across all seasons and drag scenarios.

```{r meantraj, message=FALSE, warning=FALSE, include=FALSE, echo = FALSE}

traj_summer <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_passive_summer_single, aes(x = lon, y = lat, colour = type), alpha = 0.4) +
  geom_path(data = total_summer_single, aes(x = lon, y = lat, linetype = type))+
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  guides(colour=guide_legend(title="Passive Particles",nrow=2,byrow=TRUE)) +
  guides(linetype=guide_legend(title="Kelp Particles",nrow=2,byrow=TRUE)) +
  coord_fixed(ratio=1, clip = "on", xlim = c(11, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12))

traj_autumn <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_passive_autumn_single, aes(x = lon, y = lat, colour = type), alpha = 0.4) +
  geom_path(data = total_autumn_single, aes(x = lon, y = lat, linetype = type))+
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  guides(colour=guide_legend(title="Passive Particles",nrow=2,byrow=TRUE)) +
  guides(linetype=guide_legend(title="Kelp Particles",nrow=2,byrow=TRUE)) +
  coord_fixed(ratio=1, clip = "on", xlim = c(11, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12))

traj_winter <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_passive_winter_single, aes(x = lon, y = lat, colour = type), alpha = 0.4) +
  geom_path(data = total_winter_single, aes(x = lon, y = lat, linetype = type))+
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  guides(colour=guide_legend(title="Passive Particles",nrow=2,byrow=TRUE)) +
  guides(linetype=guide_legend(title="Kelp Particles",nrow=2,byrow=TRUE)) +
  coord_fixed(ratio=1, clip = "on", xlim = c(11, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12))

traj_spring <- ggplot()+
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_passive_spring_single, aes(x = lon, y = lat, colour = type), alpha = 0.4) +
  geom_path(data = total_spring_single, aes(x = lon, y = lat, linetype = type))+
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  guides(colour=guide_legend(title="Passive Particles",nrow=2,byrow=TRUE)) +
  guides(linetype=guide_legend(title="Kelp Particles", nrow=2,byrow=TRUE)) +
  coord_fixed(ratio=1, clip = "on", xlim = c(11, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12))
 
```

```{r Figure 3, echo=FALSE, message=FALSE, warning=FALSE, fig.height=8, fig.width=8, fig.cap="Figure 3: Comparison of single trajectories. Simulations 1,5,9,13,17,21,25,29 are represented in panel A (Austral summer simulations), 2,6,10,14,18,22,26,30 in panel B (Austal aumtumn simulations), 3,7,11,15,19,23,27,31 in panel C (Austral winter simulations), and 4,8,12,16,20,24,28,32 in panel D (Austral spring simulations). Overlapping of linetypes will be represented by a solid black line for kelp particles."}

# Remember data for this section has been edited for this section
ggarrange(traj_summer, traj_autumn, traj_winter, traj_spring, ncol = 2, nrow = 2, font.label = list(size = 12, face = "bold"), common.legend = FALSE, legend = c("bottom"), labels = c("A","B","C","D"), align = "hv")

#ggsave(filename = "figure_3v2.jpg", plot = last_plot(), path = "figures/chapter_3/", units = c("cm"), width = 40, height = 40, scale = 1.2)

```


## Comparison of density distributions

Density distributions summarizing the conclusion of simulating all passive and kelp scenarios (Table 2) are presented in Figure 4A-B. Across all simulations for Austral summer, particles flow in a north-westward direction. The only passive particle scenario that resulted in entrainment were particles advected by currents with particles concentrated on the boundary of the mesoscale feature (Figure 4A). The passive particles that were advected with Stokes drift resulted in particles concentrating closer to shore, and less dispersion of particles off the continental shelf (Figure 4A). Passive particles advected by currents-wind showed greater dispersion over the continental shelf and closer to shore compared to the other passive particle scenarios. The density plots that consider any form of drag showed entrainment patterns, with kelp particles towards the centre of the mesoscale feature (Figure 4B). No differences were evident between different drag scenarios for kelp particles.    

In Austral Autumn (Figure 4C-D) across all simulations, particles flowed in a north-westward direction. Passive particles advected by currents showed similar density distribution to kelp particles, but the other passive particles scenarios showed no entrainment patterns (Figure 4C). The density plots for kelp particles with any drag scenario show slight entrainment patterns with no differences in density evident between kelp particle drag scenarios (Figure 4D). When comparing kelp particles to passive particles, clear differences in density were evident. Kelp particles are less concentrated along the overall trajectory compared to passive particles which show a higher concentration of particles. 

Simulations for Austral winter (Figure 5A-B) showed that the flow was also north-westward with only slight variation in density distribution for kelp particles and clear differences between passive particle scenarios. Clear differences are evident between passive particle scenarios (Figure 5A). Passive particles advected by currents show a similar density distribution to that of kelp particles for the same time-period (Austral Winter, Figure 5A-B). Passive particles advected with Stokes drag showed distribution of particles closer to shore compared to the other passive scenarios. No differences or variation was evident when comparing kelp particle drag scenarios, only showing slight entrainment patterns in the north-westward portion of the study domain (Figure 5B). The currents-wind scenario differed from all the kelp and passive scenarios for the same time-period (Austral Winter, Figure 5B), and showed large spread of particles over the study domain and surrounding mesoscale features offshore. 

Simulations executed for Austral Spring (Figure 5C-D) showed no differences in density distribution between kelp particles. Passive particles for the same time-period (Austral Spring, Figure 5C) are concentrated along the overall trajectory and are less spread out. Passive particles that are close to mesoscale activity follow the boundary of the feature and do not spread out or become entrained (Figure 5C). Passive particles advected with Stokes drift are less distributed offshore and are instead concentrated along the overall trajectory and towards shore. Across all drag scenarios for kelp particles, entrainment patterns were evident, and particles were spread westwards across the study domain Figure 5B and 5D).  
```{r density plots, message=FALSE, warning=FALSE, echo=FALSE}

## Heatmaps of study domain, use previous data for study site map and histograms

heatmap_summer <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_summer, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("Kelp Particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_autumn <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_autumn, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_winter <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_winter, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("Kelp Particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_spring <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_spring, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

### Passive passive

heatmap_summer_passive <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_passive_summer, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("Passive Particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_autumn_passive <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_passive_autumn, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_winter_passive <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_passive_winter, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("Passive Particles") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_spring_passive <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = total_passive_spring, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis",limits = c(1, 5000))  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  facet_wrap("type") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(11, 20), ylim = c(-35, -28)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 
```

```{r figure 4, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 4: Comparison of density plots at the end run time for both passive and kelp scenarios, for Austral summer (panel row A) and autumn (panel row B). Simulations 33,37,41,45 are represented in panel A, 49,53,57,61 are represented in panel B, simulations 34,38,42,46 are represente in panel C, and simulations 50,54,58,62 are represented in panel D. The plots are regular hexagons within which the density of particles were calculated. The reader is referred to tables 1 and 2 for details pertaining to each simulation.', fig.height=10, fig.width=9}

ggarrange(heatmap_summer_passive, heatmap_summer, heatmap_autumn_passive, heatmap_autumn, labels = c("AUTO"), nrow = 2, ncol = 2, common.legend = TRUE, legend = c("bottom"),font.label = list(size = 12, face = "bold")) 

ggsave(filename = "figure_4.jpg", plot = last_plot(), path = "figures/chapter_3/", height = 10, width = 9, scale = 1, dpi = 300)
```


```{r r figure 5, echo=FALSE, message=FALSE, warning=FALSE, fig.cap='Figure 5: Comparison of density plots at the end run time for both passive and kelp scenarios, for Austral winter (panel row C) and spring (panel row D). Simulations 35,39,43,47 are represented in panel A, 51,55,59,63 are represented in panel B, simulations 36,40,44,48 are represente in panel C, and simulations 52,56,60,64 are represented in panel D. The plots are regular hexagons within which the density of particles were calculated. The reader is referred to tables 1 and 2 for details pertaining to each simulation', fig.height=10, fig.width=9}

ggarrange(heatmap_winter_passive, heatmap_winter, heatmap_spring_passive, heatmap_spring, labels = c("AUTO"), nrow = 2, ncol = 2, common.legend = TRUE, legend = c("bottom"),font.label = list(size = 12, face = "bold")) 

ggsave(filename = "figure_5.jpg", plot = last_plot(), path = "figures/chapter_3/", height = 10, width = 9, scale = 1, dpi = 300)
```


## Comparison of distances 

The results for the comparison of distance travelled by passive and kelp particles across all scenarios and seasons are presented in Figure 6.  There were no significant differences (Figure 6; p > 0.05) for distance travelled across all kelp particles drag scenarios and seasons. Kelp particles travelled the least distance in Austral winter (Figure 6C) compared to other seasons and across passive particle scenarios. With regards to passive particles, clear differences and variation in the mean distance travelled was evident. For Austral Summer, the currents-wind scenario for passive particles travelled significantly less distance compared to the other scenarios (currents, currents-Stokes drift, currents-wind-Stokes drift, Figure 6B). There were no significant differences in distance travelled between all passive scenarios for Austral Autumn (p > 0.05; Figure 6D). For Austral winter, all passive particle scenarios with Stokes drift  included travelled significantly less distance compared to other passive particle scenarios (p < 0.05; Figure 6F). The same was true for Austal spring, which also showed that passive particles with Stokes drift flow travelled significantly less distance compared to other passive particle scenarios (p < 0.05; Figure 6H).

```{r distance chp3 processing, message=FALSE, warning=FALSE, include=FALSE}
# Kelp particles
dis_plot_summer <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_summer, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dis_plot_autumn <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_autumn, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dis_plot_winter <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_winter, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dis_plot_spring <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_spring, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

#Passive particles

dis_plot_summer_pass <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_passive_summer, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dis_plot_autumn_pass <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_passive_autumn, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dis_plot_winter_pass <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_passive_winter, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

dis_plot_spring_pass <- ggplot()+
  #geom_boxplot(data = passive_summer, notch = TRUE, notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  geom_boxplot(data = total_passive_spring, aes(x = type, y = distance, show.legend = FALSE), notch = TRUE,   notchwidth = 1, show.legend = FALSE, stat = "boxplot") +
  #scale_x_discrete(labels= pos_dist_plot) +
  stat_compare_means(method = "kruskal.test", label = "p.signif", label.x.npc = c("right"))+
  theme_bw()+
  ylab("Distance (km)")+
  xlab("Type")+
  #coord_flip() +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r distance plot chp3, message=FALSE, warning=FALSE, echo=FALSE, fig.cap="Figure 6: Boxplots of total distance travelled by all particles from the release site over the course of the simulations for scenarios 1 - 64. The *x*-axis represents the scenario number, and the *y*-axis is the distance travelled in kilometers. The lower and upper hinges correspond to the first and third quartiles. The whiskers represent the range, solid black lines represent the median and black dots are outliers. The reader is referred to Tables 1 and 2 for details pertaining to each scenario."}

ggarrange(dis_plot_summer, dis_plot_summer_pass, dis_plot_autumn, dis_plot_autumn_pass, dis_plot_winter, dis_plot_winter_pass,dis_plot_spring, dis_plot_spring_pass, label = "AUTO", ncol = 2, nrow = 4, legend = "none", common.legend = FALSE)

ggsave(filename = "figure_6.jpg", plot = last_plot(), path = "figures/chapter_3/", height = 10, width = 8, scale = 1, dpi = 300)
```


## Line experiment 

The results from simulations which released single particles along the longitudinal extend of the study domain are presented in Figure 7 and 8. When comparing kelp particles with different drag scenarios, no differences or even variation in the trajectory of single particles was evident from the results. Across all seasons and drag scenarios, kelp particles located from the edge of the continental shelf towards the eastern part of the study domain showed entrainment patterns and/or flowed northward. Kelp particles released from the study site (Kommetjie) did not show any entrainment patterns and flowed north-westward. 
```{r message=FALSE, echo=FALSE, warning=FALSE, include=FALSE}
# summer

eddy_hydro_plot <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_hydro, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme_bw() +
  ggtitle("Kelp") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

eddy_hydrostksdrag_plot <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_hydrostksdrag, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

eddy_hydrowinddrag_plot <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_hydrowinddrag, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme_bw() +
  ggtitle("Kelp") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

eddy_hydrowindstksdrag_plot <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_hydrowindstksdrag, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

# Passive particles

eddy_passive_plot_curr <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_passive_curr, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme_bw() +
  ggtitle("Passive") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

eddy_passive_plot_currstks <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_passive_currstks, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

eddy_passive_plot_currwind <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_passive_currwind, aes(x = lon, y = lat, colour = trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme_bw() +
  ggtitle("Passive") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

eddy_passive_plot_currwindstks <- ggplot() +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID), size = 0.4,     colour = "black",     fill = "grey") +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_point(data = total_eddy_passive_currwindstks, orientation = "y", aes(x = lon, y = lat, colour =       trajectory), show.legend = FALSE) +
  scale_colour_continuous(type = "viridis",limits = c(0, 9))  +
  facet_wrap("Season") +
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  #guides(colour=guide_legend(title="Passive Particles")) +
  #guides(linetype=guide_legend(title="Kelp Particles")) +
  coord_fixed(ratio=1, clip = "on", xlim = c(7, 20), ylim = c(-36, -28)) + # fix the aspect ratio of plot
  theme(plot.title = element_text(hjust = 0.5)) +
  theme_bw() +
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 
```

```{r Figure 7, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 7: Comparison of single kelp and passive particle trajectories for all seasons released along a line from the study site (Kommetjie), equidistant apart. Simulations 65-68 are represented in panel A, 81-84 are represented in panel B, 69-72 are represented in panel C, and 85-88 in panel D.", fig.height=8, fig.width=10}

ggarrange(eddy_passive_plot_curr, eddy_hydro_plot, eddy_passive_plot_currstks, eddy_hydrostksdrag_plot, common.legend = TRUE, legend = c("none"), ncol = 2, nrow = 2, labels = c("AUTO"), font.label = list(size = 12, face = "bold"), align = "hv")

ggsave(filename = "figure_7.jpg", plot = last_plot(), path = "figures/chapter_3/", height = 6, width = 8, scale = 2, dpi = 300)
```

When comparing passive particles advected with no drag but by the same combination of flow fields as kelp particles, differences and variation was evident. Passive particle trajectories across all advection scenarios generally flowed north-westward and/or flowed on the boundary of mesoscale features (Figure 7B,D and Figure 8B,D). The advection scenarios which included Stokes drift showed trajectories closer to the coast compared to scenarios which did not include Stokes drift. The simulations which included Stokes drift for passive particles showed more particles travelling north westward compared to particles which did not.

```{r Figure 8, warning=FALSE, echo=FALSE, message=FALSE, fig.cap="Figure 8: Comparison of single kelp and passive particle trajectories for all seasons released along a line from the study site (Kommetjie), equidistant apart. Simulations 73-76 are represented in panel A, 89-92 are represented in panel B, 77-80 are represented in panel C, and 93-96 in panel D.", fig.height=8, fig.width=10}

ggarrange(eddy_passive_plot_currwind, eddy_hydrowinddrag_plot, eddy_passive_plot_currwindstks, eddy_hydrowindstksdrag_plot, common.legend = TRUE, legend = c("none"), ncol = 2, nrow = 2, labels = c("AUTO"), font.label = list(size = 12, face = "bold"), align = "hv")

ggsave(filename = "figure_8.jpg", plot = last_plot(), path = "figures/chapter_3/", height = 6, width = 8, scale = 2, dpi = 300)
```


# Discussion

The findings from this study broaden our understanding of macroalgal trajectory patterns and behavior in the ocean. In particular, the results show that consideration of drag and surface area are important when investigating macroalgal trajectory patterns. The treatment of drifting kelp as purely Lagrangian does not accurately determine patterns of passive dispersal, such as entrainment in eddies or vortices [@fossette2012; @miron2020]. Although past research has shown the inclusion of inertia and windage greatly increase observed kelp trajectory and entrainment characteristics [@putman2018; @brooks2018;@brooks2019; @putman2020], past research has focused on large macroalgal-rafts which can vary greatly in size and surface area. None of the extant research has taken advantage of the advancement in numerical ocean models and Lagrangian trajectory modeling to investigate how aspects of drag (hydrodynamic and wind) affect the trajectory patterns of solitary drifting kelp. This study compared particle trajectories with simulations that included no forms of drag with simulations that included various forms of drag. Kelp trajectory deviated from the passive trajectory when including varying levels of hydrodynamic and wind drag scenarios. The results from this study show the inclusion of hydrodynamic and wind drag results in observable entrainment patterns and broadens our understanding of how surface area plays a role in solitary drifting kelp trajectory, in this case that of *E. maxima*.

Past research has inferred from direct and indirect techniques that drifting macroalgae tend to follow the prevailing surface currents [@thiel2005; @hobday2000; @fraser2011; @rothausler2011; @rothausler2011]. The results from this numerical experiment confirm that drifting macroalgae do follow the surface current in the study region when considering only hydrodynamic drag. In addition, not only are the trajectories similar but so are the endpoints at the end of simulation. Interestingly, when *ad hoc* wind drag (windage) is considered in combination with hydrodynamic drag the end locations do not differ either. It was expected that the inclusion of wind drag would cause kelp particles to flow further away from the coast and with a greater distance travelled from the release location. Wind drag adds to the effects of hydrodynamic drag when the wind direction and current direction are opposite to each other. However, when the wind direction is in the same or similar direction to that of the current, momentum energy from the wind is transferred to the object [@hackett2006; @putman2020]. This causes objects to travel further as well as become exposed to different time varying flows. 

Past studies have shown this when including windage as a function of inertia [@putman2018;@brooks2019; @putman2020]. A study by @putman2020 used *ad hoc* windage factors that was based on the surface current velocity to assess the approach for improving transport predictions of pelagic *Sargassum sp*. The results showed that including ad-hoc windage factors improved virtual trajectories compared to tracked *Sargassum sp* mats, which was partly due to the inclusion of momentum energy transfer from wind. The results from this study suggest that when considering solitary floating kelp the effect of wind in the form of momentum energy transfer is negligible, and does not influence the overall trajectory. The previously mentioned studies including wind drag focused on rafts which would have a significantly larger surface area exposed to the wind compared to a solitary individual. Therefore, in this study the surface area of kelp particles exposed to wind drag was not enough to influence the overall trajectory. A similar result was found by @gouvello2020 who investigated the effects of swimming behavior on sea turtle hatchling dispersal in the Agulhas region. The results suggested that the hatchling trajectories were mostly influenced by the ocean currents in the first year of hatching as juveniles do not swim fast enough to alter their overall trajectory. Another possible reason considered was the resolution of the ocean model used. The resolution of the underlying ocean model is an important aspect of Lagrangian ocean modeling and must be able to resolve sub-grid scale ocean processes for finer scale applications. A study by @hart2018 assessed the inclusion of stochastic motion, wind, and currents into forecasting for search and rescue using the same ocean model used in this study. The authors found that the inclusion of Brownian motion greatly increased the accuracy in representing sub-grid scale processes and that the inclusion of wind, currents, and stochastic motion greatly improved forecasting applications. In this study, an eddy-resolving model was used which greatly increases the sub-grid scale processes. Therefore, the authors argue that the lack of dissimilarity between trajectories of kelp particles is not as a result of the ocean model used.

The different trajectory patterns between seasons reflects the underlying seasonal variation in regional oceanography. Transport in the study region is driven by a combination of variation of alongshore jets and wind induced Ekman transport of surface water [@rubio2009;@Veitch2019; @ragoasha2019]. @ragoasha2019 investigated the success of Lagrangian particles reaching St. Helena Bay from Cape Point using Lagrangian trajectory modelling and inclusion of regional oceanographic processes. The authors showed that transport success was higher in spring due to the single coherent Benguela Jet, which is most intense over the 300m isobath [@ragoasha2019]. During the upwelling season (December - March) transport success was less efficient as particles tend to flow offshore. The move offshore was a result of the bifurcation of the Benguela Jet, which splits because of shoaling and causes particles to be exposed to higher amounts of mesoscale activity. In the winter months, the Benguela Jet was still split but the flow weakens which resulted in lower transport success [@ragoasha2019]. Similar patterns were found in this study, suggesting that the difference in seasonal patterns reflects the regional oceanographic features, particularly the Benguela Jet.
The addition of drag forces caused the kelp particles to cluster together compared to that of the passive particles which were more evenly dispersed. This was most likely due to the shared drag characteristics among the kelp particles which included the plants’ mass and surface area into the calculation. Other studies investigating flotsam trajectory characteristics have found similar results [@breivik2011; @miron2020; @olascoaga2020]. A study by @miron2020 conducted field experiments using a range of objects such as spheres, cubes, and cuboids to investigate the effect of inertia on particle dynamics. The results from the study showed that objects tended to cluster according to the shape of the object which the authors attributed to shared characteristics of inertia. Although drag force and not inertia was used in this study, the same conclusion applies—drag is therefore an important characteristic to consider when investigating or predicting solitary drifting macroalgal trajectories.

The similarities between the different combined drag scenarios suggest that wind exposure did not significantly alter trajectories. Instead, the results from this study suggest that the inclusion of drag forces (both hydrodynamic and wind) in simulating macroalgal trajectory may result in improving accuracy of modeling entrainment patterns. All the simulations that included any form of drag resulted in a high density of particles entrained in an eddy. The entrainment and expulsion from eddies and vortices are an important characteristic of floating kelp. Accuracy in predicting entrainment and expulsion of kelp-rafts from eddies has been investigated previously by @putman2018 and @putman2020, who showed that including windage greatly improved entrainment patterns when comparing virtual and real Sargassum rafts. However, these studies investigated large rafts and not floating individuals. Inertia was based on the size/mass of the raft, while hydrodynamic and wind drag are based on current velocity and surface area. Therefore, the role of inertia may be negligible for a solitary individual and rather other forms of drag, such as in this study, should be considered. The results from this study suggest that the inclusion of hydrodynamic and/or wind drag was an important component when simulating virtual kelp particles and greatly increased the accuracy of entrainment and expulsion from sub-grid mesoscale oceanographic features, such as eddies and vortices.

These results clearly show that the inclusion of drag greatly increases the number of particles entrained in mesoscale features within the study domain. Eddies may act as accumulation zones for kelp where the formation of rafts may occur, or the kelp is entrained for long enough to eventually sink in an area below the eddy. A study by @woodborne1989 references a site offshore approximately 120 km from Cape Columbine where dredged kelp was found, which coincides with the region where virtual kelp was entrained by an eddy. Finally, the inclusion of Stokes drift within the simulations had no effect on overall trajectory or entrainment patterns of virtual kelp particles, which suggests that the influence of waves is negligible with regards to solitary floating *E. maxima*. Past research has shown that the length of a floating object in relation to the significant wave height determines the influence of waves on overall trajectory. Trajectories of objects with lengths shorter than the significant wave height will not be influenced by wave related processes, in this case Stokes drift [@allen1999; @breivik2011; @griffin2017]. 

# Conclusion

Most of the past research has focused on large kelp-rafts which can vary greatly in size and shape; however, prior to our study, no research existed to clarify the drifting characteristics of solitary kelp. Understanding how to accurately model the distribution of solitary kelp will lead to better understanding of accumulation zones and sinks, and ultimately the ecological links pertaining to those processes. The ecological links characterized will highlight ecosystems that are tightly dependent on kelp for proper ecological functioning, and these areas might also have a unique biodiversity compared to surrounding areas where less detrital input is present. The findings from this study indicated that solitary floating virtual *E. maxima* particles tended to follow the prevailing surface currents and the inclusion of wind caused the trajectories to differ greatly from that of a purely Lagrangian particle. Furthermore, the inclusion of both hydrodynamic and wind drag caused clustering of particles along the trajectory as well caused particles to become entrained in eddies. Finally, Stokes drift drag did not influence trajectory and dispersal patterns of virtual kelp particles, suggesting that the effect of waves can be ignored when modelling solitary floating kelp. Overall, the inclusion of drag forces is an important aspect to consider when investigating the dispersal patterns of solitary kelp, while differences in cross-sectional areas are not. This study also provided an approach which can be adapted to model any floating solitary kelp, provided the surface area can be estimated accurately. Our results further highlight the importance of regional oceanographic processes to better understand how kelp flotsam is dispersed in the ocean. In particular, we highlight the role of the Benguela Jet and mesoscale processes, which ultimately determine the transport success around the coast. Gaps in the research exist when considering what oceanographic processes play a role in solitary macroalgal dispersal. The identification of biological and physical factors that play a role in accumulation zones is also needed, as well as estimates for kelp sinking rates which would aid in describing the spatial distribution on the seafloor. 

# Conflict of Interest Statement

The remaining authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.

# Author Contributions

RC conceptualized the scope of the research reported in this manuscript, collected samples, undertook the majority of numerical and statistical analyses, made the first round of interpretation, and did the majority of the writing. AS and CR provided the guidance in terms of writing, statistical analyses, and overall presentation of the manuscript. All authors contributed to the article and approved the submitted version.

# Funding 

This research was funded by the South African National Research Foundation (http://www.nrf.ac.za). Funding number is CSRP170430229220. Aside from funding provided, the funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.

# Acknowledgments

We thank A. J Smit and Christo Rautenbach for their guidance on this project.

# Appendix

```{r sim table, echo=FALSE, message=FALSE, warning=FALSE}
set_flextable_defaults(fonts_ignore=TRUE)

sim_table <- read.csv("tables/chapter_3/simulation_table_A.csv", sep = ";")
sim_table <- flextable(data = sim_table)
sim_table <- theme_zebra(sim_table, odd_header = "transparent", even_header = "transparent")
sim_table <- fontsize(sim_table, size = 8, part = "body")
sim_table <- fontsize(sim_table, size = 8, part = "header")
sim_table <- set_header_labels(sim_table, Scenario = "Simulation", Cross.sectional.area = "Cross-sectional area", Drag.Exposure = "Drag Exposure level")
sim_table <- align(x= sim_table, align = "center", part = "all")
sim_table <- set_table_properties(sim_table, width = 1, layout = "autofit")
sim_table <- set_caption(sim_table, "Details for each simulation run for the study. Type refers to either a passive particle with no drag behavior or a kelp particle that has been advected with any type of drag exposure. The Number coloumn refers to the simulation number, the condition coloumn refers to the situation under which the particle is being advected, the advection column refers to the underlying velocity field or combination thereof, the simulation column refers to the type of particle (passive or kelp), and the season refers to the seasonal time period of the simulation. The run-time for summer simulations was 89, autumn 91, winter 91 and spring 91. The simulation output for all simulations was 3 hours and advected with a Runge-Kutta fourth order advection scheme. Particles were released every 3 hours for simulations which executed repeated releases.")
sim_table
```

```{r test data wrangle, warning = FALSE, echo=FALSE, message=FALSE, eval=TRUE}

kelp_hydro_A <- tidync("OceanParcels/chapter_3_output/kelp_hydro_sense_1hr.nc") %>% #1hr
  hyper_tibble() %>%
  dplyr::select(time, trajectory, lon, lat, distance, age, Phase, KelpVelU, KelpVelV, VelU, VelV, WindU, WindV, waterdragU, waterdragV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))

kelp_hydro_B <- tidync("OceanParcels/chapter_3_output/kelp_hydro_sense_3hr.nc") %>% #3hr
  hyper_tibble() %>%
  dplyr::select(time, trajectory, lon, lat, distance, age, Phase, KelpVelU, KelpVelV, VelU, VelV, WindU, WindV, waterdragU, waterdragV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))

kelp_hydro_C <- tidync("OceanParcels/chapter_3_output/kelp_hydro_sense_6hr.nc") %>% #6hr
  hyper_tibble() %>%
  dplyr::select(time, trajectory, lon, lat, distance, age, Phase, KelpVelU, KelpVelV, VelU, VelV, WindU, WindV, waterdragU, waterdragV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))

kelp_hydro_D <- tidync("OceanParcels/chapter_3_output/kelp_hydro_sense_12hr.nc") %>% #12hr
  hyper_tibble() %>%
  dplyr::select(time, trajectory, lon, lat, distance, age, Phase, KelpVelU, KelpVelV, VelU, VelV, WindU, WindV, waterdragU, waterdragV) %>%
  dplyr::rename(t = time) %>%
  mutate(t = as.POSIXct(t, origin = "2018-01-01 00:00:00"))

heatmap_1hr <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = kelp_hydro_A, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis")  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("1 Hr release") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_3hr <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = kelp_hydro_B, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis")  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("3 Hr release") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_6hr <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = kelp_hydro_C, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis")  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("6 Hr release") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

heatmap_12hr <- ggplot() +
  #geom_bin2d(data = p_EE, bins = 80, aes(x = lon, y = lat)) +
  geom_contour(data = sa_bathy, aes(x = lon, y = lat, z = depth), colour = "grey", size = 0.2) +
  geom_hex(data = kelp_hydro_D, bins = 80, aes(x = lon, y = lat), legend = TRUE) +  
  scale_fill_continuous(type = "viridis")  +
  geom_polygon(data = south_africa_coast_hi_res, aes(x = lon, y = lat, group = PID),
               size = 0.4, colour = "black", fill = "gray") +
  #geom_path(data = Min_Kfloat_H100_W00_mean,aes(x = lon, y = lat, color = 'red'), show.legend = FALSE) +
  coord_cartesian(xlim = c(14, 20), ylim = c(-35, -30)) + 
  labs(x = expression(Longitude*degree*S)) +
  labs(y = expression(Latitude*degree*E)) +
  ggtitle("12 Hr release") +
  guides(fill=guide_legend(title="Number of particles")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text=element_text(size=12),
        axis.title=element_text(size=12)) 

```

```{r test data outputs, warning=FALSE, echo=FALSE, message=FALSE,eval=TRUE, fig.cap="Heatmaps comparing densities and patterns across time-release options.", fig.height=8, fig.width=8}

ggarrange(heatmap_1hr, heatmap_3hr, heatmap_6hr, heatmap_12hr,common.legend = TRUE, legend = c("none"), ncol = 2, nrow = 2, labels = c("AUTO"), font.label = list(size = 12, face = "bold"), align = "hv")

#ggsave(filename = "figure_sensetest.jpg", plot = last_plot(), path = "figures/chapter_3/", height = 8, #width = 8, scale = 1, dpi = 300)
```

# References
